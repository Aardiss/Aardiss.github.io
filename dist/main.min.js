"use strict";!function(Y){var Z={mode:"horizontal",slideSelector:"",infiniteLoop:!0,hideControlOnEnd:!1,speed:500,easing:null,slideMargin:0,startSlide:0,randomStart:!1,captions:!1,ticker:!1,tickerHover:!1,adaptiveHeight:!1,adaptiveHeightSpeed:500,video:!1,useCSS:!0,preloadImages:"visible",responsive:!0,slideZIndex:50,wrapperClass:"bx-wrapper",touchEnabled:!0,swipeThreshold:50,oneToOneTouch:!0,preventDefaultSwipeX:!0,preventDefaultSwipeY:!1,ariaLive:!0,ariaHidden:!0,keyboardEnabled:!1,pager:!0,pagerType:"full",pagerShortSeparator:" / ",pagerSelector:null,buildPager:null,pagerCustom:null,controls:!0,nextText:"Next",prevText:"Prev",nextSelector:null,prevSelector:null,autoControls:!1,startText:"Start",stopText:"Stop",autoControlsCombine:!1,autoControlsSelector:null,auto:!1,pause:4e3,autoStart:!0,autoDirection:"next",stopAutoOnClick:!1,autoHover:!1,autoDelay:0,autoSlideForOnePage:!1,minSlides:1,maxSlides:1,moveSlides:0,slideWidth:0,shrinkItems:!1,onSliderLoad:function(){return!0},onSlideBefore:function(){return!0},onSlideAfter:function(){return!0},onSlideNext:function(){return!0},onSlidePrev:function(){return!0},onSliderResize:function(){return!0},onAutoChange:function(){return!0}};Y.fn.bxSlider=function(e){if(0===this.length)return this;if(1<this.length)return this.each(function(){Y(this).bxSlider(e)}),this;var g={},u=this,s=Y(window).width(),o=Y(window).height();if(!Y(u).data("bxSlider")){var n=function(){Y(u).data("bxSlider")||(g.settings=Y.extend({},Z,e),g.settings.slideWidth=parseInt(g.settings.slideWidth),g.children=u.children(g.settings.slideSelector),g.children.length<g.settings.minSlides&&(g.settings.minSlides=g.children.length),g.children.length<g.settings.maxSlides&&(g.settings.maxSlides=g.children.length),g.settings.randomStart&&(g.settings.startSlide=Math.floor(Math.random()*g.children.length)),g.active={index:g.settings.startSlide},g.carousel=1<g.settings.minSlides||1<g.settings.maxSlides,g.carousel&&(g.settings.preloadImages="all"),g.minThreshold=g.settings.minSlides*g.settings.slideWidth+(g.settings.minSlides-1)*g.settings.slideMargin,g.maxThreshold=g.settings.maxSlides*g.settings.slideWidth+(g.settings.maxSlides-1)*g.settings.slideMargin,g.working=!1,g.controls={},g.interval=null,g.animProp="vertical"===g.settings.mode?"top":"left",g.usingCSS=g.settings.useCSS&&"fade"!==g.settings.mode&&function(){for(var t=document.createElement("div"),e=["WebkitPerspective","MozPerspective","OPerspective","msPerspective"],i=0;i<e.length;i++)if(void 0!==t.style[e[i]])return g.cssPrefix=e[i].replace("Perspective","").toLowerCase(),g.animProp="-"+g.cssPrefix+"-transform",!0;return!1}(),"vertical"===g.settings.mode&&(g.settings.maxSlides=g.settings.minSlides),u.data("origStyle",u.attr("style")),u.children(g.settings.slideSelector).each(function(){Y(this).data("origStyle",Y(this).attr("style"))}),t())},t=function(){var t=g.children.eq(g.settings.startSlide);u.wrap('<div class="'+g.settings.wrapperClass+'"><div class="bx-viewport"></div></div>'),g.viewport=u.parent(),g.settings.ariaLive&&!g.settings.ticker&&g.viewport.attr("aria-live","polite"),g.loader=Y('<div class="bx-loading" />'),g.viewport.prepend(g.loader),u.css({width:"horizontal"===g.settings.mode?1e3*g.children.length+215+"%":"auto",position:"relative"}),g.usingCSS&&g.settings.easing?u.css("-"+g.cssPrefix+"-transition-timing-function",g.settings.easing):g.settings.easing||(g.settings.easing="swing"),g.viewport.css({width:"100%",overflow:"hidden",position:"relative"}),g.viewport.parent().css({maxWidth:l()}),g.children.css({float:"horizontal"===g.settings.mode?"left":"none",listStyle:"none",position:"relative"}),g.children.css("width",d()),"horizontal"===g.settings.mode&&0<g.settings.slideMargin&&g.children.css("marginRight",g.settings.slideMargin),"vertical"===g.settings.mode&&0<g.settings.slideMargin&&g.children.css("marginBottom",g.settings.slideMargin),"fade"===g.settings.mode&&(g.children.css({position:"absolute",zIndex:0,display:"none"}),g.children.eq(g.settings.startSlide).css({zIndex:g.settings.slideZIndex,display:"block"})),g.controls.el=Y('<div class="bx-controls" />'),g.settings.captions&&C(),g.active.last=g.settings.startSlide===v()-1,g.settings.video&&u.fitVids(),"none"===g.settings.preloadImages?t=null:"all"!==g.settings.preloadImages&&!g.settings.ticker||(t=g.children),g.settings.ticker?g.settings.pager=!1:(g.settings.controls&&w(),g.settings.auto&&g.settings.autoControls&&b(),g.settings.pager&&S(),(g.settings.controls||g.settings.autoControls||g.settings.pager)&&g.viewport.after(g.controls.el)),null===t?a():r(t,a)},r=function(t,e){var i=t.find('img:not([src=""]), iframe').length,n=0;0!==i?t.find('img:not([src=""]), iframe').each(function(){Y(this).one("load error",function(){++n===i&&e()}).each(function(){!this.complete&&""!=this.src||Y(this).trigger("load")})}):e()},a=function(){var t,e,i;g.settings.infiniteLoop&&"fade"!==g.settings.mode&&!g.settings.ticker&&(t="vertical"===g.settings.mode?g.settings.minSlides:g.settings.maxSlides,e=g.children.slice(0,t).clone(!0).addClass("bx-clone"),i=g.children.slice(-t).clone(!0).addClass("bx-clone"),g.settings.ariaHidden&&(e.attr("aria-hidden",!0),i.attr("aria-hidden",!0)),u.append(e).prepend(i)),g.loader.remove(),f(),"vertical"===g.settings.mode&&(g.settings.adaptiveHeight=!0),g.viewport.height(p()),u.redrawSlider(),g.settings.onSliderLoad.call(u,g.active.index),g.initialized=!0,g.settings.responsive&&Y(window).on("resize",B),g.settings.auto&&g.settings.autoStart&&(1<v()||g.settings.autoSlideForOnePage)&&q(),g.settings.ticker&&L(),g.settings.pager&&P(g.settings.startSlide),g.settings.controls&&$(),g.settings.touchEnabled&&!g.settings.ticker&&W(),g.settings.keyboardEnabled&&!g.settings.ticker&&Y(document).keydown(H)},p=function(){var e=0,t=Y();if("vertical"===g.settings.mode||g.settings.adaptiveHeight)if(g.carousel){var n=1===g.settings.moveSlides?g.active.index:g.active.index*h(),t=g.children.eq(n);for(i=1;i<=g.settings.maxSlides-1;i++)t=n+i>=g.children.length?t.add(g.children.eq(i-1)):t.add(g.children.eq(n+i))}else t=g.children.eq(g.active.index);else t=g.children;return"vertical"===g.settings.mode?(t.each(function(t){e+=Y(this).outerHeight()}),0<g.settings.slideMargin&&(e+=g.settings.slideMargin*(g.settings.minSlides-1))):e=Math.max.apply(Math,t.map(function(){return Y(this).outerHeight(!1)}).get()),"border-box"===g.viewport.css("box-sizing")?e+=parseFloat(g.viewport.css("padding-top"))+parseFloat(g.viewport.css("padding-bottom"))+parseFloat(g.viewport.css("border-top-width"))+parseFloat(g.viewport.css("border-bottom-width")):"padding-box"===g.viewport.css("box-sizing")&&(e+=parseFloat(g.viewport.css("padding-top"))+parseFloat(g.viewport.css("padding-bottom"))),e},l=function(){var t="100%";return 0<g.settings.slideWidth&&(t="horizontal"===g.settings.mode?g.settings.maxSlides*g.settings.slideWidth+(g.settings.maxSlides-1)*g.settings.slideMargin:g.settings.slideWidth),t},d=function(){var t=g.settings.slideWidth,e=g.viewport.width();if(0===g.settings.slideWidth||g.settings.slideWidth>e&&!g.carousel||"vertical"===g.settings.mode)t=e;else if(1<g.settings.maxSlides&&"horizontal"===g.settings.mode){if(e>g.maxThreshold)return t;e<g.minThreshold?t=(e-g.settings.slideMargin*(g.settings.minSlides-1))/g.settings.minSlides:g.settings.shrinkItems&&(t=Math.floor((e+g.settings.slideMargin)/Math.ceil((e+g.settings.slideMargin)/(t+g.settings.slideMargin))-g.settings.slideMargin))}return t},c=function(){var t,e=1;return"horizontal"===g.settings.mode&&0<g.settings.slideWidth?e=g.viewport.width()<g.minThreshold?g.settings.minSlides:g.viewport.width()>g.maxThreshold?g.settings.maxSlides:(t=g.children.first().width()+g.settings.slideMargin,Math.floor((g.viewport.width()+g.settings.slideMargin)/t)||1):"vertical"===g.settings.mode&&(e=g.settings.minSlides),e},v=function(){var t=0,e=0,i=0;if(0<g.settings.moveSlides){if(!g.settings.infiniteLoop){for(;e<g.children.length;)++t,e=i+c(),i+=g.settings.moveSlides<=c()?g.settings.moveSlides:c();return i}t=Math.ceil(g.children.length/h())}else t=Math.ceil(g.children.length/c());return t},h=function(){return 0<g.settings.moveSlides&&g.settings.moveSlides<=c()?g.settings.moveSlides:c()},f=function(){var t,e,i;g.children.length>g.settings.maxSlides&&g.active.last&&!g.settings.infiniteLoop?"horizontal"===g.settings.mode?(t=(e=g.children.last()).position(),m(-(t.left-(g.viewport.width()-e.outerWidth())),"reset",0)):"vertical"===g.settings.mode&&(i=g.children.length-g.settings.minSlides,t=g.children.eq(i).position(),m(-t.top,"reset",0)):(t=g.children.eq(g.active.index*h()).position(),g.active.index===v()-1&&(g.active.last=!0),void 0!==t&&("horizontal"===g.settings.mode?m(-t.left,"reset",0):"vertical"===g.settings.mode&&m(-t.top,"reset",0)))},m=function e(t,i,n,s){var o,r;g.usingCSS?(r="vertical"===g.settings.mode?"translate3d(0, "+t+"px, 0)":"translate3d("+t+"px, 0, 0)",u.css("-"+g.cssPrefix+"-transition-duration",n/1e3+"s"),"slide"===i?(u.css(g.animProp,r),0!==n?u.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(t){Y(t.target).is(u)&&(u.off("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd"),M())}):M()):"reset"===i?u.css(g.animProp,r):"ticker"===i&&(u.css("-"+g.cssPrefix+"-transition-timing-function","linear"),u.css(g.animProp,r),0!==n?u.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(t){Y(t.target).is(u)&&(u.off("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd"),e(s.resetValue,"reset",0),A())}):(e(s.resetValue,"reset",0),A()))):((o={})[g.animProp]=t,"slide"===i?u.animate(o,n,g.settings.easing,function(){M()}):"reset"===i?u.css(g.animProp,t):"ticker"===i&&u.animate(o,n,"linear",function(){e(s.resetValue,"reset",0),A()}))},x=function(){for(var t="",e="",i=v(),n=0;n<i;n++)e="",g.settings.buildPager&&Y.isFunction(g.settings.buildPager)||g.settings.pagerCustom?(e=g.settings.buildPager(n),g.pagerEl.addClass("bx-custom-pager")):(e=n+1,g.pagerEl.addClass("bx-default-pager")),t+='<div class="bx-pager-item"><a href="" data-slide-index="'+n+'" class="bx-pager-link">'+e+"</a></div>";g.pagerEl.html(t)},S=function(){g.settings.pagerCustom?g.pagerEl=Y(g.settings.pagerCustom):(g.pagerEl=Y('<div class="bx-pager" />'),g.settings.pagerSelector?Y(g.settings.pagerSelector).html(g.pagerEl):g.controls.el.addClass("bx-has-pager").append(g.pagerEl),x()),g.pagerEl.on("click touchend","a",E)},w=function(){g.controls.next=Y('<a class="bx-next" href="">'+g.settings.nextText+"</a>"),g.controls.prev=Y('<a class="bx-prev" href="">'+g.settings.prevText+"</a>"),g.controls.next.on("click touchend",_),g.controls.prev.on("click touchend",k),g.settings.nextSelector&&Y(g.settings.nextSelector).append(g.controls.next),g.settings.prevSelector&&Y(g.settings.prevSelector).append(g.controls.prev),g.settings.nextSelector||g.settings.prevSelector||(g.controls.directionEl=Y('<div class="bx-controls-direction" />'),g.controls.directionEl.append(g.controls.prev).append(g.controls.next),g.controls.el.addClass("bx-has-controls-direction").append(g.controls.directionEl))},b=function(){g.controls.start=Y('<div class="bx-controls-auto-item"><a class="bx-start" href="">'+g.settings.startText+"</a></div>"),g.controls.stop=Y('<div class="bx-controls-auto-item"><a class="bx-stop" href="">'+g.settings.stopText+"</a></div>"),g.controls.autoEl=Y('<div class="bx-controls-auto" />'),g.controls.autoEl.on("click",".bx-start",y),g.controls.autoEl.on("click",".bx-stop",T),g.settings.autoControlsCombine?g.controls.autoEl.append(g.controls.start):g.controls.autoEl.append(g.controls.start).append(g.controls.stop),g.settings.autoControlsSelector?Y(g.settings.autoControlsSelector).html(g.controls.autoEl):g.controls.el.addClass("bx-has-controls-auto").append(g.controls.autoEl),I(g.settings.autoStart?"stop":"start")},C=function(){g.children.each(function(t){var e=Y(this).find("img:first").attr("title");void 0!==e&&(""+e).length&&Y(this).append('<div class="bx-caption"><span>'+e+"</span></div>")})},_=function(t){t.preventDefault(),g.controls.el.hasClass("disabled")||(g.settings.auto&&g.settings.stopAutoOnClick&&u.stopAuto(),u.goToNextSlide())},k=function(t){t.preventDefault(),g.controls.el.hasClass("disabled")||(g.settings.auto&&g.settings.stopAutoOnClick&&u.stopAuto(),u.goToPrevSlide())},y=function(t){u.startAuto(),t.preventDefault()},T=function(t){u.stopAuto(),t.preventDefault()},E=function(t){var e,i;t.preventDefault(),g.controls.el.hasClass("disabled")||(g.settings.auto&&g.settings.stopAutoOnClick&&u.stopAuto(),void 0!==(e=Y(t.currentTarget)).attr("data-slide-index")&&(i=parseInt(e.attr("data-slide-index")))!==g.active.index&&u.goToSlide(i))},P=function(i){var t=g.children.length;if("short"===g.settings.pagerType)return 1<g.settings.maxSlides&&(t=Math.ceil(g.children.length/g.settings.maxSlides)),void g.pagerEl.html(i+1+g.settings.pagerShortSeparator+t);g.pagerEl.find("a").removeClass("active"),g.pagerEl.each(function(t,e){Y(e).find("a").eq(i).addClass("active")})},M=function(){var t;g.settings.infiniteLoop&&(t="",0===g.active.index?t=g.children.eq(0).position():g.active.index===v()-1&&g.carousel?t=g.children.eq((v()-1)*h()).position():g.active.index===g.children.length-1&&(t=g.children.eq(g.children.length-1).position()),t&&("horizontal"===g.settings.mode?m(-t.left,"reset",0):"vertical"===g.settings.mode&&m(-t.top,"reset",0))),g.working=!1,g.settings.onSlideAfter.call(u,g.children.eq(g.active.index),g.oldIndex,g.active.index)},I=function(t){g.settings.autoControlsCombine?g.controls.autoEl.html(g.controls[t]):(g.controls.autoEl.find("a").removeClass("active"),g.controls.autoEl.find("a:not(.bx-"+t+")").addClass("active"))},$=function(){1===v()?(g.controls.prev.addClass("disabled"),g.controls.next.addClass("disabled")):!g.settings.infiniteLoop&&g.settings.hideControlOnEnd&&(0===g.active.index?(g.controls.prev.addClass("disabled"),g.controls.next.removeClass("disabled")):g.active.index===v()-1?(g.controls.next.addClass("disabled"),g.controls.prev.removeClass("disabled")):(g.controls.prev.removeClass("disabled"),g.controls.next.removeClass("disabled")))},z=function(){u.startAuto()},D=function(){u.stopAuto()},q=function(){0<g.settings.autoDelay?setTimeout(u.startAuto,g.settings.autoDelay):(u.startAuto(),Y(window).focus(z).blur(D)),g.settings.autoHover&&u.hover(function(){g.interval&&(u.stopAuto(!0),g.autoPaused=!0)},function(){g.autoPaused&&(u.startAuto(!0),g.autoPaused=null)})},L=function(){var t,e,i,n,s,o,r,a,l=0;"next"===g.settings.autoDirection?u.append(g.children.clone().addClass("bx-clone")):(u.prepend(g.children.clone().addClass("bx-clone")),t=g.children.first().position(),l="horizontal"===g.settings.mode?-t.left:-t.top),m(l,"reset",0),g.settings.pager=!1,g.settings.controls=!1,g.settings.autoControls=!1,g.settings.tickerHover&&(g.usingCSS?(n="horizontal"===g.settings.mode?4:5,g.viewport.hover(function(){e=u.css("-"+g.cssPrefix+"-transform"),i=parseFloat(e.split(",")[n]),m(i,"reset",0)},function(){a=0,g.children.each(function(t){a+="horizontal"===g.settings.mode?Y(this).outerWidth(!0):Y(this).outerHeight(!0)}),s=g.settings.speed/a,o="horizontal"===g.settings.mode?"left":"top",r=s*(a-Math.abs(parseInt(i))),A(r)})):g.viewport.hover(function(){u.stop()},function(){a=0,g.children.each(function(t){a+="horizontal"===g.settings.mode?Y(this).outerWidth(!0):Y(this).outerHeight(!0)}),s=g.settings.speed/a,o="horizontal"===g.settings.mode?"left":"top",r=s*(a-Math.abs(parseInt(u.css(o)))),A(r)})),A()},A=function(t){var e,i,n=t||g.settings.speed,s={left:0,top:0},o={left:0,top:0};"next"===g.settings.autoDirection?s=u.find(".bx-clone").first().position():o=g.children.first().position(),e="horizontal"===g.settings.mode?-s.left:-s.top,i="horizontal"===g.settings.mode?-o.left:-o.top,m(e,"ticker",n,{resetValue:i})},H=function(t){var e,i,n,s,o=document.activeElement.tagName.toLowerCase();if(null==new RegExp(o,["i"]).exec("input|textarea")&&(e=u,i=Y(window),n={top:i.scrollTop(),left:i.scrollLeft()},s=e.offset(),n.right=n.left+i.width(),n.bottom=n.top+i.height(),s.right=s.left+e.outerWidth(),s.bottom=s.top+e.outerHeight(),!(n.right<s.left||n.left>s.right||n.bottom<s.top||n.top>s.bottom))){if(39===t.keyCode)return _(t),!1;if(37===t.keyCode)return k(t),!1}},W=function(){g.touch={start:{x:0,y:0},end:{x:0,y:0}},g.viewport.on("touchstart MSPointerDown pointerdown",O),g.viewport.on("click",".bxslider a",function(t){g.viewport.hasClass("click-disabled")&&(t.preventDefault(),g.viewport.removeClass("click-disabled"))})},O=function(t){if("touchstart"===t.type||0===t.button)if(t.preventDefault(),g.controls.el.addClass("disabled"),g.working)g.controls.el.removeClass("disabled");else{g.touch.originalPos=u.position();var e=t.originalEvent,i=void 0!==e.changedTouches?e.changedTouches:[e];if("function"==typeof PointerEvent&&void 0===e.pointerId)return;g.touch.start.x=i[0].pageX,g.touch.start.y=i[0].pageY,g.viewport.get(0).setPointerCapture&&(g.pointerId=e.pointerId,g.viewport.get(0).setPointerCapture(g.pointerId)),g.originalClickTarget=e.originalTarget||e.target,g.originalClickButton=e.button,g.originalClickButtons=e.buttons,g.originalEventType=e.type,g.hasMove=!1,g.viewport.on("touchmove MSPointerMove pointermove",F),g.viewport.on("touchend MSPointerUp pointerup",V),g.viewport.on("MSPointerCancel pointercancel",N)}},N=function t(e){e.preventDefault(),m(g.touch.originalPos.left,"reset",0),g.controls.el.removeClass("disabled"),g.viewport.off("MSPointerCancel pointercancel",t),g.viewport.off("touchmove MSPointerMove pointermove",F),g.viewport.off("touchend MSPointerUp pointerup",V),g.viewport.get(0).releasePointerCapture&&g.viewport.get(0).releasePointerCapture(g.pointerId)},F=function(t){var e=t.originalEvent,i=void 0!==e.changedTouches?e.changedTouches:[e],n=Math.abs(i[0].pageX-g.touch.start.x),s=Math.abs(i[0].pageY-g.touch.start.y),o=0,r=0;g.hasMove=!0,(s<3*n&&g.settings.preventDefaultSwipeX||n<3*s&&g.settings.preventDefaultSwipeY)&&t.preventDefault(),"touchmove"!==t.type&&t.preventDefault(),"fade"!==g.settings.mode&&g.settings.oneToOneTouch&&(o="horizontal"===g.settings.mode?(r=i[0].pageX-g.touch.start.x,g.touch.originalPos.left+r):(r=i[0].pageY-g.touch.start.y,g.touch.originalPos.top+r),m(o,"reset",0))},V=function t(e){e.preventDefault(),g.viewport.off("touchmove MSPointerMove pointermove",F),g.controls.el.removeClass("disabled");var i=e.originalEvent,n=void 0!==i.changedTouches?i.changedTouches:[i],s=0,o=0;g.touch.end.x=n[0].pageX,g.touch.end.y=n[0].pageY,"fade"===g.settings.mode?(o=Math.abs(g.touch.start.x-g.touch.end.x))>=g.settings.swipeThreshold&&(g.touch.start.x>g.touch.end.x?u.goToNextSlide():u.goToPrevSlide(),u.stopAuto()):(s="horizontal"===g.settings.mode?(o=g.touch.end.x-g.touch.start.x,g.touch.originalPos.left):(o=g.touch.end.y-g.touch.start.y,g.touch.originalPos.top),(g.settings.infiniteLoop||!(0===g.active.index&&0<o||g.active.last&&o<0))&&Math.abs(o)>=g.settings.swipeThreshold?(o<0?u.goToNextSlide():u.goToPrevSlide(),u.stopAuto()):m(s,"reset",200)),g.viewport.off("touchend MSPointerUp pointerup",t),g.viewport.get(0).releasePointerCapture&&g.viewport.get(0).releasePointerCapture(g.pointerId),!1!==g.hasMove||0!==g.originalClickButton&&"touchstart"!==g.originalEventType||Y(g.originalClickTarget).trigger({type:"click",button:g.originalClickButton,buttons:g.originalClickButtons})},B=function t(e){var i,n;g.initialized&&(g.working?window.setTimeout(t,10):(i=Y(window).width(),n=Y(window).height(),s===i&&o===n||(s=i,o=n,u.redrawSlider(),g.settings.onSliderResize.call(u,g.active.index))))},X=function(t){var e=c();g.settings.ariaHidden&&!g.settings.ticker&&(g.children.attr("aria-hidden","true"),g.children.slice(t,t+e).attr("aria-hidden","false"))};return u.goToSlide=function(t,e){var i,n,s,o,r,a=!0,l=0,d={left:0,top:0},c=null;if(g.oldIndex=g.active.index,g.active.index=(r=t)<0?g.settings.infiniteLoop?v()-1:g.active.index:r>=v()?g.settings.infiniteLoop?0:g.active.index:r,!g.working&&g.active.index!==g.oldIndex){if(g.working=!0,void 0!==(a=g.settings.onSlideBefore.call(u,g.children.eq(g.active.index),g.oldIndex,g.active.index))&&!a)return g.active.index=g.oldIndex,void(g.working=!1);"next"===e?g.settings.onSlideNext.call(u,g.children.eq(g.active.index),g.oldIndex,g.active.index)||(a=!1):"prev"===e&&(g.settings.onSlidePrev.call(u,g.children.eq(g.active.index),g.oldIndex,g.active.index)||(a=!1)),g.active.last=g.active.index>=v()-1,(g.settings.pager||g.settings.pagerCustom)&&P(g.active.index),g.settings.controls&&$(),"fade"===g.settings.mode?(g.settings.adaptiveHeight&&g.viewport.height()!==p()&&g.viewport.animate({height:p()},g.settings.adaptiveHeightSpeed),g.children.filter(":visible").fadeOut(g.settings.speed).css({zIndex:0}),g.children.eq(g.active.index).css("zIndex",g.settings.slideZIndex+1).fadeIn(g.settings.speed,function(){Y(this).css("zIndex",g.settings.slideZIndex),M()})):(g.settings.adaptiveHeight&&g.viewport.height()!==p()&&g.viewport.animate({height:p()},g.settings.adaptiveHeightSpeed),!g.settings.infiniteLoop&&g.carousel&&g.active.last?"horizontal"===g.settings.mode?(d=(c=g.children.eq(g.children.length-1)).position(),l=g.viewport.width()-c.outerWidth()):(i=g.children.length-g.settings.minSlides,d=g.children.eq(i).position()):g.carousel&&g.active.last&&"prev"===e?(n=1===g.settings.moveSlides?g.settings.maxSlides-h():(v()-1)*h()-(g.children.length-g.settings.maxSlides),d=(c=u.children(".bx-clone").eq(n)).position()):"next"===e&&0===g.active.index?(d=u.find("> .bx-clone").eq(g.settings.maxSlides).position(),g.active.last=!1):0<=t&&(o=t*parseInt(h()),d=g.children.eq(o).position()),void 0!==d&&(s="horizontal"===g.settings.mode?-(d.left-l):-d.top,m(s,"slide",g.settings.speed)),g.working=!1),g.settings.ariaHidden&&X(g.active.index*h())}},u.goToNextSlide=function(){var t;!g.settings.infiniteLoop&&g.active.last||!0!==g.working&&(t=parseInt(g.active.index)+1,u.goToSlide(t,"next"))},u.goToPrevSlide=function(){var t;!g.settings.infiniteLoop&&0===g.active.index||!0===g.working||(t=parseInt(g.active.index)-1,u.goToSlide(t,"prev"))},u.startAuto=function(t){g.interval||(g.interval=setInterval(function(){"next"===g.settings.autoDirection?u.goToNextSlide():u.goToPrevSlide()},g.settings.pause),g.settings.onAutoChange.call(u,!0),g.settings.autoControls&&!0!==t&&I("stop"))},u.stopAuto=function(t){g.autoPaused&&(g.autoPaused=!1),g.interval&&(clearInterval(g.interval),g.interval=null,g.settings.onAutoChange.call(u,!1),g.settings.autoControls&&!0!==t&&I("start"))},u.getCurrentSlide=function(){return g.active.index},u.getCurrentSlideElement=function(){return g.children.eq(g.active.index)},u.getSlideElement=function(t){return g.children.eq(t)},u.getSlideCount=function(){return g.children.length},u.isWorking=function(){return g.working},u.redrawSlider=function(){g.children.add(u.find(".bx-clone")).outerWidth(d()),g.viewport.css("height",p()),g.settings.ticker||f(),g.active.last&&(g.active.index=v()-1),g.active.index>=v()&&(g.active.last=!0),g.settings.pager&&!g.settings.pagerCustom&&(x(),P(g.active.index)),g.settings.ariaHidden&&X(g.active.index*h())},u.destroySlider=function(){g.initialized&&(g.initialized=!1,Y(".bx-clone",this).remove(),g.children.each(function(){void 0!==Y(this).data("origStyle")?Y(this).attr("style",Y(this).data("origStyle")):Y(this).removeAttr("style")}),void 0!==Y(this).data("origStyle")?this.attr("style",Y(this).data("origStyle")):Y(this).removeAttr("style"),Y(this).unwrap().unwrap(),g.controls.el&&g.controls.el.remove(),g.controls.next&&g.controls.next.remove(),g.controls.prev&&g.controls.prev.remove(),g.pagerEl&&g.settings.controls&&!g.settings.pagerCustom&&g.pagerEl.remove(),Y(".bx-caption",this).remove(),g.controls.autoEl&&g.controls.autoEl.remove(),clearInterval(g.interval),g.settings.responsive&&Y(window).off("resize",B),g.settings.keyboardEnabled&&Y(document).off("keydown",H),Y(this).removeData("bxSlider"),Y(window).off("blur",D).off("focus",z))},u.reloadSlider=function(t){void 0!==t&&(e=t),u.destroySlider(),n(),Y(u).data("bxSlider",this)},n(),Y(u).data("bxSlider",this),this}}}(jQuery),function(){function a(t){var e=t.find(".command__profile-panel");t.find(".command__profile-name").removeClass("active"),e.height(0)}$(".command__profile-name").click(function(t){var e,i,n,s,o=$(t.currentTarget),r=o.closest(".command__list");o.hasClass("active")?a(r):(a(r),i=(e=o).closest(".command__profile"),n=i.find(".command__profile-panel"),s=i.find(".command__profile-block").height(),e.addClass("active"),n.height(s))})}(),function(){function o(t){var e=t.find(".assort__item"),i=t.find(".assort__wrap");e.removeClass("assort-active"),i.width(0)}function r(t){var e,i,n,s,o,r,a,l,d=t.find(".assort__wrap"),c=(e=t,i=0,n=$(window).width(),s=e.closest(".assort__list").find(".assort__trigger"),o=s.width()*s.length,r=e.find(".assort__content"),a=parseInt(r.css("padding-left")),l=parseInt(r.css("padding-right")),{container:i=window.matchMedia("(max-width: 768px)").matches?n-o:500,textContainer:i-a-l}),g=t.find(".assort__content");t.addClass("assort-active"),d.width(c.container),g.width(c.textContainer)}$(".assort__trigger").on("click",function(t){t.preventDefault();var e=$(t.currentTarget),i=e.closest(".assort__item"),n=i.hasClass("assort-active"),s=e.closest(".assort__list");n?o(s):(o(s),r(i))}),$(".assort__close").on("click",function(t){t.preventDefault(),o($(".assort__list"))})}(),function(){var t;ymaps.ready(function(){t=new ymaps.Map("map",{center:[55.749536,37.620857],zoom:13.5,controls:[]});var e=new ymaps.GeoObjectCollection({},{draggable:!1,iconLayout:"default#image",iconImageHref:"../img/icons/marker.svg",iconImageSize:[46,57],iconImageOffset:[-35,-52]});[[55.756832,37.586203],[55.757425,37.627059],[55.744799,37.581622],[55.749532,37.607942]].forEach(function(t){e.add(new ymaps.Placemark(t))}),t.geoObjects.add(e),t.behaviors.disable("scrollZoom")})}(),function(){var t=document.querySelector(".hamburger"),e=document.querySelector(".hamburger__menu");document.querySelector(".close");t.addEventListener("click",function(){e.classList.add("menu_window")}),e.addEventListener("click",function(t){t.target.classList.contains("menu__item")&&!t.target.classList.contains("close")||e.classList.remove("menu_window"),t.target.classList.contains("menu__item")&&e.classList.remove("menu_window")})}(),$(".form").submit(function(t){t.preventDefault();var e,i,n=$(t.currentTarget),s=n.find("[name='name']"),o=n.find("[name='phone']"),r=n.find("[name='comment']"),a=n.find("[name='to']"),l=$("#modal"),d=l.find(".modal__content");l.removeClass("error-modal"),(e=n,[s,o,r,a].forEach(function(t){t.removeClass("input__error"),""==t.val().trim()&&t.addClass("input__error")}),0==e.find(".input__error").length)&&((i=$.ajax({url:"https://webdev-api.loftschool.com/sendmail",method:"post",data:{name:s.val(),phone:o.val(),comment:r.val(),to:a.val()}})).done(function(t){d.text(t.message)}),i.fail(function(t){var e=t.responseJSON.message;d.text(e),l.addClass("error-modal")}),i.always(function(){$.fancybox.open({src:"#modal",type:"inline"})}))}),$(".app-submit-btn").click(function(t){t.preventDefault(),$.fancybox.close()}),function(){var o=$("section"),r=$(".maincontent"),a=$(".fixed-menu__link"),l=a.find(".fixed-menu__link"),t=new MobileDetect(window.navigator.userAgent).mobile(),d=!1;o.first().addClass("section-active");function c(t,e,i){t.eq(e).addClass(i).siblings().removeClass(i)}function s(t){var e,i,n,s;t<0&&(t=0),0==d&&(d=!0,e=0<-100*(s=t)?0:-100*s,i=t,n="fixed-black","black"==o.eq(i).attr("data-theme")?a.addClass(n):a.removeClass(n),r.css({transform:"translateY(".concat(e,"%)")}),c(o,t,"section-active"),setTimeout(function(){d=!1,c(l,t,"fixed-menu__link--active")},1300))}function i(t){var e=o.filter(".section-active"),i=e.next(),n=e.prev();"next"==t&&i.length&&s(i.index()),"prev"==t&&n.length&&s(n.index())}$(window).on("wheel",function(t){var e=t.originalEvent.deltaY;0<e&&i("next"),e<0&&i("prev")}),$(window).on("keydown",function(t){var e=t.target.tagName.toLowerCase();if("input"!=e&&"textarea"!=e)switch(t.keyCode){case 38:i("prev");break;case 40:i("next")}}),$(".wrapper").on("touchmove",function(t){return t.preventDefault()}),$("[data-to]").click(function(t){t.preventDefault();var e=$(t.currentTarget).attr("data-to"),i=$("[data-id=".concat(e,"]"));s(i.index())}),t&&$("body").swipe({swipe:function(t,e){viewportScroller()["down"==e?"prev":"up"==e?"next":""]()}})}(),function(){$(".player");var s,e=$(".player__start"),i=$(".volume__pic"),n=function(){var t,e=s.getDuration();void 0!==t&&clearInterval(t),t=setInterval(function(){var t=s.getCurrentTime()/e*100;$(".player__playback-button").css({left:"".concat(t,"%")})},1e3)};$(".player__start").click(function(t){t.preventDefault();$(t.currentTarget);e.hasClass("player--paused")?s.pauseVideo():s.playVideo(),n()}),$(".player__playback").click(function(t){var e=$(t.currentTarget),i=t.originalEvent.layerX/e.width()*100,n=s.getDuration()/100*i;$(".player__playback-button").css({left:"".concat(i,"%")}),s.seekTo(n)}),$(".player__splash").click(function(t){s.playVideo()}),$(".volume__pic").click(function(t){t.preventDefault(),i.hasClass("volume__pic--nosound")?(s.unMute(),i.removeClass("volume__pic--nosound")):(s.mute(),i.addClass("volume__pic--nosound"))}),$(".volume__playback").click(function(t){var e=$(t.currentTarget),i=t.originalEvent.layerX/e.width()*100;s.getVolume();$(".volume__playback-button").css({left:"".concat(i,"%")}),s.setVolume(i)})}(),function(){var e=$(".slider").bxSlider({pager:!1,controls:!1});$(".section-bar__arrow-back").click(function(t){t.preventDefault(),e.goToPrevSlide()}),$(".section-bar__arrow-forward").click(function(t){t.preventDefault(),e.goToNextSlide()})}(),$(".interactive-avatar__link").click(function(t){t.preventDefault();var i,e=$(t.currentTarget),n=e.attr("data-open"),s=(i=n,$(".reviews__item").filter(function(t,e){return $(e).attr("data-linked-with")==i})),o=e.closest(".reviews__switcher-item");s.addClass("item-active").siblings().removeClass("item-active"),o.addClass("item__active").siblings().removeClass("item__active")});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpxdWVyeS5ieHNsaWRlci5qcyIsImFjY29yZGlvbi5qcyIsImFjY29yZGlvbl9ob3Jpem9udGFsLmpzIiwibWFwLmpzIiwibWVudS5qcyIsIm1vZGFsLmpzIiwib3BzLmpzIiwicGxheWVyLmpzIiwic2xpZGVyLmpzIiwidGFicy5qcyJdLCJuYW1lcyI6WyIkIiwiZGVmYXVsdHMiLCJtb2RlIiwic2xpZGVTZWxlY3RvciIsImluZmluaXRlTG9vcCIsImhpZGVDb250cm9sT25FbmQiLCJzcGVlZCIsImVhc2luZyIsInNsaWRlTWFyZ2luIiwic3RhcnRTbGlkZSIsInJhbmRvbVN0YXJ0IiwiY2FwdGlvbnMiLCJ0aWNrZXIiLCJ0aWNrZXJIb3ZlciIsImFkYXB0aXZlSGVpZ2h0IiwiYWRhcHRpdmVIZWlnaHRTcGVlZCIsInZpZGVvIiwidXNlQ1NTIiwicHJlbG9hZEltYWdlcyIsInJlc3BvbnNpdmUiLCJzbGlkZVpJbmRleCIsIndyYXBwZXJDbGFzcyIsInRvdWNoRW5hYmxlZCIsInN3aXBlVGhyZXNob2xkIiwib25lVG9PbmVUb3VjaCIsInByZXZlbnREZWZhdWx0U3dpcGVYIiwicHJldmVudERlZmF1bHRTd2lwZVkiLCJhcmlhTGl2ZSIsImFyaWFIaWRkZW4iLCJrZXlib2FyZEVuYWJsZWQiLCJwYWdlciIsInBhZ2VyVHlwZSIsInBhZ2VyU2hvcnRTZXBhcmF0b3IiLCJwYWdlclNlbGVjdG9yIiwiYnVpbGRQYWdlciIsInBhZ2VyQ3VzdG9tIiwiY29udHJvbHMiLCJuZXh0VGV4dCIsInByZXZUZXh0IiwibmV4dFNlbGVjdG9yIiwicHJldlNlbGVjdG9yIiwiYXV0b0NvbnRyb2xzIiwic3RhcnRUZXh0Iiwic3RvcFRleHQiLCJhdXRvQ29udHJvbHNDb21iaW5lIiwiYXV0b0NvbnRyb2xzU2VsZWN0b3IiLCJhdXRvIiwicGF1c2UiLCJhdXRvU3RhcnQiLCJhdXRvRGlyZWN0aW9uIiwic3RvcEF1dG9PbkNsaWNrIiwiYXV0b0hvdmVyIiwiYXV0b0RlbGF5IiwiYXV0b1NsaWRlRm9yT25lUGFnZSIsIm1pblNsaWRlcyIsIm1heFNsaWRlcyIsIm1vdmVTbGlkZXMiLCJzbGlkZVdpZHRoIiwic2hyaW5rSXRlbXMiLCJvblNsaWRlckxvYWQiLCJvblNsaWRlQmVmb3JlIiwib25TbGlkZUFmdGVyIiwib25TbGlkZU5leHQiLCJvblNsaWRlUHJldiIsIm9uU2xpZGVyUmVzaXplIiwib25BdXRvQ2hhbmdlIiwiZm4iLCJieFNsaWRlciIsIm9wdGlvbnMiLCJ0aGlzIiwibGVuZ3RoIiwiZWFjaCIsInNsaWRlciIsImVsIiwid2luZG93V2lkdGgiLCJ3aW5kb3ciLCJ3aWR0aCIsIndpbmRvd0hlaWdodCIsImhlaWdodCIsImRhdGEiLCJpbml0Iiwic2V0dGluZ3MiLCJleHRlbmQiLCJwYXJzZUludCIsImNoaWxkcmVuIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwiYWN0aXZlIiwiaW5kZXgiLCJjYXJvdXNlbCIsIm1pblRocmVzaG9sZCIsIm1heFRocmVzaG9sZCIsIndvcmtpbmciLCJpbnRlcnZhbCIsImFuaW1Qcm9wIiwidXNpbmdDU1MiLCJkaXYiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJwcm9wcyIsImkiLCJ1bmRlZmluZWQiLCJzdHlsZSIsImNzc1ByZWZpeCIsInJlcGxhY2UiLCJ0b0xvd2VyQ2FzZSIsImF0dHIiLCJzZXR1cCIsInByZWxvYWRTZWxlY3RvciIsImVxIiwid3JhcCIsInZpZXdwb3J0IiwicGFyZW50IiwibG9hZGVyIiwicHJlcGVuZCIsImNzcyIsInBvc2l0aW9uIiwib3ZlcmZsb3ciLCJtYXhXaWR0aCIsImdldFZpZXdwb3J0TWF4V2lkdGgiLCJmbG9hdCIsImxpc3RTdHlsZSIsImdldFNsaWRlV2lkdGgiLCJ6SW5kZXgiLCJkaXNwbGF5IiwiYXBwZW5kQ2FwdGlvbnMiLCJsYXN0IiwiZ2V0UGFnZXJRdHkiLCJmaXRWaWRzIiwiYXBwZW5kQ29udHJvbHMiLCJhcHBlbmRDb250cm9sc0F1dG8iLCJhcHBlbmRQYWdlciIsImFmdGVyIiwic3RhcnQiLCJsb2FkRWxlbWVudHMiLCJzZWxlY3RvciIsImNhbGxiYWNrIiwidG90YWwiLCJmaW5kIiwiY291bnQiLCJvbmUiLCJjb21wbGV0ZSIsInNyYyIsInRyaWdnZXIiLCJzbGljZSIsInNsaWNlQXBwZW5kIiwic2xpY2VQcmVwZW5kIiwiY2xvbmUiLCJhZGRDbGFzcyIsImFwcGVuZCIsInJlbW92ZSIsInNldFNsaWRlUG9zaXRpb24iLCJnZXRWaWV3cG9ydEhlaWdodCIsInJlZHJhd1NsaWRlciIsImNhbGwiLCJpbml0aWFsaXplZCIsIm9uIiwicmVzaXplV2luZG93IiwiaW5pdEF1dG8iLCJpbml0VGlja2VyIiwidXBkYXRlUGFnZXJBY3RpdmUiLCJ1cGRhdGVEaXJlY3Rpb25Db250cm9scyIsImluaXRUb3VjaCIsImtleWRvd24iLCJrZXlQcmVzcyIsImN1cnJlbnRJbmRleCIsImdldE1vdmVCeSIsImFkZCIsIm91dGVySGVpZ2h0IiwibWF4IiwiYXBwbHkiLCJtYXAiLCJnZXQiLCJwYXJzZUZsb2F0IiwibmV3RWxXaWR0aCIsIndyYXBXaWR0aCIsImNlaWwiLCJnZXROdW1iZXJTbGlkZXNTaG93aW5nIiwiY2hpbGRXaWR0aCIsInNsaWRlc1Nob3dpbmciLCJmaXJzdCIsInBhZ2VyUXR5IiwiYnJlYWtQb2ludCIsImNvdW50ZXIiLCJsYXN0Q2hpbGQiLCJsYXN0U2hvd2luZ0luZGV4Iiwic2V0UG9zaXRpb25Qcm9wZXJ0eSIsImxlZnQiLCJvdXRlcldpZHRoIiwidG9wIiwidmFsdWUiLCJ0eXBlIiwiZHVyYXRpb24iLCJwYXJhbXMiLCJhbmltYXRlT2JqIiwicHJvcFZhbHVlIiwiZSIsInRhcmdldCIsImlzIiwib2ZmIiwidXBkYXRlQWZ0ZXJTbGlkZVRyYW5zaXRpb24iLCJyZXNldFZhbHVlIiwidGlja2VyTG9vcCIsImFuaW1hdGUiLCJwb3B1bGF0ZVBhZ2VyIiwicGFnZXJIdG1sIiwibGlua0NvbnRlbnQiLCJpc0Z1bmN0aW9uIiwicGFnZXJFbCIsImh0bWwiLCJjbGlja1BhZ2VyQmluZCIsIm5leHQiLCJwcmV2IiwiY2xpY2tOZXh0QmluZCIsImNsaWNrUHJldkJpbmQiLCJkaXJlY3Rpb25FbCIsInN0b3AiLCJhdXRvRWwiLCJjbGlja1N0YXJ0QmluZCIsImNsaWNrU3RvcEJpbmQiLCJ1cGRhdGVBdXRvQ29udHJvbHMiLCJ0aXRsZSIsInByZXZlbnREZWZhdWx0IiwiaGFzQ2xhc3MiLCJzdG9wQXV0byIsImdvVG9OZXh0U2xpZGUiLCJnb1RvUHJldlNsaWRlIiwic3RhcnRBdXRvIiwicGFnZXJMaW5rIiwicGFnZXJJbmRleCIsImN1cnJlbnRUYXJnZXQiLCJnb1RvU2xpZGUiLCJzbGlkZUluZGV4IiwibGVuIiwicmVtb3ZlQ2xhc3MiLCJvbGRJbmRleCIsInN0YXRlIiwid2luZG93Rm9jdXNIYW5kbGVyIiwid2luZG93Qmx1ckhhbmRsZXIiLCJzZXRUaW1lb3V0IiwiZm9jdXMiLCJibHVyIiwiaG92ZXIiLCJhdXRvUGF1c2VkIiwidHJhbnNmb3JtIiwiaWR4IiwicmF0aW8iLCJwcm9wZXJ0eSIsIm5ld1NwZWVkIiwidG90YWxEaW1lbnMiLCJzdGFydFBvc2l0aW9uIiwic3BsaXQiLCJhYnMiLCJyZXN1bWVTcGVlZCIsImFuaW1hdGVQcm9wZXJ0eSIsInJlc2V0Iiwid2luIiwiYm91bmRzIiwiYWN0aXZlRWxlbWVudFRhZyIsImFjdGl2ZUVsZW1lbnQiLCJ0YWdOYW1lIiwiUmVnRXhwIiwiZXhlYyIsInNjcm9sbFRvcCIsInNjcm9sbExlZnQiLCJvZmZzZXQiLCJyaWdodCIsImJvdHRvbSIsImtleUNvZGUiLCJ0b3VjaCIsIngiLCJ5IiwiZW5kIiwib25Ub3VjaFN0YXJ0IiwiYnV0dG9uIiwib3JpZ2luYWxQb3MiLCJvcmlnIiwib3JpZ2luYWxFdmVudCIsInRvdWNoUG9pbnRzIiwiY2hhbmdlZFRvdWNoZXMiLCJQb2ludGVyRXZlbnQiLCJwb2ludGVySWQiLCJwYWdlWCIsInBhZ2VZIiwic2V0UG9pbnRlckNhcHR1cmUiLCJvcmlnaW5hbENsaWNrVGFyZ2V0Iiwib3JpZ2luYWxUYXJnZXQiLCJvcmlnaW5hbENsaWNrQnV0dG9uIiwib3JpZ2luYWxDbGlja0J1dHRvbnMiLCJidXR0b25zIiwib3JpZ2luYWxFdmVudFR5cGUiLCJoYXNNb3ZlIiwib25Ub3VjaE1vdmUiLCJvblRvdWNoRW5kIiwib25Qb2ludGVyQ2FuY2VsIiwicmVsZWFzZVBvaW50ZXJDYXB0dXJlIiwieE1vdmVtZW50IiwieU1vdmVtZW50IiwiY2hhbmdlIiwiZGlzdGFuY2UiLCJ3aW5kb3dXaWR0aE5ldyIsIndpbmRvd0hlaWdodE5ldyIsImFwcGx5QXJpYUhpZGRlbkF0dHJpYnV0ZXMiLCJzdGFydFZpc2libGVJbmRleCIsIm51bWJlck9mU2xpZGVzU2hvd2luZyIsImRpcmVjdGlvbiIsInJlcXVlc3RFbCIsInBlcmZvcm1UcmFuc2l0aW9uIiwibW92ZUJ5IiwiZmlsdGVyIiwiZmFkZU91dCIsImZhZGVJbiIsInByZXZlbnRDb250cm9sVXBkYXRlIiwic2V0SW50ZXJ2YWwiLCJjbGVhckludGVydmFsIiwiZ2V0Q3VycmVudFNsaWRlIiwiZ2V0Q3VycmVudFNsaWRlRWxlbWVudCIsImdldFNsaWRlRWxlbWVudCIsImdldFNsaWRlQ291bnQiLCJpc1dvcmtpbmciLCJkZXN0cm95U2xpZGVyIiwicmVtb3ZlQXR0ciIsInVud3JhcCIsInJlbW92ZURhdGEiLCJyZWxvYWRTbGlkZXIiLCJqUXVlcnkiLCJjbG9zZU90aGVycyIsImxpc3QiLCJwYW5lbCIsImNsaWNrIiwiYmxvY2siLCJwcm9maWxlIiwic2Nyb2xsSGVpZ2h0IiwiJHRoaXMiLCJjbG9zZXN0IiwiY2xvc2VFdmVyeUl0ZW1Db250YWluZXIiLCJjb250YWluZXIiLCJpdGVtIiwiY29udGVudCIsIm9wZW5JdGVtIiwicmVxSXRlbVdpZHRoIiwic2NyZWVuV2lkdGgiLCJ0aXRsZXNCbG9ja3MiLCJ0aXRsZXNXaWR0aCIsInRleHRDb250YWluZXIiLCJwYWRkaW5nTGVmdCIsInBhZGRpbmdSaWdodCIsImhpZGRlbkNvbnRlbnQiLCJyZXFXaWR0aCIsIm1hdGNoTWVkaWEiLCJtYXRjaGVzIiwidGV4dEJsb2NrIiwiaXRlbU9wZW5lZCIsIm15TWFwIiwieW1hcHMiLCJyZWFkeSIsIk1hcCIsImNlbnRlciIsInpvb20iLCJteUNvbGxlY3Rpb24iLCJHZW9PYmplY3RDb2xsZWN0aW9uIiwiZHJhZ2dhYmxlIiwiaWNvbkxheW91dCIsImljb25JbWFnZUhyZWYiLCJpY29uSW1hZ2VTaXplIiwiaWNvbkltYWdlT2Zmc2V0IiwiZm9yRWFjaCIsImNvb3JkIiwiUGxhY2VtYXJrIiwiZ2VvT2JqZWN0cyIsImJlaGF2aW9ycyIsImRpc2FibGUiLCJidXJnZXIiLCJxdWVyeVNlbGVjdG9yIiwibWVudSIsImFkZEV2ZW50TGlzdGVuZXIiLCJjbGFzc0xpc3QiLCJjb250YWlucyIsInN1Ym1pdCIsImZvcm0iLCJyZXF1ZXN0IiwibmFtZSIsInBob25lIiwiY29tbWVudCIsInRvIiwibW9kYWwiLCJmaWVsZCIsInZhbCIsInRyaW0iLCJhamF4IiwidXJsIiwibWV0aG9kIiwiZG9uZSIsInRleHQiLCJtZXNzYWdlIiwiZmFpbCIsInJlc3BvbnNlSlNPTiIsImFsd2F5cyIsImZhbmN5Ym94Iiwib3BlbiIsImNsb3NlIiwic2VjdGlvbnMiLCJzaWRlTWVudSIsIm1lbnVJdGVtcyIsImlzTW9iaWxlIiwiTW9iaWxlRGV0ZWN0IiwibmF2aWdhdG9yIiwidXNlckFnZW50IiwibW9iaWxlIiwiaW5TY3JvbGwiLCJyZXNldEFjdGl2ZUNsYXNzRm9ySXRlbSIsIml0ZW1zIiwiaXRlbUVxIiwiYWN0aXZlQ2xhc3MiLCJzaWJsaW5ncyIsInNlY3Rpb25FcSIsImNvbmNhdCIsInNjcm9sbFZpZXdwb3J0IiwiYWN0aXZlU2VjdGlvbiIsIm5leHRTZWN0aW9uIiwicHJldlNlY3Rpb24iLCJkZWx0YVkiLCJyZXFTZWN0aW9uIiwic3dpcGUiLCJldmVudCIsInZpZXdwb3J0U2Nyb2xsZXIiLCJwbGF5ZXIiLCJwbGF5ZXJTdGFydCIsInZvbHVtZUJ0biIsIm9uUGxheWVyUmVhZHkiLCJkdXJhdGlvblNlYyIsImdldER1cmF0aW9uIiwiY29tcGxldGVkUGVyY2VudCIsImdldEN1cnJlbnRUaW1lIiwicGF1c2VWaWRlbyIsInBsYXlWaWRlbyIsImJhciIsIm5ld0J1dHRvblBvc2l0aW9uUGVyY2VudCIsImxheWVyWCIsIm5ld1BsYXliYWNrUG9zaXRpb25TZWMiLCJzZWVrVG8iLCJ1bk11dGUiLCJtdXRlIiwiYmFyVm9sdW1lIiwibmV3Vm9sdW1lQnV0dG9uUG9zaXRpb25QZXJjZW50IiwiZ2V0Vm9sdW1lIiwic2V0Vm9sdW1lIiwiYWxpYXMiLCJpdGVtVG9TaG93IiwibmR4IiwiY3VySXRlbSJdLCJtYXBwaW5ncyI6ImNBT0EsU0FBQUEsR0FFQSxJQUFBQyxFQUFBLENBR0FDLEtBQUEsYUFDQUMsY0FBQSxHQUNBQyxjQUFBLEVBQ0FDLGtCQUFBLEVBQ0FDLE1BQUEsSUFDQUMsT0FBQSxLQUNBQyxZQUFBLEVBQ0FDLFdBQUEsRUFDQUMsYUFBQSxFQUNBQyxVQUFBLEVBQ0FDLFFBQUEsRUFDQUMsYUFBQSxFQUNBQyxnQkFBQSxFQUNBQyxvQkFBQSxJQUNBQyxPQUFBLEVBQ0FDLFFBQUEsRUFDQUMsY0FBQSxVQUNBQyxZQUFBLEVBQ0FDLFlBQUEsR0FDQUMsYUFBQSxhQUdBQyxjQUFBLEVBQ0FDLGVBQUEsR0FDQUMsZUFBQSxFQUNBQyxzQkFBQSxFQUNBQyxzQkFBQSxFQUdBQyxVQUFBLEVBQ0FDLFlBQUEsRUFHQUMsaUJBQUEsRUFHQUMsT0FBQSxFQUNBQyxVQUFBLE9BQ0FDLG9CQUFBLE1BQ0FDLGNBQUEsS0FDQUMsV0FBQSxLQUNBQyxZQUFBLEtBR0FDLFVBQUEsRUFDQUMsU0FBQSxPQUNBQyxTQUFBLE9BQ0FDLGFBQUEsS0FDQUMsYUFBQSxLQUNBQyxjQUFBLEVBQ0FDLFVBQUEsUUFDQUMsU0FBQSxPQUNBQyxxQkFBQSxFQUNBQyxxQkFBQSxLQUdBQyxNQUFBLEVBQ0FDLE1BQUEsSUFDQUMsV0FBQSxFQUNBQyxjQUFBLE9BQ0FDLGlCQUFBLEVBQ0FDLFdBQUEsRUFDQUMsVUFBQSxFQUNBQyxxQkFBQSxFQUdB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QUFxTyxPQUFBNEIsRUFBQSxPQUdBbEIsRUFBQW9CLFVBQUFGLEtBekVBLEdDdEdBLFdBQ0EsSUFBQXJYLEVBQUF4RSxFQUFBLFdBQUFtRSxTQUFBLENBQ0FyQyxPQUFBLEVBQ0FNLFVBQUEsSUFHQXBDLEVBQUEsNEJBQUEwVSxNQUFBLFNBQUFySSxHQUNBQSxFQUFBMEIsaUJBQ0F2SixFQUFBMkosa0JBR0FuTyxFQUFBLCtCQUFBMFUsTUFBQSxTQUFBckksR0FDQUEsRUFBQTBCLGlCQUNBdkosRUFBQTBKLGtCQWJBLEdDTUFsTyxFQUFBLDZCQUFBMFUsTUFBQSxTQUFBckksR0FDQUEsRUFBQTBCLGlCQUVBLElBUkFpTyxFQVFBbEgsRUFBQTlVLEVBQUFxTSxFQUFBa0MsZUFDQWpDLEVBQUF3SSxFQUFBbk8sS0FBQSxhQUNBc1YsR0FWQUQsRUFVQTFQLEVBVEF0TSxFQUFBLGtCQUFBc1QsT0FBQSxTQUFBNEksRUFBQWhILEdBQ0EsT0FBQWxWLEVBQUFrVixHQUFBdk8sS0FBQSxxQkFBQXFWLEtBU0FHLEVBQUFySCxFQUFBQyxRQUFBLDJCQUVBa0gsRUFBQTVTLFNBQUEsZUFBQTBRLFdBQUFwTCxZQUFBLGVBQ0F3TixFQUFBOVMsU0FBQSxnQkFBQTBRLFdBQUFwTCxZQUFBIiwiZmlsZSI6Im1haW4ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBieFNsaWRlciB2NC4yLjFkXG4gKiBDb3B5cmlnaHQgMjAxMy0yMDE3IFN0ZXZlbiBXYW5kZXJza2lcbiAqIFdyaXR0ZW4gd2hpbGUgZHJpbmtpbmcgQmVsZ2lhbiBhbGVzIGFuZCBsaXN0ZW5pbmcgdG8gamF6elxuICogTGljZW5zZWQgdW5kZXIgTUlUIChodHRwOi8vb3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvTUlUKVxuICovXG5cbjsoZnVuY3Rpb24oJCkge1xuXG4gIHZhciBkZWZhdWx0cyA9IHtcblxuICAgIC8vIEdFTkVSQUxcbiAgICBtb2RlOiAnaG9yaXpvbnRhbCcsXG4gICAgc2xpZGVTZWxlY3RvcjogJycsXG4gICAgaW5maW5pdGVMb29wOiB0cnVlLFxuICAgIGhpZGVDb250cm9sT25FbmQ6IGZhbHNlLFxuICAgIHNwZWVkOiA1MDAsXG4gICAgZWFzaW5nOiBudWxsLFxuICAgIHNsaWRlTWFyZ2luOiAwLFxuICAgIHN0YXJ0U2xpZGU6IDAsXG4gICAgcmFuZG9tU3RhcnQ6IGZhbHNlLFxuICAgIGNhcHRpb25zOiBmYWxzZSxcbiAgICB0aWNrZXI6IGZhbHNlLFxuICAgIHRpY2tlckhvdmVyOiBmYWxzZSxcbiAgICBhZGFwdGl2ZUhlaWdodDogZmFsc2UsXG4gICAgYWRhcHRpdmVIZWlnaHRTcGVlZDogNTAwLFxuICAgIHZpZGVvOiBmYWxzZSxcbiAgICB1c2VDU1M6IHRydWUsXG4gICAgcHJlbG9hZEltYWdlczogJ3Zpc2libGUnLFxuICAgIHJlc3BvbnNpdmU6IHRydWUsXG4gICAgc2xpZGVaSW5kZXg6IDUwLFxuICAgIHdyYXBwZXJDbGFzczogJ2J4LXdyYXBwZXInLFxuXG4gICAgLy8gVE9VQ0hcbiAgICB0b3VjaEVuYWJsZWQ6IHRydWUsXG4gICAgc3dpcGVUaHJlc2hvbGQ6IDUwLFxuICAgIG9uZVRvT25lVG91Y2g6IHRydWUsXG4gICAgcHJldmVudERlZmF1bHRTd2lwZVg6IHRydWUsXG4gICAgcHJldmVudERlZmF1bHRTd2lwZVk6IGZhbHNlLFxuXG4gICAgLy8gQUNDRVNTSUJJTElUWVxuICAgIGFyaWFMaXZlOiB0cnVlLFxuICAgIGFyaWFIaWRkZW46IHRydWUsXG5cbiAgICAvLyBLRVlCT0FSRFxuICAgIGtleWJvYXJkRW5hYmxlZDogZmFsc2UsXG5cbiAgICAvLyBQQUdFUlxuICAgIHBhZ2VyOiB0cnVlLFxuICAgIHBhZ2VyVHlwZTogJ2Z1bGwnLFxuICAgIHBhZ2VyU2hvcnRTZXBhcmF0b3I6ICcgLyAnLFxuICAgIHBhZ2VyU2VsZWN0b3I6IG51bGwsXG4gICAgYnVpbGRQYWdlcjogbnVsbCxcbiAgICBwYWdlckN1c3RvbTogbnVsbCxcblxuICAgIC8vIENPTlRST0xTXG4gICAgY29udHJvbHM6IHRydWUsXG4gICAgbmV4dFRleHQ6ICdOZXh0JyxcbiAgICBwcmV2VGV4dDogJ1ByZXYnLFxuICAgIG5leHRTZWxlY3RvcjogbnVsbCxcbiAgICBwcmV2U2VsZWN0b3I6IG51bGwsXG4gICAgYXV0b0NvbnRyb2xzOiBmYWxzZSxcbiAgICBzdGFydFRleHQ6ICdTdGFydCcsXG4gICAgc3RvcFRleHQ6ICdTdG9wJyxcbiAgICBhdXRvQ29udHJvbHNDb21iaW5lOiBmYWxzZSxcbiAgICBhdXRvQ29udHJvbHNTZWxlY3RvcjogbnVsbCxcblxuICAgIC8vIEFVVE9cbiAgICBhdXRvOiBmYWxzZSxcbiAgICBwYXVzZTogNDAwMCxcbiAgICBhdXRvU3RhcnQ6IHRydWUsXG4gICAgYXV0b0RpcmVjdGlvbjogJ25leHQnLFxuICAgIHN0b3BBdXRvT25DbGljazogZmFsc2UsXG4gICAgYXV0b0hvdmVyOiBmYWxzZSxcbiAgICBhdXRvRGVsYXk6IDAsXG4gICAgYXV0b1NsaWRlRm9yT25lUGFnZTogZmFsc2UsXG5cbiAgICAvLyBDQVJPVVNFTFxuICAgIG1pblNsaWRlczogMSxcbiAgICBtYXhTbGlkZXM6IDEsXG4gICAgbW92ZVNsaWRlczogMCxcbiAgICBzbGlkZVdpZHRoOiAwLFxuICAgIHNocmlua0l0ZW1zOiBmYWxzZSxcblxuICAgIC8vIENBTExCQUNLU1xuICAgIG9uU2xpZGVyTG9hZDogZnVuY3Rpb24oKSB7IHJldHVybiB0cnVlOyB9LFxuICAgIG9uU2xpZGVCZWZvcmU6IGZ1bmN0aW9uKCkgeyByZXR1cm4gdHJ1ZTsgfSxcbiAgICBvblNsaWRlQWZ0ZXI6IGZ1bmN0aW9uKCkgeyByZXR1cm4gdHJ1ZTsgfSxcbiAgICBvblNsaWRlTmV4dDogZnVuY3Rpb24oKSB7IHJldHVybiB0cnVlOyB9LFxuICAgIG9uU2xpZGVQcmV2OiBmdW5jdGlvbigpIHsgcmV0dXJuIHRydWU7IH0sXG4gICAgb25TbGlkZXJSZXNpemU6IGZ1bmN0aW9uKCkgeyByZXR1cm4gdHJ1ZTsgfSxcblx0b25BdXRvQ2hhbmdlOiBmdW5jdGlvbigpIHsgcmV0dXJuIHRydWU7IH0gLy9jYWxscyB3aGVuIGF1dG8gc2xpZGVzIHN0YXJ0cyBhbmQgc3RvcHNcbiAgfTtcblxuICAkLmZuLmJ4U2xpZGVyID0gZnVuY3Rpb24ob3B0aW9ucykge1xuXG4gICAgaWYgKHRoaXMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvLyBzdXBwb3J0IG11bHRpcGxlIGVsZW1lbnRzXG4gICAgaWYgKHRoaXMubGVuZ3RoID4gMSkge1xuICAgICAgdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAkKHRoaXMpLmJ4U2xpZGVyKG9wdGlvbnMpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvLyBjcmVhdGUgYSBuYW1lc3BhY2UgdG8gYmUgdXNlZCB0aHJvdWdob3V0IHRoZSBwbHVnaW5cbiAgICB2YXIgc2xpZGVyID0ge30sXG4gICAgLy8gc2V0IGEgcmVmZXJlbmNlIHRvIG91ciBzbGlkZXIgZWxlbWVudFxuICAgIGVsID0gdGhpcyxcbiAgICAvLyBnZXQgdGhlIG9yaWdpbmFsIHdpbmRvdyBkaW1lbnMgKHRoYW5rcyBhIGxvdCBJRSlcbiAgICB3aW5kb3dXaWR0aCA9ICQod2luZG93KS53aWR0aCgpLFxuICAgIHdpbmRvd0hlaWdodCA9ICQod2luZG93KS5oZWlnaHQoKTtcblxuICAgIC8vIFJldHVybiBpZiBzbGlkZXIgaXMgYWxyZWFkeSBpbml0aWFsaXplZFxuICAgIGlmICgkKGVsKS5kYXRhKCdieFNsaWRlcicpKSB7IHJldHVybjsgfVxuXG4gICAgLyoqXG4gICAgICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgKiA9IFBSSVZBVEUgRlVOQ1RJT05TXG4gICAgICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgKi9cblxuICAgIC8qKlxuICAgICAqIEluaXRpYWxpemVzIG5hbWVzcGFjZSBzZXR0aW5ncyB0byBiZSB1c2VkIHRocm91Z2hvdXQgcGx1Z2luXG4gICAgICovXG4gICAgdmFyIGluaXQgPSBmdW5jdGlvbigpIHtcbiAgICAgIC8vIFJldHVybiBpZiBzbGlkZXIgaXMgYWxyZWFkeSBpbml0aWFsaXplZFxuICAgICAgaWYgKCQoZWwpLmRhdGEoJ2J4U2xpZGVyJykpIHsgcmV0dXJuOyB9XG4gICAgICAvLyBtZXJnZSB1c2VyLXN1cHBsaWVkIG9wdGlvbnMgd2l0aCB0aGUgZGVmYXVsdHNcbiAgICAgIHNsaWRlci5zZXR0aW5ncyA9ICQuZXh0ZW5kKHt9LCBkZWZhdWx0cywgb3B0aW9ucyk7XG4gICAgICAvLyBwYXJzZSBzbGlkZVdpZHRoIHNldHRpbmdcbiAgICAgIHNsaWRlci5zZXR0aW5ncy5zbGlkZVdpZHRoID0gcGFyc2VJbnQoc2xpZGVyLnNldHRpbmdzLnNsaWRlV2lkdGgpO1xuICAgICAgLy8gc3RvcmUgdGhlIG9yaWdpbmFsIGNoaWxkcmVuXG4gICAgICBzbGlkZXIuY2hpbGRyZW4gPSBlbC5jaGlsZHJlbihzbGlkZXIuc2V0dGluZ3Muc2xpZGVTZWxlY3Rvcik7XG4gICAgICAvLyBjaGVjayBpZiBhY3R1YWwgbnVtYmVyIG9mIHNsaWRlcyBpcyBsZXNzIHRoYW4gbWluU2xpZGVzIC8gbWF4U2xpZGVzXG4gICAgICBpZiAoc2xpZGVyLmNoaWxkcmVuLmxlbmd0aCA8IHNsaWRlci5zZXR0aW5ncy5taW5TbGlkZXMpIHsgc2xpZGVyLnNldHRpbmdzLm1pblNsaWRlcyA9IHNsaWRlci5jaGlsZHJlbi5sZW5ndGg7IH1cbiAgICAgIGlmIChzbGlkZXIuY2hpbGRyZW4ubGVuZ3RoIDwgc2xpZGVyLnNldHRpbmdzLm1heFNsaWRlcykgeyBzbGlkZXIuc2V0dGluZ3MubWF4U2xpZGVzID0gc2xpZGVyLmNoaWxkcmVuLmxlbmd0aDsgfVxuICAgICAgLy8gaWYgcmFuZG9tIHN0YXJ0LCBzZXQgdGhlIHN0YXJ0U2xpZGUgc2V0dGluZyB0byByYW5kb20gbnVtYmVyXG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLnJhbmRvbVN0YXJ0KSB7IHNsaWRlci5zZXR0aW5ncy5zdGFydFNsaWRlID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogc2xpZGVyLmNoaWxkcmVuLmxlbmd0aCk7IH1cbiAgICAgIC8vIHN0b3JlIGFjdGl2ZSBzbGlkZSBpbmZvcm1hdGlvblxuICAgICAgc2xpZGVyLmFjdGl2ZSA9IHsgaW5kZXg6IHNsaWRlci5zZXR0aW5ncy5zdGFydFNsaWRlIH07XG4gICAgICAvLyBzdG9yZSBpZiB0aGUgc2xpZGVyIGlzIGluIGNhcm91c2VsIG1vZGUgKGRpc3BsYXlpbmcgLyBtb3ZpbmcgbXVsdGlwbGUgc2xpZGVzKVxuICAgICAgc2xpZGVyLmNhcm91c2VsID0gc2xpZGVyLnNldHRpbmdzLm1pblNsaWRlcyA+IDEgfHwgc2xpZGVyLnNldHRpbmdzLm1heFNsaWRlcyA+IDE7XG4gICAgICAvLyBpZiBjYXJvdXNlbCwgZm9yY2UgcHJlbG9hZEltYWdlcyA9ICdhbGwnXG4gICAgICBpZiAoc2xpZGVyLmNhcm91c2VsKSB7IHNsaWRlci5zZXR0aW5ncy5wcmVsb2FkSW1hZ2VzID0gJ2FsbCc7IH1cbiAgICAgIC8vIGNhbGN1bGF0ZSB0aGUgbWluIC8gbWF4IHdpZHRoIHRocmVzaG9sZHMgYmFzZWQgb24gbWluIC8gbWF4IG51bWJlciBvZiBzbGlkZXNcbiAgICAgIC8vIHVzZWQgdG8gc2V0dXAgYW5kIHVwZGF0ZSBjYXJvdXNlbCBzbGlkZXMgZGltZW5zaW9uc1xuICAgICAgc2xpZGVyLm1pblRocmVzaG9sZCA9IChzbGlkZXIuc2V0dGluZ3MubWluU2xpZGVzICogc2xpZGVyLnNldHRpbmdzLnNsaWRlV2lkdGgpICsgKChzbGlkZXIuc2V0dGluZ3MubWluU2xpZGVzIC0gMSkgKiBzbGlkZXIuc2V0dGluZ3Muc2xpZGVNYXJnaW4pO1xuICAgICAgc2xpZGVyLm1heFRocmVzaG9sZCA9IChzbGlkZXIuc2V0dGluZ3MubWF4U2xpZGVzICogc2xpZGVyLnNldHRpbmdzLnNsaWRlV2lkdGgpICsgKChzbGlkZXIuc2V0dGluZ3MubWF4U2xpZGVzIC0gMSkgKiBzbGlkZXIuc2V0dGluZ3Muc2xpZGVNYXJnaW4pO1xuICAgICAgLy8gc3RvcmUgdGhlIGN1cnJlbnQgc3RhdGUgb2YgdGhlIHNsaWRlciAoaWYgY3VycmVudGx5IGFuaW1hdGluZywgd29ya2luZyBpcyB0cnVlKVxuICAgICAgc2xpZGVyLndvcmtpbmcgPSBmYWxzZTtcbiAgICAgIC8vIGluaXRpYWxpemUgdGhlIGNvbnRyb2xzIG9iamVjdFxuICAgICAgc2xpZGVyLmNvbnRyb2xzID0ge307XG4gICAgICAvLyBpbml0aWFsaXplIGFuIGF1dG8gaW50ZXJ2YWxcbiAgICAgIHNsaWRlci5pbnRlcnZhbCA9IG51bGw7XG4gICAgICAvLyBkZXRlcm1pbmUgd2hpY2ggcHJvcGVydHkgdG8gdXNlIGZvciB0cmFuc2l0aW9uc1xuICAgICAgc2xpZGVyLmFuaW1Qcm9wID0gc2xpZGVyLnNldHRpbmdzLm1vZGUgPT09ICd2ZXJ0aWNhbCcgPyAndG9wJyA6ICdsZWZ0JztcbiAgICAgIC8vIGRldGVybWluZSBpZiBoYXJkd2FyZSBhY2NlbGVyYXRpb24gY2FuIGJlIHVzZWRcbiAgICAgIHNsaWRlci51c2luZ0NTUyA9IHNsaWRlci5zZXR0aW5ncy51c2VDU1MgJiYgc2xpZGVyLnNldHRpbmdzLm1vZGUgIT09ICdmYWRlJyAmJiAoZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIGNyZWF0ZSBvdXIgdGVzdCBkaXYgZWxlbWVudFxuICAgICAgICB2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JyksXG4gICAgICAgIC8vIGNzcyB0cmFuc2l0aW9uIHByb3BlcnRpZXNcbiAgICAgICAgcHJvcHMgPSBbJ1dlYmtpdFBlcnNwZWN0aXZlJywgJ01velBlcnNwZWN0aXZlJywgJ09QZXJzcGVjdGl2ZScsICdtc1BlcnNwZWN0aXZlJ107XG4gICAgICAgIC8vIHRlc3QgZm9yIGVhY2ggcHJvcGVydHlcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGlmIChkaXYuc3R5bGVbcHJvcHNbaV1dICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHNsaWRlci5jc3NQcmVmaXggPSBwcm9wc1tpXS5yZXBsYWNlKCdQZXJzcGVjdGl2ZScsICcnKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgc2xpZGVyLmFuaW1Qcm9wID0gJy0nICsgc2xpZGVyLmNzc1ByZWZpeCArICctdHJhbnNmb3JtJztcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9KCkpO1xuICAgICAgLy8gaWYgdmVydGljYWwgbW9kZSBhbHdheXMgbWFrZSBtYXhTbGlkZXMgYW5kIG1pblNsaWRlcyBlcXVhbFxuICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5tb2RlID09PSAndmVydGljYWwnKSB7IHNsaWRlci5zZXR0aW5ncy5tYXhTbGlkZXMgPSBzbGlkZXIuc2V0dGluZ3MubWluU2xpZGVzOyB9XG4gICAgICAvLyBzYXZlIG9yaWdpbmFsIHN0eWxlIGRhdGFcbiAgICAgIGVsLmRhdGEoJ29yaWdTdHlsZScsIGVsLmF0dHIoJ3N0eWxlJykpO1xuICAgICAgZWwuY2hpbGRyZW4oc2xpZGVyLnNldHRpbmdzLnNsaWRlU2VsZWN0b3IpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgICQodGhpcykuZGF0YSgnb3JpZ1N0eWxlJywgJCh0aGlzKS5hdHRyKCdzdHlsZScpKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBwZXJmb3JtIGFsbCBET00gLyBDU1MgbW9kaWZpY2F0aW9uc1xuICAgICAgc2V0dXAoKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUGVyZm9ybXMgYWxsIERPTSBhbmQgQ1NTIG1vZGlmaWNhdGlvbnNcbiAgICAgKi9cbiAgICB2YXIgc2V0dXAgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBwcmVsb2FkU2VsZWN0b3IgPSBzbGlkZXIuY2hpbGRyZW4uZXEoc2xpZGVyLnNldHRpbmdzLnN0YXJ0U2xpZGUpOyAvLyBzZXQgdGhlIGRlZmF1bHQgcHJlbG9hZCBzZWxlY3RvciAodmlzaWJsZSlcblxuICAgICAgLy8gd3JhcCBlbCBpbiBhIHdyYXBwZXJcbiAgICAgIGVsLndyYXAoJzxkaXYgY2xhc3M9XCInICsgc2xpZGVyLnNldHRpbmdzLndyYXBwZXJDbGFzcyArICdcIj48ZGl2IGNsYXNzPVwiYngtdmlld3BvcnRcIj48L2Rpdj48L2Rpdj4nKTtcbiAgICAgIC8vIHN0b3JlIGEgbmFtZXNwYWNlIHJlZmVyZW5jZSB0byAuYngtdmlld3BvcnRcbiAgICAgIHNsaWRlci52aWV3cG9ydCA9IGVsLnBhcmVudCgpO1xuXG4gICAgICAvLyBhZGQgYXJpYS1saXZlIGlmIHRoZSBzZXR0aW5nIGlzIGVuYWJsZWQgYW5kIHRpY2tlciBtb2RlIGlzIGRpc2FibGVkXG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmFyaWFMaXZlICYmICFzbGlkZXIuc2V0dGluZ3MudGlja2VyKSB7XG4gICAgICAgIHNsaWRlci52aWV3cG9ydC5hdHRyKCdhcmlhLWxpdmUnLCAncG9saXRlJyk7XG4gICAgICB9XG4gICAgICAvLyBhZGQgYSBsb2FkaW5nIGRpdiB0byBkaXNwbGF5IHdoaWxlIGltYWdlcyBhcmUgbG9hZGluZ1xuICAgICAgc2xpZGVyLmxvYWRlciA9ICQoJzxkaXYgY2xhc3M9XCJieC1sb2FkaW5nXCIgLz4nKTtcbiAgICAgIHNsaWRlci52aWV3cG9ydC5wcmVwZW5kKHNsaWRlci5sb2FkZXIpO1xuICAgICAgLy8gc2V0IGVsIHRvIGEgbWFzc2l2ZSB3aWR0aCwgdG8gaG9sZCBhbnkgbmVlZGVkIHNsaWRlc1xuICAgICAgLy8gYWxzbyBzdHJpcCBhbnkgbWFyZ2luIGFuZCBwYWRkaW5nIGZyb20gZWxcbiAgICAgIGVsLmNzcyh7XG4gICAgICAgIHdpZHRoOiBzbGlkZXIuc2V0dGluZ3MubW9kZSA9PT0gJ2hvcml6b250YWwnID8gKHNsaWRlci5jaGlsZHJlbi5sZW5ndGggKiAxMDAwICsgMjE1KSArICclJyA6ICdhdXRvJyxcbiAgICAgICAgcG9zaXRpb246ICdyZWxhdGl2ZSdcbiAgICAgIH0pO1xuICAgICAgLy8gaWYgdXNpbmcgQ1NTLCBhZGQgdGhlIGVhc2luZyBwcm9wZXJ0eVxuICAgICAgaWYgKHNsaWRlci51c2luZ0NTUyAmJiBzbGlkZXIuc2V0dGluZ3MuZWFzaW5nKSB7XG4gICAgICAgIGVsLmNzcygnLScgKyBzbGlkZXIuY3NzUHJlZml4ICsgJy10cmFuc2l0aW9uLXRpbWluZy1mdW5jdGlvbicsIHNsaWRlci5zZXR0aW5ncy5lYXNpbmcpO1xuICAgICAgLy8gaWYgbm90IHVzaW5nIENTUyBhbmQgbm8gZWFzaW5nIHZhbHVlIHdhcyBzdXBwbGllZCwgdXNlIHRoZSBkZWZhdWx0IEpTIGFuaW1hdGlvbiBlYXNpbmcgKHN3aW5nKVxuICAgICAgfSBlbHNlIGlmICghc2xpZGVyLnNldHRpbmdzLmVhc2luZykge1xuICAgICAgICBzbGlkZXIuc2V0dGluZ3MuZWFzaW5nID0gJ3N3aW5nJztcbiAgICAgIH1cbiAgICAgIC8vIG1ha2UgbW9kaWZpY2F0aW9ucyB0byB0aGUgdmlld3BvcnQgKC5ieC12aWV3cG9ydClcbiAgICAgIHNsaWRlci52aWV3cG9ydC5jc3Moe1xuICAgICAgICB3aWR0aDogJzEwMCUnLFxuICAgICAgICBvdmVyZmxvdzogJ2hpZGRlbicsXG4gICAgICAgIHBvc2l0aW9uOiAncmVsYXRpdmUnXG4gICAgICB9KTtcbiAgICAgIHNsaWRlci52aWV3cG9ydC5wYXJlbnQoKS5jc3Moe1xuICAgICAgICBtYXhXaWR0aDogZ2V0Vmlld3BvcnRNYXhXaWR0aCgpXG4gICAgICB9KTtcbiAgICAgIC8vIGFwcGx5IGNzcyB0byBhbGwgc2xpZGVyIGNoaWxkcmVuXG4gICAgICBzbGlkZXIuY2hpbGRyZW4uY3NzKHtcbiAgICAgICAgLy8gdGhlIGZsb2F0IGF0dHJpYnV0ZSBpcyBhIHJlc2VydmVkIHdvcmQgaW4gY29tcHJlc3NvcnMgbGlrZSBZVUkgY29tcHJlc3NvciBhbmQgbmVlZCB0byBiZSBxdW90ZWQgIzQ4XG4gICAgICAgICdmbG9hdCc6IHNsaWRlci5zZXR0aW5ncy5tb2RlID09PSAnaG9yaXpvbnRhbCcgPyAnbGVmdCcgOiAnbm9uZScsXG4gICAgICAgIGxpc3RTdHlsZTogJ25vbmUnLFxuICAgICAgICBwb3NpdGlvbjogJ3JlbGF0aXZlJ1xuICAgICAgfSk7XG4gICAgICAvLyBhcHBseSB0aGUgY2FsY3VsYXRlZCB3aWR0aCBhZnRlciB0aGUgZmxvYXQgaXMgYXBwbGllZCB0byBwcmV2ZW50IHNjcm9sbGJhciBpbnRlcmZlcmVuY2VcbiAgICAgIHNsaWRlci5jaGlsZHJlbi5jc3MoJ3dpZHRoJywgZ2V0U2xpZGVXaWR0aCgpKTtcbiAgICAgIC8vIGlmIHNsaWRlTWFyZ2luIGlzIHN1cHBsaWVkLCBhZGQgdGhlIGNzc1xuICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5tb2RlID09PSAnaG9yaXpvbnRhbCcgJiYgc2xpZGVyLnNldHRpbmdzLnNsaWRlTWFyZ2luID4gMCkgeyBzbGlkZXIuY2hpbGRyZW4uY3NzKCdtYXJnaW5SaWdodCcsIHNsaWRlci5zZXR0aW5ncy5zbGlkZU1hcmdpbik7IH1cbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MubW9kZSA9PT0gJ3ZlcnRpY2FsJyAmJiBzbGlkZXIuc2V0dGluZ3Muc2xpZGVNYXJnaW4gPiAwKSB7IHNsaWRlci5jaGlsZHJlbi5jc3MoJ21hcmdpbkJvdHRvbScsIHNsaWRlci5zZXR0aW5ncy5zbGlkZU1hcmdpbik7IH1cbiAgICAgIC8vIGlmIFwiZmFkZVwiIG1vZGUsIGFkZCBwb3NpdGlvbmluZyBhbmQgei1pbmRleCBDU1NcbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MubW9kZSA9PT0gJ2ZhZGUnKSB7XG4gICAgICAgIHNsaWRlci5jaGlsZHJlbi5jc3Moe1xuICAgICAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgICAgICAgIHpJbmRleDogMCxcbiAgICAgICAgICBkaXNwbGF5OiAnbm9uZSdcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIHByZXBhcmUgdGhlIHotaW5kZXggb24gdGhlIHNob3dpbmcgZWxlbWVudFxuICAgICAgICBzbGlkZXIuY2hpbGRyZW4uZXEoc2xpZGVyLnNldHRpbmdzLnN0YXJ0U2xpZGUpLmNzcyh7ekluZGV4OiBzbGlkZXIuc2V0dGluZ3Muc2xpZGVaSW5kZXgsIGRpc3BsYXk6ICdibG9jayd9KTtcbiAgICAgIH1cbiAgICAgIC8vIGNyZWF0ZSBhbiBlbGVtZW50IHRvIGNvbnRhaW4gYWxsIHNsaWRlciBjb250cm9scyAocGFnZXIsIHN0YXJ0IC8gc3RvcCwgZXRjKVxuICAgICAgc2xpZGVyLmNvbnRyb2xzLmVsID0gJCgnPGRpdiBjbGFzcz1cImJ4LWNvbnRyb2xzXCIgLz4nKTtcbiAgICAgIC8vIGlmIGNhcHRpb25zIGFyZSByZXF1ZXN0ZWQsIGFkZCB0aGVtXG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmNhcHRpb25zKSB7IGFwcGVuZENhcHRpb25zKCk7IH1cbiAgICAgIC8vIGNoZWNrIGlmIHN0YXJ0U2xpZGUgaXMgbGFzdCBzbGlkZVxuICAgICAgc2xpZGVyLmFjdGl2ZS5sYXN0ID0gc2xpZGVyLnNldHRpbmdzLnN0YXJ0U2xpZGUgPT09IGdldFBhZ2VyUXR5KCkgLSAxO1xuICAgICAgLy8gaWYgdmlkZW8gaXMgdHJ1ZSwgc2V0IHVwIHRoZSBmaXRWaWRzIHBsdWdpblxuICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy52aWRlbykgeyBlbC5maXRWaWRzKCk7IH1cblx0ICAvL3ByZWxvYWRJbWFnZXNcblx0ICBpZiAoc2xpZGVyLnNldHRpbmdzLnByZWxvYWRJbWFnZXMgPT09ICdub25lJykgeyBcblx0XHQgIHByZWxvYWRTZWxlY3RvciA9IG51bGw7IFxuXHQgIH1cbiAgICAgIGVsc2UgaWYgKHNsaWRlci5zZXR0aW5ncy5wcmVsb2FkSW1hZ2VzID09PSAnYWxsJyB8fCBzbGlkZXIuc2V0dGluZ3MudGlja2VyKSB7IFxuXHRcdCAgcHJlbG9hZFNlbGVjdG9yID0gc2xpZGVyLmNoaWxkcmVuOyBcblx0ICB9XG4gICAgICAvLyBvbmx5IGNoZWNrIGZvciBjb250cm9sIGFkZGl0aW9uIGlmIG5vdCBpbiBcInRpY2tlclwiIG1vZGVcbiAgICAgIGlmICghc2xpZGVyLnNldHRpbmdzLnRpY2tlcikge1xuICAgICAgICAvLyBpZiBjb250cm9scyBhcmUgcmVxdWVzdGVkLCBhZGQgdGhlbVxuICAgICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmNvbnRyb2xzKSB7IGFwcGVuZENvbnRyb2xzKCk7IH1cbiAgICAgICAgLy8gaWYgYXV0byBpcyB0cnVlLCBhbmQgYXV0byBjb250cm9scyBhcmUgcmVxdWVzdGVkLCBhZGQgdGhlbVxuICAgICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmF1dG8gJiYgc2xpZGVyLnNldHRpbmdzLmF1dG9Db250cm9scykgeyBhcHBlbmRDb250cm9sc0F1dG8oKTsgfVxuICAgICAgICAvLyBpZiBwYWdlciBpcyByZXF1ZXN0ZWQsIGFkZCBpdFxuICAgICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLnBhZ2VyKSB7IGFwcGVuZFBhZ2VyKCk7IH1cbiAgICAgICAgLy8gaWYgYW55IGNvbnRyb2wgb3B0aW9uIGlzIHJlcXVlc3RlZCwgYWRkIHRoZSBjb250cm9scyB3cmFwcGVyXG4gICAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MuY29udHJvbHMgfHwgc2xpZGVyLnNldHRpbmdzLmF1dG9Db250cm9scyB8fCBzbGlkZXIuc2V0dGluZ3MucGFnZXIpIHsgc2xpZGVyLnZpZXdwb3J0LmFmdGVyKHNsaWRlci5jb250cm9scy5lbCk7IH1cbiAgICAgIC8vIGlmIHRpY2tlciBtb2RlLCBkbyBub3QgYWxsb3cgYSBwYWdlclxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2xpZGVyLnNldHRpbmdzLnBhZ2VyID0gZmFsc2U7XG4gICAgICB9XG5cdCAgaWYgKHByZWxvYWRTZWxlY3RvciA9PT0gbnVsbCkge1xuICAgICAgICBzdGFydCgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbG9hZEVsZW1lbnRzKHByZWxvYWRTZWxlY3Rvciwgc3RhcnQpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICB2YXIgbG9hZEVsZW1lbnRzID0gZnVuY3Rpb24oc2VsZWN0b3IsIGNhbGxiYWNrKSB7XG4gICAgICB2YXIgdG90YWwgPSBzZWxlY3Rvci5maW5kKCdpbWc6bm90KFtzcmM9XCJcIl0pLCBpZnJhbWUnKS5sZW5ndGgsXG4gICAgICBjb3VudCA9IDA7XG4gICAgICBpZiAodG90YWwgPT09IDApIHtcbiAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgc2VsZWN0b3IuZmluZCgnaW1nOm5vdChbc3JjPVwiXCJdKSwgaWZyYW1lJykuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgJCh0aGlzKS5vbmUoJ2xvYWQgZXJyb3InLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICBpZiAoKytjb3VudCA9PT0gdG90YWwpIHsgY2FsbGJhY2soKTsgfVxuICAgICAgICB9KS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGlmICh0aGlzLmNvbXBsZXRlIHx8IHRoaXMuc3JjID09ICcnKSB7ICQodGhpcykudHJpZ2dlcignbG9hZCcpOyB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFN0YXJ0IHRoZSBzbGlkZXJcbiAgICAgKi9cbiAgICB2YXIgc3RhcnQgPSBmdW5jdGlvbigpIHtcbiAgICAgIC8vIGlmIGluZmluaXRlIGxvb3AsIHByZXBhcmUgYWRkaXRpb25hbCBzbGlkZXNcbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MuaW5maW5pdGVMb29wICYmIHNsaWRlci5zZXR0aW5ncy5tb2RlICE9PSAnZmFkZScgJiYgIXNsaWRlci5zZXR0aW5ncy50aWNrZXIpIHtcbiAgICAgICAgdmFyIHNsaWNlICAgID0gc2xpZGVyLnNldHRpbmdzLm1vZGUgPT09ICd2ZXJ0aWNhbCcgPyBzbGlkZXIuc2V0dGluZ3MubWluU2xpZGVzIDogc2xpZGVyLnNldHRpbmdzLm1heFNsaWRlcyxcbiAgICAgICAgc2xpY2VBcHBlbmQgID0gc2xpZGVyLmNoaWxkcmVuLnNsaWNlKDAsIHNsaWNlKS5jbG9uZSh0cnVlKS5hZGRDbGFzcygnYngtY2xvbmUnKSxcbiAgICAgICAgc2xpY2VQcmVwZW5kID0gc2xpZGVyLmNoaWxkcmVuLnNsaWNlKC1zbGljZSkuY2xvbmUodHJ1ZSkuYWRkQ2xhc3MoJ2J4LWNsb25lJyk7XG4gICAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MuYXJpYUhpZGRlbikge1xuICAgICAgICAgIHNsaWNlQXBwZW5kLmF0dHIoJ2FyaWEtaGlkZGVuJywgdHJ1ZSk7XG4gICAgICAgICAgc2xpY2VQcmVwZW5kLmF0dHIoJ2FyaWEtaGlkZGVuJywgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWwuYXBwZW5kKHNsaWNlQXBwZW5kKS5wcmVwZW5kKHNsaWNlUHJlcGVuZCk7XG4gICAgICB9XG4gICAgICAvLyByZW1vdmUgdGhlIGxvYWRpbmcgRE9NIGVsZW1lbnRcbiAgICAgIHNsaWRlci5sb2FkZXIucmVtb3ZlKCk7XG4gICAgICAvLyBzZXQgdGhlIGxlZnQgLyB0b3AgcG9zaXRpb24gb2YgXCJlbFwiXG4gICAgICBzZXRTbGlkZVBvc2l0aW9uKCk7XG4gICAgICAvLyBpZiBcInZlcnRpY2FsXCIgbW9kZSwgYWx3YXlzIHVzZSBhZGFwdGl2ZUhlaWdodCB0byBwcmV2ZW50IG9kZCBiZWhhdmlvclxuICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5tb2RlID09PSAndmVydGljYWwnKSB7IHNsaWRlci5zZXR0aW5ncy5hZGFwdGl2ZUhlaWdodCA9IHRydWU7IH1cbiAgICAgIC8vIHNldCB0aGUgdmlld3BvcnQgaGVpZ2h0XG4gICAgICBzbGlkZXIudmlld3BvcnQuaGVpZ2h0KGdldFZpZXdwb3J0SGVpZ2h0KCkpO1xuICAgICAgLy8gbWFrZSBzdXJlIGV2ZXJ5dGhpbmcgaXMgcG9zaXRpb25lZCBqdXN0IHJpZ2h0IChzYW1lIGFzIGEgd2luZG93IHJlc2l6ZSlcbiAgICAgIGVsLnJlZHJhd1NsaWRlcigpO1xuICAgICAgLy8gb25TbGlkZXJMb2FkIGNhbGxiYWNrXG4gICAgICBzbGlkZXIuc2V0dGluZ3Mub25TbGlkZXJMb2FkLmNhbGwoZWwsIHNsaWRlci5hY3RpdmUuaW5kZXgpO1xuICAgICAgLy8gc2xpZGVyIGhhcyBiZWVuIGZ1bGx5IGluaXRpYWxpemVkXG4gICAgICBzbGlkZXIuaW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgICAgLy8gYWRkIHRoZSByZXNpemUgY2FsbCB0byB0aGUgd2luZG93XG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLnJlc3BvbnNpdmUpIHsgJCh3aW5kb3cpLm9uKCdyZXNpemUnLCByZXNpemVXaW5kb3cpOyB9XG4gICAgICAvLyBpZiBhdXRvIGlzIHRydWUgYW5kIGhhcyBtb3JlIHRoYW4gMSBwYWdlLCBzdGFydCB0aGUgc2hvd1xuICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5hdXRvICYmIHNsaWRlci5zZXR0aW5ncy5hdXRvU3RhcnQgJiYgKGdldFBhZ2VyUXR5KCkgPiAxIHx8IHNsaWRlci5zZXR0aW5ncy5hdXRvU2xpZGVGb3JPbmVQYWdlKSkgeyBpbml0QXV0bygpOyB9XG4gICAgICAvLyBpZiB0aWNrZXIgaXMgdHJ1ZSwgc3RhcnQgdGhlIHRpY2tlclxuICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy50aWNrZXIpIHsgaW5pdFRpY2tlcigpOyB9XG4gICAgICAvLyBpZiBwYWdlciBpcyByZXF1ZXN0ZWQsIG1ha2UgdGhlIGFwcHJvcHJpYXRlIHBhZ2VyIGxpbmsgYWN0aXZlXG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLnBhZ2VyKSB7IHVwZGF0ZVBhZ2VyQWN0aXZlKHNsaWRlci5zZXR0aW5ncy5zdGFydFNsaWRlKTsgfVxuICAgICAgLy8gY2hlY2sgZm9yIGFueSB1cGRhdGVzIHRvIHRoZSBjb250cm9scyAobGlrZSBoaWRlQ29udHJvbE9uRW5kIHVwZGF0ZXMpXG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmNvbnRyb2xzKSB7IHVwZGF0ZURpcmVjdGlvbkNvbnRyb2xzKCk7IH1cbiAgICAgIC8vIGlmIHRvdWNoRW5hYmxlZCBpcyB0cnVlLCBzZXR1cCB0aGUgdG91Y2ggZXZlbnRzXG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLnRvdWNoRW5hYmxlZCAmJiAhc2xpZGVyLnNldHRpbmdzLnRpY2tlcikgeyBpbml0VG91Y2goKTsgfVxuICAgICAgLy8gaWYga2V5Ym9hcmRFbmFibGVkIGlzIHRydWUsIHNldHVwIHRoZSBrZXlib2FyZCBldmVudHNcbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3Mua2V5Ym9hcmRFbmFibGVkICYmICFzbGlkZXIuc2V0dGluZ3MudGlja2VyKSB7XG4gICAgICAgICQoZG9jdW1lbnQpLmtleWRvd24oa2V5UHJlc3MpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBjYWxjdWxhdGVkIGhlaWdodCBvZiB0aGUgdmlld3BvcnQsIHVzZWQgdG8gZGV0ZXJtaW5lIGVpdGhlciBhZGFwdGl2ZUhlaWdodCBvciB0aGUgbWF4SGVpZ2h0IHZhbHVlXG4gICAgICovXG4gICAgdmFyIGdldFZpZXdwb3J0SGVpZ2h0ID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgaGVpZ2h0ID0gMDtcbiAgICAgIC8vIGZpcnN0IGRldGVybWluZSB3aGljaCBjaGlsZHJlbiAoc2xpZGVzKSBzaG91bGQgYmUgdXNlZCBpbiBvdXIgaGVpZ2h0IGNhbGN1bGF0aW9uXG4gICAgICB2YXIgY2hpbGRyZW4gPSAkKCk7XG4gICAgICAvLyBpZiBtb2RlIGlzIG5vdCBcInZlcnRpY2FsXCIgYW5kIGFkYXB0aXZlSGVpZ2h0IGlzIGZhbHNlLCBpbmNsdWRlIGFsbCBjaGlsZHJlblxuICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5tb2RlICE9PSAndmVydGljYWwnICYmICFzbGlkZXIuc2V0dGluZ3MuYWRhcHRpdmVIZWlnaHQpIHtcbiAgICAgICAgY2hpbGRyZW4gPSBzbGlkZXIuY2hpbGRyZW47XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBpZiBub3QgY2Fyb3VzZWwsIHJldHVybiB0aGUgc2luZ2xlIGFjdGl2ZSBjaGlsZFxuICAgICAgICBpZiAoIXNsaWRlci5jYXJvdXNlbCkge1xuICAgICAgICAgIGNoaWxkcmVuID0gc2xpZGVyLmNoaWxkcmVuLmVxKHNsaWRlci5hY3RpdmUuaW5kZXgpO1xuICAgICAgICAvLyBpZiBjYXJvdXNlbCwgcmV0dXJuIGEgc2xpY2Ugb2YgY2hpbGRyZW5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBnZXQgdGhlIGluZGl2aWR1YWwgc2xpZGUgaW5kZXhcbiAgICAgICAgICB2YXIgY3VycmVudEluZGV4ID0gc2xpZGVyLnNldHRpbmdzLm1vdmVTbGlkZXMgPT09IDEgPyBzbGlkZXIuYWN0aXZlLmluZGV4IDogc2xpZGVyLmFjdGl2ZS5pbmRleCAqIGdldE1vdmVCeSgpO1xuICAgICAgICAgIC8vIGFkZCB0aGUgY3VycmVudCBzbGlkZSB0byB0aGUgY2hpbGRyZW5cbiAgICAgICAgICBjaGlsZHJlbiA9IHNsaWRlci5jaGlsZHJlbi5lcShjdXJyZW50SW5kZXgpO1xuICAgICAgICAgIC8vIGN5Y2xlIHRocm91Z2ggdGhlIHJlbWFpbmluZyBcInNob3dpbmdcIiBzbGlkZXNcbiAgICAgICAgICBmb3IgKGkgPSAxOyBpIDw9IHNsaWRlci5zZXR0aW5ncy5tYXhTbGlkZXMgLSAxOyBpKyspIHtcbiAgICAgICAgICAgIC8vIGlmIGxvb3BlZCBiYWNrIHRvIHRoZSBzdGFydFxuICAgICAgICAgICAgaWYgKGN1cnJlbnRJbmRleCArIGkgPj0gc2xpZGVyLmNoaWxkcmVuLmxlbmd0aCkge1xuICAgICAgICAgICAgICBjaGlsZHJlbiA9IGNoaWxkcmVuLmFkZChzbGlkZXIuY2hpbGRyZW4uZXEoaSAtIDEpKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGNoaWxkcmVuID0gY2hpbGRyZW4uYWRkKHNsaWRlci5jaGlsZHJlbi5lcShjdXJyZW50SW5kZXggKyBpKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICAvLyBpZiBcInZlcnRpY2FsXCIgbW9kZSwgY2FsY3VsYXRlIHRoZSBzdW0gb2YgdGhlIGhlaWdodHMgb2YgdGhlIGNoaWxkcmVuXG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLm1vZGUgPT09ICd2ZXJ0aWNhbCcpIHtcbiAgICAgICAgY2hpbGRyZW4uZWFjaChmdW5jdGlvbihpbmRleCkge1xuICAgICAgICAgIGhlaWdodCArPSAkKHRoaXMpLm91dGVySGVpZ2h0KCk7XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBhZGQgdXNlci1zdXBwbGllZCBtYXJnaW5zXG4gICAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3Muc2xpZGVNYXJnaW4gPiAwKSB7XG4gICAgICAgICAgaGVpZ2h0ICs9IHNsaWRlci5zZXR0aW5ncy5zbGlkZU1hcmdpbiAqIChzbGlkZXIuc2V0dGluZ3MubWluU2xpZGVzIC0gMSk7XG4gICAgICAgIH1cbiAgICAgIC8vIGlmIG5vdCBcInZlcnRpY2FsXCIgbW9kZSwgY2FsY3VsYXRlIHRoZSBtYXggaGVpZ2h0IG9mIHRoZSBjaGlsZHJlblxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaGVpZ2h0ID0gTWF0aC5tYXguYXBwbHkoTWF0aCwgY2hpbGRyZW4ubWFwKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiAkKHRoaXMpLm91dGVySGVpZ2h0KGZhbHNlKTtcbiAgICAgICAgfSkuZ2V0KCkpO1xuICAgICAgfVxuXG4gICAgICBpZiAoc2xpZGVyLnZpZXdwb3J0LmNzcygnYm94LXNpemluZycpID09PSAnYm9yZGVyLWJveCcpIHtcbiAgICAgICAgaGVpZ2h0ICs9IHBhcnNlRmxvYXQoc2xpZGVyLnZpZXdwb3J0LmNzcygncGFkZGluZy10b3AnKSkgKyBwYXJzZUZsb2F0KHNsaWRlci52aWV3cG9ydC5jc3MoJ3BhZGRpbmctYm90dG9tJykpICtcbiAgICAgICAgICAgICAgcGFyc2VGbG9hdChzbGlkZXIudmlld3BvcnQuY3NzKCdib3JkZXItdG9wLXdpZHRoJykpICsgcGFyc2VGbG9hdChzbGlkZXIudmlld3BvcnQuY3NzKCdib3JkZXItYm90dG9tLXdpZHRoJykpO1xuICAgICAgfSBlbHNlIGlmIChzbGlkZXIudmlld3BvcnQuY3NzKCdib3gtc2l6aW5nJykgPT09ICdwYWRkaW5nLWJveCcpIHtcbiAgICAgICAgaGVpZ2h0ICs9IHBhcnNlRmxvYXQoc2xpZGVyLnZpZXdwb3J0LmNzcygncGFkZGluZy10b3AnKSkgKyBwYXJzZUZsb2F0KHNsaWRlci52aWV3cG9ydC5jc3MoJ3BhZGRpbmctYm90dG9tJykpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gaGVpZ2h0O1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBjYWxjdWxhdGVkIHdpZHRoIHRvIGJlIHVzZWQgZm9yIHRoZSBvdXRlciB3cmFwcGVyIC8gdmlld3BvcnRcbiAgICAgKi9cbiAgICB2YXIgZ2V0Vmlld3BvcnRNYXhXaWR0aCA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHdpZHRoID0gJzEwMCUnO1xuICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5zbGlkZVdpZHRoID4gMCkge1xuICAgICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLm1vZGUgPT09ICdob3Jpem9udGFsJykge1xuICAgICAgICAgIHdpZHRoID0gKHNsaWRlci5zZXR0aW5ncy5tYXhTbGlkZXMgKiBzbGlkZXIuc2V0dGluZ3Muc2xpZGVXaWR0aCkgKyAoKHNsaWRlci5zZXR0aW5ncy5tYXhTbGlkZXMgLSAxKSAqIHNsaWRlci5zZXR0aW5ncy5zbGlkZU1hcmdpbik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgd2lkdGggPSBzbGlkZXIuc2V0dGluZ3Muc2xpZGVXaWR0aDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHdpZHRoO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBjYWxjdWxhdGVkIHdpZHRoIHRvIGJlIGFwcGxpZWQgdG8gZWFjaCBzbGlkZVxuICAgICAqL1xuICAgIHZhciBnZXRTbGlkZVdpZHRoID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgbmV3RWxXaWR0aCA9IHNsaWRlci5zZXR0aW5ncy5zbGlkZVdpZHRoLCAvLyBzdGFydCB3aXRoIGFueSB1c2VyLXN1cHBsaWVkIHNsaWRlIHdpZHRoXG4gICAgICB3cmFwV2lkdGggICAgICA9IHNsaWRlci52aWV3cG9ydC53aWR0aCgpOyAgICAvLyBnZXQgdGhlIGN1cnJlbnQgdmlld3BvcnQgd2lkdGhcbiAgICAgIC8vIGlmIHNsaWRlIHdpZHRoIHdhcyBub3Qgc3VwcGxpZWQsIG9yIGlzIGxhcmdlciB0aGFuIHRoZSB2aWV3cG9ydCB1c2UgdGhlIHZpZXdwb3J0IHdpZHRoXG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLnNsaWRlV2lkdGggPT09IDAgfHxcbiAgICAgICAgKHNsaWRlci5zZXR0aW5ncy5zbGlkZVdpZHRoID4gd3JhcFdpZHRoICYmICFzbGlkZXIuY2Fyb3VzZWwpIHx8XG4gICAgICAgIHNsaWRlci5zZXR0aW5ncy5tb2RlID09PSAndmVydGljYWwnKSB7XG4gICAgICAgIG5ld0VsV2lkdGggPSB3cmFwV2lkdGg7XG4gICAgICAvLyBpZiBjYXJvdXNlbCwgdXNlIHRoZSB0aHJlc2hvbGRzIHRvIGRldGVybWluZSB0aGUgd2lkdGhcbiAgICAgIH0gZWxzZSBpZiAoc2xpZGVyLnNldHRpbmdzLm1heFNsaWRlcyA+IDEgJiYgc2xpZGVyLnNldHRpbmdzLm1vZGUgPT09ICdob3Jpem9udGFsJykge1xuICAgICAgICBpZiAod3JhcFdpZHRoID4gc2xpZGVyLm1heFRocmVzaG9sZCkge1xuICAgICAgICAgIHJldHVybiBuZXdFbFdpZHRoO1xuICAgICAgICB9IGVsc2UgaWYgKHdyYXBXaWR0aCA8IHNsaWRlci5taW5UaHJlc2hvbGQpIHtcbiAgICAgICAgICBuZXdFbFdpZHRoID0gKHdyYXBXaWR0aCAtIChzbGlkZXIuc2V0dGluZ3Muc2xpZGVNYXJnaW4gKiAoc2xpZGVyLnNldHRpbmdzLm1pblNsaWRlcyAtIDEpKSkgLyBzbGlkZXIuc2V0dGluZ3MubWluU2xpZGVzO1xuICAgICAgICB9IGVsc2UgaWYgKHNsaWRlci5zZXR0aW5ncy5zaHJpbmtJdGVtcykge1xuICAgICAgICAgIG5ld0VsV2lkdGggPSBNYXRoLmZsb29yKCh3cmFwV2lkdGggKyBzbGlkZXIuc2V0dGluZ3Muc2xpZGVNYXJnaW4pIC8gKE1hdGguY2VpbCgod3JhcFdpZHRoICsgc2xpZGVyLnNldHRpbmdzLnNsaWRlTWFyZ2luKSAvIChuZXdFbFdpZHRoICsgc2xpZGVyLnNldHRpbmdzLnNsaWRlTWFyZ2luKSkpIC0gc2xpZGVyLnNldHRpbmdzLnNsaWRlTWFyZ2luKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG5ld0VsV2lkdGg7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIG51bWJlciBvZiBzbGlkZXMgY3VycmVudGx5IHZpc2libGUgaW4gdGhlIHZpZXdwb3J0IChpbmNsdWRlcyBwYXJ0aWFsbHkgdmlzaWJsZSBzbGlkZXMpXG4gICAgICovXG4gICAgdmFyIGdldE51bWJlclNsaWRlc1Nob3dpbmcgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBzbGlkZXNTaG93aW5nID0gMSxcbiAgICAgIGNoaWxkV2lkdGggPSBudWxsO1xuICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5tb2RlID09PSAnaG9yaXpvbnRhbCcgJiYgc2xpZGVyLnNldHRpbmdzLnNsaWRlV2lkdGggPiAwKSB7XG4gICAgICAgIC8vIGlmIHZpZXdwb3J0IGlzIHNtYWxsZXIgdGhhbiBtaW5UaHJlc2hvbGQsIHJldHVybiBtaW5TbGlkZXNcbiAgICAgICAgaWYgKHNsaWRlci52aWV3cG9ydC53aWR0aCgpIDwgc2xpZGVyLm1pblRocmVzaG9sZCkge1xuICAgICAgICAgIHNsaWRlc1Nob3dpbmcgPSBzbGlkZXIuc2V0dGluZ3MubWluU2xpZGVzO1xuICAgICAgICAvLyBpZiB2aWV3cG9ydCBpcyBsYXJnZXIgdGhhbiBtYXhUaHJlc2hvbGQsIHJldHVybiBtYXhTbGlkZXNcbiAgICAgICAgfSBlbHNlIGlmIChzbGlkZXIudmlld3BvcnQud2lkdGgoKSA+IHNsaWRlci5tYXhUaHJlc2hvbGQpIHtcbiAgICAgICAgICBzbGlkZXNTaG93aW5nID0gc2xpZGVyLnNldHRpbmdzLm1heFNsaWRlcztcbiAgICAgICAgLy8gaWYgdmlld3BvcnQgaXMgYmV0d2VlbiBtaW4gLyBtYXggdGhyZXNob2xkcywgZGl2aWRlIHZpZXdwb3J0IHdpZHRoIGJ5IGZpcnN0IGNoaWxkIHdpZHRoXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY2hpbGRXaWR0aCA9IHNsaWRlci5jaGlsZHJlbi5maXJzdCgpLndpZHRoKCkgKyBzbGlkZXIuc2V0dGluZ3Muc2xpZGVNYXJnaW47XG4gICAgICAgICAgc2xpZGVzU2hvd2luZyA9IE1hdGguZmxvb3IoKHNsaWRlci52aWV3cG9ydC53aWR0aCgpICtcbiAgICAgICAgICAgIHNsaWRlci5zZXR0aW5ncy5zbGlkZU1hcmdpbikgLyBjaGlsZFdpZHRoKSB8fCAxO1xuICAgICAgICB9XG4gICAgICAvLyBpZiBcInZlcnRpY2FsXCIgbW9kZSwgc2xpZGVzIHNob3dpbmcgd2lsbCBhbHdheXMgYmUgbWluU2xpZGVzXG4gICAgICB9IGVsc2UgaWYgKHNsaWRlci5zZXR0aW5ncy5tb2RlID09PSAndmVydGljYWwnKSB7XG4gICAgICAgIHNsaWRlc1Nob3dpbmcgPSBzbGlkZXIuc2V0dGluZ3MubWluU2xpZGVzO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHNsaWRlc1Nob3dpbmc7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIG51bWJlciBvZiBwYWdlcyAob25lIGZ1bGwgdmlld3BvcnQgb2Ygc2xpZGVzIGlzIG9uZSBcInBhZ2VcIilcbiAgICAgKi9cbiAgICB2YXIgZ2V0UGFnZXJRdHkgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBwYWdlclF0eSA9IDAsXG4gICAgICBicmVha1BvaW50ID0gMCxcbiAgICAgIGNvdW50ZXIgPSAwO1xuICAgICAgLy8gaWYgbW92ZVNsaWRlcyBpcyBzcGVjaWZpZWQgYnkgdGhlIHVzZXJcbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MubW92ZVNsaWRlcyA+IDApIHtcbiAgICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5pbmZpbml0ZUxvb3ApIHtcbiAgICAgICAgICBwYWdlclF0eSA9IE1hdGguY2VpbChzbGlkZXIuY2hpbGRyZW4ubGVuZ3RoIC8gZ2V0TW92ZUJ5KCkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIHdoZW4gYnJlYWtwb2ludCBnb2VzIGFib3ZlIGNoaWxkcmVuIGxlbmd0aCwgY291bnRlciBpcyB0aGUgbnVtYmVyIG9mIHBhZ2VzXG4gICAgICAgICAgd2hpbGUgKGJyZWFrUG9pbnQgPCBzbGlkZXIuY2hpbGRyZW4ubGVuZ3RoKSB7XG4gICAgICAgICAgICArK3BhZ2VyUXR5O1xuICAgICAgICAgICAgYnJlYWtQb2ludCA9IGNvdW50ZXIgKyBnZXROdW1iZXJTbGlkZXNTaG93aW5nKCk7XG4gICAgICAgICAgICBjb3VudGVyICs9IHNsaWRlci5zZXR0aW5ncy5tb3ZlU2xpZGVzIDw9IGdldE51bWJlclNsaWRlc1Nob3dpbmcoKSA/IHNsaWRlci5zZXR0aW5ncy5tb3ZlU2xpZGVzIDogZ2V0TnVtYmVyU2xpZGVzU2hvd2luZygpO1xuICAgICAgICAgIH1cblx0XHQgIHJldHVybiBjb3VudGVyO1xuICAgICAgICB9XG4gICAgICAvLyBpZiBtb3ZlU2xpZGVzIGlzIDAgKGF1dG8pIGRpdmlkZSBjaGlsZHJlbiBsZW5ndGggYnkgc2lkZXMgc2hvd2luZywgdGhlbiByb3VuZCB1cFxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcGFnZXJRdHkgPSBNYXRoLmNlaWwoc2xpZGVyLmNoaWxkcmVuLmxlbmd0aCAvIGdldE51bWJlclNsaWRlc1Nob3dpbmcoKSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gcGFnZXJRdHk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIG51bWJlciBvZiBpbmRpdmlkdWFsIHNsaWRlcyBieSB3aGljaCB0byBzaGlmdCB0aGUgc2xpZGVyXG4gICAgICovXG4gICAgdmFyIGdldE1vdmVCeSA9IGZ1bmN0aW9uKCkge1xuICAgICAgLy8gaWYgbW92ZVNsaWRlcyB3YXMgc2V0IGJ5IHRoZSB1c2VyIGFuZCBtb3ZlU2xpZGVzIGlzIGxlc3MgdGhhbiBudW1iZXIgb2Ygc2xpZGVzIHNob3dpbmdcbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MubW92ZVNsaWRlcyA+IDAgJiYgc2xpZGVyLnNldHRpbmdzLm1vdmVTbGlkZXMgPD0gZ2V0TnVtYmVyU2xpZGVzU2hvd2luZygpKSB7XG4gICAgICAgIHJldHVybiBzbGlkZXIuc2V0dGluZ3MubW92ZVNsaWRlcztcbiAgICAgIH1cbiAgICAgIC8vIGlmIG1vdmVTbGlkZXMgaXMgMCAoYXV0bylcbiAgICAgIHJldHVybiBnZXROdW1iZXJTbGlkZXNTaG93aW5nKCk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIHNsaWRlcidzIChlbCkgbGVmdCBvciB0b3AgcG9zaXRpb25cbiAgICAgKi9cbiAgICB2YXIgc2V0U2xpZGVQb3NpdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHBvc2l0aW9uLCBsYXN0Q2hpbGQsIGxhc3RTaG93aW5nSW5kZXg7XG4gICAgICAvLyBpZiBsYXN0IHNsaWRlLCBub3QgaW5maW5pdGUgbG9vcCwgYW5kIG51bWJlciBvZiBjaGlsZHJlbiBpcyBsYXJnZXIgdGhhbiBzcGVjaWZpZWQgbWF4U2xpZGVzXG4gICAgICBpZiAoc2xpZGVyLmNoaWxkcmVuLmxlbmd0aCA+IHNsaWRlci5zZXR0aW5ncy5tYXhTbGlkZXMgJiYgc2xpZGVyLmFjdGl2ZS5sYXN0ICYmICFzbGlkZXIuc2V0dGluZ3MuaW5maW5pdGVMb29wKSB7XG4gICAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MubW9kZSA9PT0gJ2hvcml6b250YWwnKSB7XG4gICAgICAgICAgLy8gZ2V0IHRoZSBsYXN0IGNoaWxkJ3MgcG9zaXRpb25cbiAgICAgICAgICBsYXN0Q2hpbGQgPSBzbGlkZXIuY2hpbGRyZW4ubGFzdCgpO1xuICAgICAgICAgIHBvc2l0aW9uID0gbGFzdENoaWxkLnBvc2l0aW9uKCk7XG4gICAgICAgICAgLy8gc2V0IHRoZSBsZWZ0IHBvc2l0aW9uXG4gICAgICAgICAgc2V0UG9zaXRpb25Qcm9wZXJ0eSgtKHBvc2l0aW9uLmxlZnQgLSAoc2xpZGVyLnZpZXdwb3J0LndpZHRoKCkgLSBsYXN0Q2hpbGQub3V0ZXJXaWR0aCgpKSksICdyZXNldCcsIDApO1xuICAgICAgICB9IGVsc2UgaWYgKHNsaWRlci5zZXR0aW5ncy5tb2RlID09PSAndmVydGljYWwnKSB7XG4gICAgICAgICAgLy8gZ2V0IHRoZSBsYXN0IHNob3dpbmcgaW5kZXgncyBwb3NpdGlvblxuICAgICAgICAgIGxhc3RTaG93aW5nSW5kZXggPSBzbGlkZXIuY2hpbGRyZW4ubGVuZ3RoIC0gc2xpZGVyLnNldHRpbmdzLm1pblNsaWRlcztcbiAgICAgICAgICBwb3NpdGlvbiA9IHNsaWRlci5jaGlsZHJlbi5lcShsYXN0U2hvd2luZ0luZGV4KS5wb3NpdGlvbigpO1xuICAgICAgICAgIC8vIHNldCB0aGUgdG9wIHBvc2l0aW9uXG4gICAgICAgICAgc2V0UG9zaXRpb25Qcm9wZXJ0eSgtcG9zaXRpb24udG9wLCAncmVzZXQnLCAwKTtcbiAgICAgICAgfVxuICAgICAgLy8gaWYgbm90IGxhc3Qgc2xpZGVcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIGdldCB0aGUgcG9zaXRpb24gb2YgdGhlIGZpcnN0IHNob3dpbmcgc2xpZGVcbiAgICAgICAgcG9zaXRpb24gPSBzbGlkZXIuY2hpbGRyZW4uZXEoc2xpZGVyLmFjdGl2ZS5pbmRleCAqIGdldE1vdmVCeSgpKS5wb3NpdGlvbigpO1xuICAgICAgICAvLyBjaGVjayBmb3IgbGFzdCBzbGlkZVxuICAgICAgICBpZiAoc2xpZGVyLmFjdGl2ZS5pbmRleCA9PT0gZ2V0UGFnZXJRdHkoKSAtIDEpIHsgc2xpZGVyLmFjdGl2ZS5sYXN0ID0gdHJ1ZTsgfVxuICAgICAgICAvLyBzZXQgdGhlIHJlc3BlY3RpdmUgcG9zaXRpb25cbiAgICAgICAgaWYgKHBvc2l0aW9uICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLm1vZGUgPT09ICdob3Jpem9udGFsJykgeyBzZXRQb3NpdGlvblByb3BlcnR5KC1wb3NpdGlvbi5sZWZ0LCAncmVzZXQnLCAwKTsgfVxuICAgICAgICAgIGVsc2UgaWYgKHNsaWRlci5zZXR0aW5ncy5tb2RlID09PSAndmVydGljYWwnKSB7IHNldFBvc2l0aW9uUHJvcGVydHkoLXBvc2l0aW9uLnRvcCwgJ3Jlc2V0JywgMCk7IH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBlbCdzIGFuaW1hdGluZyBwcm9wZXJ0eSBwb3NpdGlvbiAod2hpY2ggaW4gdHVybiB3aWxsIHNvbWV0aW1lcyBhbmltYXRlIGVsKS5cbiAgICAgKiBJZiB1c2luZyBDU1MsIHNldHMgdGhlIHRyYW5zZm9ybSBwcm9wZXJ0eS4gSWYgbm90IHVzaW5nIENTUywgc2V0cyB0aGUgdG9wIC8gbGVmdCBwcm9wZXJ0eS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB2YWx1ZSAoaW50KVxuICAgICAqICAtIHRoZSBhbmltYXRpbmcgcHJvcGVydHkncyB2YWx1ZVxuICAgICAqXG4gICAgICogQHBhcmFtIHR5cGUgKHN0cmluZykgJ3NsaWRlJywgJ3Jlc2V0JywgJ3RpY2tlcidcbiAgICAgKiAgLSB0aGUgdHlwZSBvZiBpbnN0YW5jZSBmb3Igd2hpY2ggdGhlIGZ1bmN0aW9uIGlzIGJlaW5nXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZHVyYXRpb24gKGludClcbiAgICAgKiAgLSB0aGUgYW1vdW50IG9mIHRpbWUgKGluIG1zKSB0aGUgdHJhbnNpdGlvbiBzaG91bGQgb2NjdXB5XG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFyYW1zIChhcnJheSkgb3B0aW9uYWxcbiAgICAgKiAgLSBhbiBvcHRpb25hbCBwYXJhbWV0ZXIgY29udGFpbmluZyBhbnkgdmFyaWFibGVzIHRoYXQgbmVlZCB0byBiZSBwYXNzZWQgaW5cbiAgICAgKi9cbiAgICB2YXIgc2V0UG9zaXRpb25Qcm9wZXJ0eSA9IGZ1bmN0aW9uKHZhbHVlLCB0eXBlLCBkdXJhdGlvbiwgcGFyYW1zKSB7XG4gICAgICB2YXIgYW5pbWF0ZU9iaiwgcHJvcFZhbHVlO1xuICAgICAgLy8gdXNlIENTUyB0cmFuc2Zvcm1cbiAgICAgIGlmIChzbGlkZXIudXNpbmdDU1MpIHtcbiAgICAgICAgLy8gZGV0ZXJtaW5lIHRoZSB0cmFuc2xhdGUzZCB2YWx1ZVxuICAgICAgICBwcm9wVmFsdWUgPSBzbGlkZXIuc2V0dGluZ3MubW9kZSA9PT0gJ3ZlcnRpY2FsJyA/ICd0cmFuc2xhdGUzZCgwLCAnICsgdmFsdWUgKyAncHgsIDApJyA6ICd0cmFuc2xhdGUzZCgnICsgdmFsdWUgKyAncHgsIDAsIDApJztcbiAgICAgICAgLy8gYWRkIHRoZSBDU1MgdHJhbnNpdGlvbi1kdXJhdGlvblxuICAgICAgICBlbC5jc3MoJy0nICsgc2xpZGVyLmNzc1ByZWZpeCArICctdHJhbnNpdGlvbi1kdXJhdGlvbicsIGR1cmF0aW9uIC8gMTAwMCArICdzJyk7XG4gICAgICAgIGlmICh0eXBlID09PSAnc2xpZGUnKSB7XG4gICAgICAgICAgLy8gc2V0IHRoZSBwcm9wZXJ0eSB2YWx1ZVxuICAgICAgICAgIGVsLmNzcyhzbGlkZXIuYW5pbVByb3AsIHByb3BWYWx1ZSk7XG4gICAgICAgICAgaWYgKGR1cmF0aW9uICE9PSAwKSB7XG4gICAgICAgICAgICAvLyBhZGQgYSBjYWxsYmFjayBtZXRob2QgLSBleGVjdXRlcyB3aGVuIENTUyB0cmFuc2l0aW9uIGNvbXBsZXRlc1xuICAgICAgICAgICAgZWwub24oJ3RyYW5zaXRpb25lbmQgd2Via2l0VHJhbnNpdGlvbkVuZCBvVHJhbnNpdGlvbkVuZCBNU1RyYW5zaXRpb25FbmQnLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgIC8vbWFrZSBzdXJlIGl0J3MgdGhlIGNvcnJlY3Qgb25lXG4gICAgICAgICAgICAgIGlmICghJChlLnRhcmdldCkuaXMoZWwpKSB7IHJldHVybjsgfVxuICAgICAgICAgICAgICAvLyByZW1vdmUgdGhlIGNhbGxiYWNrXG4gICAgICAgICAgICAgIGVsLm9mZigndHJhbnNpdGlvbmVuZCB3ZWJraXRUcmFuc2l0aW9uRW5kIG9UcmFuc2l0aW9uRW5kIE1TVHJhbnNpdGlvbkVuZCcpO1xuICAgICAgICAgICAgICB1cGRhdGVBZnRlclNsaWRlVHJhbnNpdGlvbigpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBlbHNlIHsgLy9kdXJhdGlvbiA9IDBcbiAgICAgICAgICAgIHVwZGF0ZUFmdGVyU2xpZGVUcmFuc2l0aW9uKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdyZXNldCcpIHtcbiAgICAgICAgICBlbC5jc3Moc2xpZGVyLmFuaW1Qcm9wLCBwcm9wVmFsdWUpO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICd0aWNrZXInKSB7XG4gICAgICAgICAgLy8gbWFrZSB0aGUgdHJhbnNpdGlvbiB1c2UgJ2xpbmVhcidcbiAgICAgICAgICBlbC5jc3MoJy0nICsgc2xpZGVyLmNzc1ByZWZpeCArICctdHJhbnNpdGlvbi10aW1pbmctZnVuY3Rpb24nLCAnbGluZWFyJyk7XG4gICAgICAgICAgZWwuY3NzKHNsaWRlci5hbmltUHJvcCwgcHJvcFZhbHVlKTtcbiAgICAgICAgICBpZiAoZHVyYXRpb24gIT09IDApIHtcbiAgICAgICAgICAgIGVsLm9uKCd0cmFuc2l0aW9uZW5kIHdlYmtpdFRyYW5zaXRpb25FbmQgb1RyYW5zaXRpb25FbmQgTVNUcmFuc2l0aW9uRW5kJywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICAvL21ha2Ugc3VyZSBpdCdzIHRoZSBjb3JyZWN0IG9uZVxuICAgICAgICAgICAgICBpZiAoISQoZS50YXJnZXQpLmlzKGVsKSkgeyByZXR1cm47IH1cbiAgICAgICAgICAgICAgLy8gcmVtb3ZlIHRoZSBjYWxsYmFja1xuICAgICAgICAgICAgICBlbC5vZmYoJ3RyYW5zaXRpb25lbmQgd2Via2l0VHJhbnNpdGlvbkVuZCBvVHJhbnNpdGlvbkVuZCBNU1RyYW5zaXRpb25FbmQnKTtcbiAgICAgICAgICAgICAgLy8gcmVzZXQgdGhlIHBvc2l0aW9uXG4gICAgICAgICAgICAgIHNldFBvc2l0aW9uUHJvcGVydHkocGFyYW1zLnJlc2V0VmFsdWUsICdyZXNldCcsIDApO1xuICAgICAgICAgICAgICAvLyBzdGFydCB0aGUgbG9vcCBhZ2FpblxuICAgICAgICAgICAgICB0aWNrZXJMb29wKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2UgeyAvL2R1cmF0aW9uID0gMFxuICAgICAgICAgICAgc2V0UG9zaXRpb25Qcm9wZXJ0eShwYXJhbXMucmVzZXRWYWx1ZSwgJ3Jlc2V0JywgMCk7XG4gICAgICAgICAgICB0aWNrZXJMb29wKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAvLyB1c2UgSlMgYW5pbWF0ZVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYW5pbWF0ZU9iaiA9IHt9O1xuICAgICAgICBhbmltYXRlT2JqW3NsaWRlci5hbmltUHJvcF0gPSB2YWx1ZTtcbiAgICAgICAgaWYgKHR5cGUgPT09ICdzbGlkZScpIHtcbiAgICAgICAgICBlbC5hbmltYXRlKGFuaW1hdGVPYmosIGR1cmF0aW9uLCBzbGlkZXIuc2V0dGluZ3MuZWFzaW5nLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHVwZGF0ZUFmdGVyU2xpZGVUcmFuc2l0aW9uKCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ3Jlc2V0Jykge1xuICAgICAgICAgIGVsLmNzcyhzbGlkZXIuYW5pbVByb3AsIHZhbHVlKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAndGlja2VyJykge1xuICAgICAgICAgIGVsLmFuaW1hdGUoYW5pbWF0ZU9iaiwgZHVyYXRpb24sICdsaW5lYXInLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHNldFBvc2l0aW9uUHJvcGVydHkocGFyYW1zLnJlc2V0VmFsdWUsICdyZXNldCcsIDApO1xuICAgICAgICAgICAgLy8gcnVuIHRoZSByZWN1cnNpdmUgbG9vcCBhZnRlciBhbmltYXRpb25cbiAgICAgICAgICAgIHRpY2tlckxvb3AoKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBQb3B1bGF0ZXMgdGhlIHBhZ2VyIHdpdGggcHJvcGVyIGFtb3VudCBvZiBwYWdlc1xuICAgICAqL1xuICAgIHZhciBwb3B1bGF0ZVBhZ2VyID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcGFnZXJIdG1sID0gJycsXG4gICAgICBsaW5rQ29udGVudCA9ICcnLFxuICAgICAgcGFnZXJRdHkgPSBnZXRQYWdlclF0eSgpO1xuICAgICAgLy8gbG9vcCB0aHJvdWdoIGVhY2ggcGFnZXIgaXRlbVxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYWdlclF0eTsgaSsrKSB7XG4gICAgICAgIGxpbmtDb250ZW50ID0gJyc7XG4gICAgICAgIC8vIGlmIGEgYnVpbGRQYWdlciBmdW5jdGlvbiBpcyBzdXBwbGllZCwgdXNlIGl0IHRvIGdldCBwYWdlciBsaW5rIHZhbHVlLCBlbHNlIHVzZSBpbmRleCArIDFcbiAgICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5idWlsZFBhZ2VyICYmICQuaXNGdW5jdGlvbihzbGlkZXIuc2V0dGluZ3MuYnVpbGRQYWdlcikgfHwgc2xpZGVyLnNldHRpbmdzLnBhZ2VyQ3VzdG9tKSB7XG4gICAgICAgICAgbGlua0NvbnRlbnQgPSBzbGlkZXIuc2V0dGluZ3MuYnVpbGRQYWdlcihpKTtcbiAgICAgICAgICBzbGlkZXIucGFnZXJFbC5hZGRDbGFzcygnYngtY3VzdG9tLXBhZ2VyJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbGlua0NvbnRlbnQgPSBpICsgMTtcbiAgICAgICAgICBzbGlkZXIucGFnZXJFbC5hZGRDbGFzcygnYngtZGVmYXVsdC1wYWdlcicpO1xuICAgICAgICB9XG4gICAgICAgIC8vIHZhciBsaW5rQ29udGVudCA9IHNsaWRlci5zZXR0aW5ncy5idWlsZFBhZ2VyICYmICQuaXNGdW5jdGlvbihzbGlkZXIuc2V0dGluZ3MuYnVpbGRQYWdlcikgPyBzbGlkZXIuc2V0dGluZ3MuYnVpbGRQYWdlcihpKSA6IGkgKyAxO1xuICAgICAgICAvLyBhZGQgdGhlIG1hcmt1cCB0byB0aGUgc3RyaW5nXG4gICAgICAgIHBhZ2VySHRtbCArPSAnPGRpdiBjbGFzcz1cImJ4LXBhZ2VyLWl0ZW1cIj48YSBocmVmPVwiXCIgZGF0YS1zbGlkZS1pbmRleD1cIicgKyBpICsgJ1wiIGNsYXNzPVwiYngtcGFnZXItbGlua1wiPicgKyBsaW5rQ29udGVudCArICc8L2E+PC9kaXY+JztcbiAgICAgIH1cbiAgICAgIC8vIHBvcHVsYXRlIHRoZSBwYWdlciBlbGVtZW50IHdpdGggcGFnZXIgbGlua3NcbiAgICAgIHNsaWRlci5wYWdlckVsLmh0bWwocGFnZXJIdG1sKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQXBwZW5kcyB0aGUgcGFnZXIgdG8gdGhlIGNvbnRyb2xzIGVsZW1lbnRcbiAgICAgKi9cbiAgICB2YXIgYXBwZW5kUGFnZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgIGlmICghc2xpZGVyLnNldHRpbmdzLnBhZ2VyQ3VzdG9tKSB7XG4gICAgICAgIC8vIGNyZWF0ZSB0aGUgcGFnZXIgRE9NIGVsZW1lbnRcbiAgICAgICAgc2xpZGVyLnBhZ2VyRWwgPSAkKCc8ZGl2IGNsYXNzPVwiYngtcGFnZXJcIiAvPicpO1xuICAgICAgICAvLyBpZiBhIHBhZ2VyIHNlbGVjdG9yIHdhcyBzdXBwbGllZCwgcG9wdWxhdGUgaXQgd2l0aCB0aGUgcGFnZXJcbiAgICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5wYWdlclNlbGVjdG9yKSB7XG4gICAgICAgICAgJChzbGlkZXIuc2V0dGluZ3MucGFnZXJTZWxlY3RvcikuaHRtbChzbGlkZXIucGFnZXJFbCk7XG4gICAgICAgIC8vIGlmIG5vIHBhZ2VyIHNlbGVjdG9yIHdhcyBzdXBwbGllZCwgYWRkIGl0IGFmdGVyIHRoZSB3cmFwcGVyXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2xpZGVyLmNvbnRyb2xzLmVsLmFkZENsYXNzKCdieC1oYXMtcGFnZXInKS5hcHBlbmQoc2xpZGVyLnBhZ2VyRWwpO1xuICAgICAgICB9XG4gICAgICAgIC8vIHBvcHVsYXRlIHRoZSBwYWdlclxuICAgICAgICBwb3B1bGF0ZVBhZ2VyKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzbGlkZXIucGFnZXJFbCA9ICQoc2xpZGVyLnNldHRpbmdzLnBhZ2VyQ3VzdG9tKTtcbiAgICAgIH1cbiAgICAgIC8vIGFzc2lnbiB0aGUgcGFnZXIgY2xpY2sgYmluZGluZ1xuICAgICAgc2xpZGVyLnBhZ2VyRWwub24oJ2NsaWNrIHRvdWNoZW5kJywgJ2EnLCBjbGlja1BhZ2VyQmluZCk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEFwcGVuZHMgcHJldiAvIG5leHQgY29udHJvbHMgdG8gdGhlIGNvbnRyb2xzIGVsZW1lbnRcbiAgICAgKi9cbiAgICB2YXIgYXBwZW5kQ29udHJvbHMgPSBmdW5jdGlvbigpIHtcbiAgICAgIHNsaWRlci5jb250cm9scy5uZXh0ID0gJCgnPGEgY2xhc3M9XCJieC1uZXh0XCIgaHJlZj1cIlwiPicgKyBzbGlkZXIuc2V0dGluZ3MubmV4dFRleHQgKyAnPC9hPicpO1xuICAgICAgc2xpZGVyLmNvbnRyb2xzLnByZXYgPSAkKCc8YSBjbGFzcz1cImJ4LXByZXZcIiBocmVmPVwiXCI+JyArIHNsaWRlci5zZXR0aW5ncy5wcmV2VGV4dCArICc8L2E+Jyk7XG4gICAgICAvLyBhZGQgY2xpY2sgYWN0aW9ucyB0byB0aGUgY29udHJvbHNcbiAgICAgIHNsaWRlci5jb250cm9scy5uZXh0Lm9uKCdjbGljayB0b3VjaGVuZCcsIGNsaWNrTmV4dEJpbmQpO1xuICAgICAgc2xpZGVyLmNvbnRyb2xzLnByZXYub24oJ2NsaWNrIHRvdWNoZW5kJywgY2xpY2tQcmV2QmluZCk7XG4gICAgICAvLyBpZiBuZXh0U2VsZWN0b3Igd2FzIHN1cHBsaWVkLCBwb3B1bGF0ZSBpdFxuICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5uZXh0U2VsZWN0b3IpIHtcbiAgICAgICAgJChzbGlkZXIuc2V0dGluZ3MubmV4dFNlbGVjdG9yKS5hcHBlbmQoc2xpZGVyLmNvbnRyb2xzLm5leHQpO1xuICAgICAgfVxuICAgICAgLy8gaWYgcHJldlNlbGVjdG9yIHdhcyBzdXBwbGllZCwgcG9wdWxhdGUgaXRcbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MucHJldlNlbGVjdG9yKSB7XG4gICAgICAgICQoc2xpZGVyLnNldHRpbmdzLnByZXZTZWxlY3RvcikuYXBwZW5kKHNsaWRlci5jb250cm9scy5wcmV2KTtcbiAgICAgIH1cbiAgICAgIC8vIGlmIG5vIGN1c3RvbSBzZWxlY3RvcnMgd2VyZSBzdXBwbGllZFxuICAgICAgaWYgKCFzbGlkZXIuc2V0dGluZ3MubmV4dFNlbGVjdG9yICYmICFzbGlkZXIuc2V0dGluZ3MucHJldlNlbGVjdG9yKSB7XG4gICAgICAgIC8vIGFkZCB0aGUgY29udHJvbHMgdG8gdGhlIERPTVxuICAgICAgICBzbGlkZXIuY29udHJvbHMuZGlyZWN0aW9uRWwgPSAkKCc8ZGl2IGNsYXNzPVwiYngtY29udHJvbHMtZGlyZWN0aW9uXCIgLz4nKTtcbiAgICAgICAgLy8gYWRkIHRoZSBjb250cm9sIGVsZW1lbnRzIHRvIHRoZSBkaXJlY3Rpb25FbFxuICAgICAgICBzbGlkZXIuY29udHJvbHMuZGlyZWN0aW9uRWwuYXBwZW5kKHNsaWRlci5jb250cm9scy5wcmV2KS5hcHBlbmQoc2xpZGVyLmNvbnRyb2xzLm5leHQpO1xuICAgICAgICAvLyBzbGlkZXIudmlld3BvcnQuYXBwZW5kKHNsaWRlci5jb250cm9scy5kaXJlY3Rpb25FbCk7XG4gICAgICAgIHNsaWRlci5jb250cm9scy5lbC5hZGRDbGFzcygnYngtaGFzLWNvbnRyb2xzLWRpcmVjdGlvbicpLmFwcGVuZChzbGlkZXIuY29udHJvbHMuZGlyZWN0aW9uRWwpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBBcHBlbmRzIHN0YXJ0IC8gc3RvcCBhdXRvIGNvbnRyb2xzIHRvIHRoZSBjb250cm9scyBlbGVtZW50XG4gICAgICovXG4gICAgdmFyIGFwcGVuZENvbnRyb2xzQXV0byA9IGZ1bmN0aW9uKCkge1xuICAgICAgc2xpZGVyLmNvbnRyb2xzLnN0YXJ0ID0gJCgnPGRpdiBjbGFzcz1cImJ4LWNvbnRyb2xzLWF1dG8taXRlbVwiPjxhIGNsYXNzPVwiYngtc3RhcnRcIiBocmVmPVwiXCI+JyArIHNsaWRlci5zZXR0aW5ncy5zdGFydFRleHQgKyAnPC9hPjwvZGl2PicpO1xuICAgICAgc2xpZGVyLmNvbnRyb2xzLnN0b3AgPSAkKCc8ZGl2IGNsYXNzPVwiYngtY29udHJvbHMtYXV0by1pdGVtXCI+PGEgY2xhc3M9XCJieC1zdG9wXCIgaHJlZj1cIlwiPicgKyBzbGlkZXIuc2V0dGluZ3Muc3RvcFRleHQgKyAnPC9hPjwvZGl2PicpO1xuICAgICAgLy8gYWRkIHRoZSBjb250cm9scyB0byB0aGUgRE9NXG4gICAgICBzbGlkZXIuY29udHJvbHMuYXV0b0VsID0gJCgnPGRpdiBjbGFzcz1cImJ4LWNvbnRyb2xzLWF1dG9cIiAvPicpO1xuICAgICAgLy8gb24gY2xpY2sgYWN0aW9ucyB0byB0aGUgY29udHJvbHNcbiAgICAgIHNsaWRlci5jb250cm9scy5hdXRvRWwub24oJ2NsaWNrJywgJy5ieC1zdGFydCcsIGNsaWNrU3RhcnRCaW5kKTtcbiAgICAgIHNsaWRlci5jb250cm9scy5hdXRvRWwub24oJ2NsaWNrJywgJy5ieC1zdG9wJywgY2xpY2tTdG9wQmluZCk7XG4gICAgICAvLyBpZiBhdXRvQ29udHJvbHNDb21iaW5lLCBpbnNlcnQgb25seSB0aGUgXCJzdGFydFwiIGNvbnRyb2xcbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MuYXV0b0NvbnRyb2xzQ29tYmluZSkge1xuICAgICAgICBzbGlkZXIuY29udHJvbHMuYXV0b0VsLmFwcGVuZChzbGlkZXIuY29udHJvbHMuc3RhcnQpO1xuICAgICAgLy8gaWYgYXV0b0NvbnRyb2xzQ29tYmluZSBpcyBmYWxzZSwgaW5zZXJ0IGJvdGggY29udHJvbHNcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNsaWRlci5jb250cm9scy5hdXRvRWwuYXBwZW5kKHNsaWRlci5jb250cm9scy5zdGFydCkuYXBwZW5kKHNsaWRlci5jb250cm9scy5zdG9wKTtcbiAgICAgIH1cbiAgICAgIC8vIGlmIGF1dG8gY29udHJvbHMgc2VsZWN0b3Igd2FzIHN1cHBsaWVkLCBwb3B1bGF0ZSBpdCB3aXRoIHRoZSBjb250cm9sc1xuICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5hdXRvQ29udHJvbHNTZWxlY3Rvcikge1xuICAgICAgICAkKHNsaWRlci5zZXR0aW5ncy5hdXRvQ29udHJvbHNTZWxlY3RvcikuaHRtbChzbGlkZXIuY29udHJvbHMuYXV0b0VsKTtcbiAgICAgIC8vIGlmIGF1dG8gY29udHJvbHMgc2VsZWN0b3Igd2FzIG5vdCBzdXBwbGllZCwgYWRkIGl0IGFmdGVyIHRoZSB3cmFwcGVyXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzbGlkZXIuY29udHJvbHMuZWwuYWRkQ2xhc3MoJ2J4LWhhcy1jb250cm9scy1hdXRvJykuYXBwZW5kKHNsaWRlci5jb250cm9scy5hdXRvRWwpO1xuICAgICAgfVxuICAgICAgLy8gdXBkYXRlIHRoZSBhdXRvIGNvbnRyb2xzXG4gICAgICB1cGRhdGVBdXRvQ29udHJvbHMoc2xpZGVyLnNldHRpbmdzLmF1dG9TdGFydCA/ICdzdG9wJyA6ICdzdGFydCcpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBBcHBlbmRzIGltYWdlIGNhcHRpb25zIHRvIHRoZSBET01cbiAgICAgKi9cbiAgICB2YXIgYXBwZW5kQ2FwdGlvbnMgPSBmdW5jdGlvbigpIHtcbiAgICAgIC8vIGN5Y2xlIHRocm91Z2ggZWFjaCBjaGlsZFxuICAgICAgc2xpZGVyLmNoaWxkcmVuLmVhY2goZnVuY3Rpb24oaW5kZXgpIHtcbiAgICAgICAgLy8gZ2V0IHRoZSBpbWFnZSB0aXRsZSBhdHRyaWJ1dGVcbiAgICAgICAgdmFyIHRpdGxlID0gJCh0aGlzKS5maW5kKCdpbWc6Zmlyc3QnKS5hdHRyKCd0aXRsZScpO1xuICAgICAgICAvLyBhcHBlbmQgdGhlIGNhcHRpb25cbiAgICAgICAgaWYgKHRpdGxlICE9PSB1bmRlZmluZWQgJiYgKCcnICsgdGl0bGUpLmxlbmd0aCkge1xuICAgICAgICAgICQodGhpcykuYXBwZW5kKCc8ZGl2IGNsYXNzPVwiYngtY2FwdGlvblwiPjxzcGFuPicgKyB0aXRsZSArICc8L3NwYW4+PC9kaXY+Jyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBDbGljayBuZXh0IGJpbmRpbmdcbiAgICAgKlxuICAgICAqIEBwYXJhbSBlIChldmVudClcbiAgICAgKiAgLSBET00gZXZlbnQgb2JqZWN0XG4gICAgICovXG4gICAgdmFyIGNsaWNrTmV4dEJpbmQgPSBmdW5jdGlvbihlKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBpZiAoc2xpZGVyLmNvbnRyb2xzLmVsLmhhc0NsYXNzKCdkaXNhYmxlZCcpKSB7IHJldHVybjsgfVxuICAgICAgLy8gaWYgYXV0byBzaG93IGlzIHJ1bm5pbmcsIHN0b3AgaXRcbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MuYXV0byAmJiBzbGlkZXIuc2V0dGluZ3Muc3RvcEF1dG9PbkNsaWNrKSB7IGVsLnN0b3BBdXRvKCk7IH1cbiAgICAgIGVsLmdvVG9OZXh0U2xpZGUoKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQ2xpY2sgcHJldiBiaW5kaW5nXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZSAoZXZlbnQpXG4gICAgICogIC0gRE9NIGV2ZW50IG9iamVjdFxuICAgICAqL1xuICAgIHZhciBjbGlja1ByZXZCaW5kID0gZnVuY3Rpb24oZSkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgaWYgKHNsaWRlci5jb250cm9scy5lbC5oYXNDbGFzcygnZGlzYWJsZWQnKSkgeyByZXR1cm47IH1cbiAgICAgIC8vIGlmIGF1dG8gc2hvdyBpcyBydW5uaW5nLCBzdG9wIGl0XG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmF1dG8gJiYgc2xpZGVyLnNldHRpbmdzLnN0b3BBdXRvT25DbGljaykgeyBlbC5zdG9wQXV0bygpOyB9XG4gICAgICBlbC5nb1RvUHJldlNsaWRlKCk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIENsaWNrIHN0YXJ0IGJpbmRpbmdcbiAgICAgKlxuICAgICAqIEBwYXJhbSBlIChldmVudClcbiAgICAgKiAgLSBET00gZXZlbnQgb2JqZWN0XG4gICAgICovXG4gICAgdmFyIGNsaWNrU3RhcnRCaW5kID0gZnVuY3Rpb24oZSkge1xuICAgICAgZWwuc3RhcnRBdXRvKCk7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIENsaWNrIHN0b3AgYmluZGluZ1xuICAgICAqXG4gICAgICogQHBhcmFtIGUgKGV2ZW50KVxuICAgICAqICAtIERPTSBldmVudCBvYmplY3RcbiAgICAgKi9cbiAgICB2YXIgY2xpY2tTdG9wQmluZCA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIGVsLnN0b3BBdXRvKCk7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIENsaWNrIHBhZ2VyIGJpbmRpbmdcbiAgICAgKlxuICAgICAqIEBwYXJhbSBlIChldmVudClcbiAgICAgKiAgLSBET00gZXZlbnQgb2JqZWN0XG4gICAgICovXG4gICAgdmFyIGNsaWNrUGFnZXJCaW5kID0gZnVuY3Rpb24oZSkge1xuICAgICAgdmFyIHBhZ2VyTGluaywgcGFnZXJJbmRleDtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGlmIChzbGlkZXIuY29udHJvbHMuZWwuaGFzQ2xhc3MoJ2Rpc2FibGVkJykpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgLy8gaWYgYXV0byBzaG93IGlzIHJ1bm5pbmcsIHN0b3AgaXRcbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MuYXV0byAgJiYgc2xpZGVyLnNldHRpbmdzLnN0b3BBdXRvT25DbGljaykgeyBlbC5zdG9wQXV0bygpOyB9XG4gICAgICBwYWdlckxpbmsgPSAkKGUuY3VycmVudFRhcmdldCk7XG4gICAgICBpZiAocGFnZXJMaW5rLmF0dHIoJ2RhdGEtc2xpZGUtaW5kZXgnKSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHBhZ2VySW5kZXggPSBwYXJzZUludChwYWdlckxpbmsuYXR0cignZGF0YS1zbGlkZS1pbmRleCcpKTtcbiAgICAgICAgLy8gaWYgY2xpY2tlZCBwYWdlciBsaW5rIGlzIG5vdCBhY3RpdmUsIGNvbnRpbnVlIHdpdGggdGhlIGdvVG9TbGlkZSBjYWxsXG4gICAgICAgIGlmIChwYWdlckluZGV4ICE9PSBzbGlkZXIuYWN0aXZlLmluZGV4KSB7IGVsLmdvVG9TbGlkZShwYWdlckluZGV4KTsgfVxuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGVzIHRoZSBwYWdlciBsaW5rcyB3aXRoIGFuIGFjdGl2ZSBjbGFzc1xuICAgICAqXG4gICAgICogQHBhcmFtIHNsaWRlSW5kZXggKGludClcbiAgICAgKiAgLSBpbmRleCBvZiBzbGlkZSB0byBtYWtlIGFjdGl2ZVxuICAgICAqL1xuICAgIHZhciB1cGRhdGVQYWdlckFjdGl2ZSA9IGZ1bmN0aW9uKHNsaWRlSW5kZXgpIHtcbiAgICAgIC8vIGlmIFwic2hvcnRcIiBwYWdlciB0eXBlXG4gICAgICB2YXIgbGVuID0gc2xpZGVyLmNoaWxkcmVuLmxlbmd0aDsgLy8gbmIgb2YgY2hpbGRyZW5cbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MucGFnZXJUeXBlID09PSAnc2hvcnQnKSB7XG4gICAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MubWF4U2xpZGVzID4gMSkge1xuICAgICAgICAgIGxlbiA9IE1hdGguY2VpbChzbGlkZXIuY2hpbGRyZW4ubGVuZ3RoIC8gc2xpZGVyLnNldHRpbmdzLm1heFNsaWRlcyk7XG4gICAgICAgIH1cbiAgICAgICAgc2xpZGVyLnBhZ2VyRWwuaHRtbCgoc2xpZGVJbmRleCArIDEpICsgc2xpZGVyLnNldHRpbmdzLnBhZ2VyU2hvcnRTZXBhcmF0b3IgKyBsZW4pO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICAvLyByZW1vdmUgYWxsIHBhZ2VyIGFjdGl2ZSBjbGFzc2VzXG4gICAgICBzbGlkZXIucGFnZXJFbC5maW5kKCdhJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgLy8gYXBwbHkgdGhlIGFjdGl2ZSBjbGFzcyBmb3IgYWxsIHBhZ2Vyc1xuICAgICAgc2xpZGVyLnBhZ2VyRWwuZWFjaChmdW5jdGlvbihpLCBlbCkgeyAkKGVsKS5maW5kKCdhJykuZXEoc2xpZGVJbmRleCkuYWRkQ2xhc3MoJ2FjdGl2ZScpOyB9KTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUGVyZm9ybXMgbmVlZGVkIGFjdGlvbnMgYWZ0ZXIgYSBzbGlkZSB0cmFuc2l0aW9uXG4gICAgICovXG4gICAgdmFyIHVwZGF0ZUFmdGVyU2xpZGVUcmFuc2l0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICAvLyBpZiBpbmZpbml0ZSBsb29wIGlzIHRydWVcbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MuaW5maW5pdGVMb29wKSB7XG4gICAgICAgIHZhciBwb3NpdGlvbiA9ICcnO1xuICAgICAgICAvLyBmaXJzdCBzbGlkZVxuICAgICAgICBpZiAoc2xpZGVyLmFjdGl2ZS5pbmRleCA9PT0gMCkge1xuICAgICAgICAgIC8vIHNldCB0aGUgbmV3IHBvc2l0aW9uXG4gICAgICAgICAgcG9zaXRpb24gPSBzbGlkZXIuY2hpbGRyZW4uZXEoMCkucG9zaXRpb24oKTtcbiAgICAgICAgLy8gY2Fyb3VzZWwsIGxhc3Qgc2xpZGVcbiAgICAgICAgfSBlbHNlIGlmIChzbGlkZXIuYWN0aXZlLmluZGV4ID09PSBnZXRQYWdlclF0eSgpIC0gMSAmJiBzbGlkZXIuY2Fyb3VzZWwpIHtcbiAgICAgICAgICBwb3NpdGlvbiA9IHNsaWRlci5jaGlsZHJlbi5lcSgoZ2V0UGFnZXJRdHkoKSAtIDEpICogZ2V0TW92ZUJ5KCkpLnBvc2l0aW9uKCk7XG4gICAgICAgIC8vIGxhc3Qgc2xpZGVcbiAgICAgICAgfSBlbHNlIGlmIChzbGlkZXIuYWN0aXZlLmluZGV4ID09PSBzbGlkZXIuY2hpbGRyZW4ubGVuZ3RoIC0gMSkge1xuICAgICAgICAgIHBvc2l0aW9uID0gc2xpZGVyLmNoaWxkcmVuLmVxKHNsaWRlci5jaGlsZHJlbi5sZW5ndGggLSAxKS5wb3NpdGlvbigpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwb3NpdGlvbikge1xuICAgICAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MubW9kZSA9PT0gJ2hvcml6b250YWwnKSB7IHNldFBvc2l0aW9uUHJvcGVydHkoLXBvc2l0aW9uLmxlZnQsICdyZXNldCcsIDApOyB9XG4gICAgICAgICAgZWxzZSBpZiAoc2xpZGVyLnNldHRpbmdzLm1vZGUgPT09ICd2ZXJ0aWNhbCcpIHsgc2V0UG9zaXRpb25Qcm9wZXJ0eSgtcG9zaXRpb24udG9wLCAncmVzZXQnLCAwKTsgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICAvLyBkZWNsYXJlIHRoYXQgdGhlIHRyYW5zaXRpb24gaXMgY29tcGxldGVcbiAgICAgIHNsaWRlci53b3JraW5nID0gZmFsc2U7XG4gICAgICAvLyBvblNsaWRlQWZ0ZXIgY2FsbGJhY2tcbiAgICAgIHNsaWRlci5zZXR0aW5ncy5vblNsaWRlQWZ0ZXIuY2FsbChlbCwgc2xpZGVyLmNoaWxkcmVuLmVxKHNsaWRlci5hY3RpdmUuaW5kZXgpLCBzbGlkZXIub2xkSW5kZXgsIHNsaWRlci5hY3RpdmUuaW5kZXgpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGVzIHRoZSBhdXRvIGNvbnRyb2xzIHN0YXRlIChlaXRoZXIgYWN0aXZlLCBvciBjb21iaW5lZCBzd2l0Y2gpXG4gICAgICpcbiAgICAgKiBAcGFyYW0gc3RhdGUgKHN0cmluZykgXCJzdGFydFwiLCBcInN0b3BcIlxuICAgICAqICAtIHRoZSBuZXcgc3RhdGUgb2YgdGhlIGF1dG8gc2hvd1xuICAgICAqL1xuICAgIHZhciB1cGRhdGVBdXRvQ29udHJvbHMgPSBmdW5jdGlvbihzdGF0ZSkge1xuICAgICAgLy8gaWYgYXV0b0NvbnRyb2xzQ29tYmluZSBpcyB0cnVlLCByZXBsYWNlIHRoZSBjdXJyZW50IGNvbnRyb2wgd2l0aCB0aGUgbmV3IHN0YXRlXG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmF1dG9Db250cm9sc0NvbWJpbmUpIHtcbiAgICAgICAgc2xpZGVyLmNvbnRyb2xzLmF1dG9FbC5odG1sKHNsaWRlci5jb250cm9sc1tzdGF0ZV0pO1xuICAgICAgLy8gaWYgYXV0b0NvbnRyb2xzQ29tYmluZSBpcyBmYWxzZSwgYXBwbHkgdGhlIFwiYWN0aXZlXCIgY2xhc3MgdG8gdGhlIGFwcHJvcHJpYXRlIGNvbnRyb2xcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNsaWRlci5jb250cm9scy5hdXRvRWwuZmluZCgnYScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgc2xpZGVyLmNvbnRyb2xzLmF1dG9FbC5maW5kKCdhOm5vdCguYngtJyArIHN0YXRlICsgJyknKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgdGhlIGRpcmVjdGlvbiBjb250cm9scyAoY2hlY2tzIGlmIGVpdGhlciBzaG91bGQgYmUgaGlkZGVuKVxuICAgICAqL1xuICAgIHZhciB1cGRhdGVEaXJlY3Rpb25Db250cm9scyA9IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKGdldFBhZ2VyUXR5KCkgPT09IDEpIHtcbiAgICAgICAgc2xpZGVyLmNvbnRyb2xzLnByZXYuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICAgIHNsaWRlci5jb250cm9scy5uZXh0LmFkZENsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgfSBlbHNlIGlmICghc2xpZGVyLnNldHRpbmdzLmluZmluaXRlTG9vcCAmJiBzbGlkZXIuc2V0dGluZ3MuaGlkZUNvbnRyb2xPbkVuZCkge1xuICAgICAgICAvLyBpZiBmaXJzdCBzbGlkZVxuICAgICAgICBpZiAoc2xpZGVyLmFjdGl2ZS5pbmRleCA9PT0gMCkge1xuICAgICAgICAgIHNsaWRlci5jb250cm9scy5wcmV2LmFkZENsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICAgIHNsaWRlci5jb250cm9scy5uZXh0LnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICAvLyBpZiBsYXN0IHNsaWRlXG4gICAgICAgIH0gZWxzZSBpZiAoc2xpZGVyLmFjdGl2ZS5pbmRleCA9PT0gZ2V0UGFnZXJRdHkoKSAtIDEpIHtcbiAgICAgICAgICBzbGlkZXIuY29udHJvbHMubmV4dC5hZGRDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgICBzbGlkZXIuY29udHJvbHMucHJldi5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgLy8gaWYgYW55IHNsaWRlIGluIHRoZSBtaWRkbGVcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzbGlkZXIuY29udHJvbHMucHJldi5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgICBzbGlkZXIuY29udHJvbHMubmV4dC5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG5cdC8qIGF1dG8gc3RhcnQgYW5kIHN0b3AgZnVuY3Rpb25zICovXG5cdHZhciB3aW5kb3dGb2N1c0hhbmRsZXIgPSBmdW5jdGlvbigpIHsgZWwuc3RhcnRBdXRvKCk7IH07XG5cdHZhciB3aW5kb3dCbHVySGFuZGxlciA9IGZ1bmN0aW9uKCkgeyBlbC5zdG9wQXV0bygpOyB9O1xuICAgIC8qKlxuICAgICAqIEluaXRpYWxpemVzIHRoZSBhdXRvIHByb2Nlc3NcbiAgICAgKi9cbiAgICB2YXIgaW5pdEF1dG8gPSBmdW5jdGlvbigpIHtcbiAgICAgIC8vIGlmIGF1dG9EZWxheSB3YXMgc3VwcGxpZWQsIGxhdW5jaCB0aGUgYXV0byBzaG93IHVzaW5nIGEgc2V0VGltZW91dCgpIGNhbGxcbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MuYXV0b0RlbGF5ID4gMCkge1xuICAgICAgICBzZXRUaW1lb3V0KGVsLnN0YXJ0QXV0bywgc2xpZGVyLnNldHRpbmdzLmF1dG9EZWxheSk7XG4gICAgICAvLyBpZiBhdXRvRGVsYXkgd2FzIG5vdCBzdXBwbGllZCwgc3RhcnQgdGhlIGF1dG8gc2hvdyBub3JtYWxseVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZWwuc3RhcnRBdXRvKCk7XG5cbiAgICAgICAgLy9hZGQgZm9jdXMgYW5kIGJsdXIgZXZlbnRzIHRvIGVuc3VyZSBpdHMgcnVubmluZyBpZiB0aW1lb3V0IGdldHMgcGF1c2VkXG4gICAgICAgICQod2luZG93KS5mb2N1cyh3aW5kb3dGb2N1c0hhbmRsZXIpLmJsdXIod2luZG93Qmx1ckhhbmRsZXIpO1xuICAgICAgfVxuICAgICAgLy8gaWYgYXV0b0hvdmVyIGlzIHJlcXVlc3RlZFxuICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5hdXRvSG92ZXIpIHtcbiAgICAgICAgLy8gb24gZWwgaG92ZXJcbiAgICAgICAgZWwuaG92ZXIoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgLy8gaWYgdGhlIGF1dG8gc2hvdyBpcyBjdXJyZW50bHkgcGxheWluZyAoaGFzIGFuIGFjdGl2ZSBpbnRlcnZhbClcbiAgICAgICAgICBpZiAoc2xpZGVyLmludGVydmFsKSB7XG4gICAgICAgICAgICAvLyBzdG9wIHRoZSBhdXRvIHNob3cgYW5kIHBhc3MgdHJ1ZSBhcmd1bWVudCB3aGljaCB3aWxsIHByZXZlbnQgY29udHJvbCB1cGRhdGVcbiAgICAgICAgICAgIGVsLnN0b3BBdXRvKHRydWUpO1xuICAgICAgICAgICAgLy8gY3JlYXRlIGEgbmV3IGF1dG9QYXVzZWQgdmFsdWUgd2hpY2ggd2lsbCBiZSB1c2VkIGJ5IHRoZSByZWxhdGl2ZSBcIm1vdXNlb3V0XCIgZXZlbnRcbiAgICAgICAgICAgIHNsaWRlci5hdXRvUGF1c2VkID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIC8vIGlmIHRoZSBhdXRvUGF1c2VkIHZhbHVlIHdhcyBjcmVhdGVkIGJlIHRoZSBwcmlvciBcIm1vdXNlb3ZlclwiIGV2ZW50XG4gICAgICAgICAgaWYgKHNsaWRlci5hdXRvUGF1c2VkKSB7XG4gICAgICAgICAgICAvLyBzdGFydCB0aGUgYXV0byBzaG93IGFuZCBwYXNzIHRydWUgYXJndW1lbnQgd2hpY2ggd2lsbCBwcmV2ZW50IGNvbnRyb2wgdXBkYXRlXG4gICAgICAgICAgICBlbC5zdGFydEF1dG8odHJ1ZSk7XG4gICAgICAgICAgICAvLyByZXNldCB0aGUgYXV0b1BhdXNlZCB2YWx1ZVxuICAgICAgICAgICAgc2xpZGVyLmF1dG9QYXVzZWQgPSBudWxsO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEluaXRpYWxpemVzIHRoZSB0aWNrZXIgcHJvY2Vzc1xuICAgICAqL1xuICAgIHZhciBpbml0VGlja2VyID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgc3RhcnRQb3NpdGlvbiA9IDAsXG4gICAgICBwb3NpdGlvbiwgdHJhbnNmb3JtLCB2YWx1ZSwgaWR4LCByYXRpbywgcHJvcGVydHksIG5ld1NwZWVkLCB0b3RhbERpbWVucztcbiAgICAgIC8vIGlmIGF1dG9EaXJlY3Rpb24gaXMgXCJuZXh0XCIsIGFwcGVuZCBhIGNsb25lIG9mIHRoZSBlbnRpcmUgc2xpZGVyXG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmF1dG9EaXJlY3Rpb24gPT09ICduZXh0Jykge1xuICAgICAgICBlbC5hcHBlbmQoc2xpZGVyLmNoaWxkcmVuLmNsb25lKCkuYWRkQ2xhc3MoJ2J4LWNsb25lJykpO1xuICAgICAgLy8gaWYgYXV0b0RpcmVjdGlvbiBpcyBcInByZXZcIiwgcHJlcGVuZCBhIGNsb25lIG9mIHRoZSBlbnRpcmUgc2xpZGVyLCBhbmQgc2V0IHRoZSBsZWZ0IHBvc2l0aW9uXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBlbC5wcmVwZW5kKHNsaWRlci5jaGlsZHJlbi5jbG9uZSgpLmFkZENsYXNzKCdieC1jbG9uZScpKTtcbiAgICAgICAgcG9zaXRpb24gPSBzbGlkZXIuY2hpbGRyZW4uZmlyc3QoKS5wb3NpdGlvbigpO1xuICAgICAgICBzdGFydFBvc2l0aW9uID0gc2xpZGVyLnNldHRpbmdzLm1vZGUgPT09ICdob3Jpem9udGFsJyA/IC1wb3NpdGlvbi5sZWZ0IDogLXBvc2l0aW9uLnRvcDtcbiAgICAgIH1cbiAgICAgIHNldFBvc2l0aW9uUHJvcGVydHkoc3RhcnRQb3NpdGlvbiwgJ3Jlc2V0JywgMCk7XG4gICAgICAvLyBkbyBub3QgYWxsb3cgY29udHJvbHMgaW4gdGlja2VyIG1vZGVcbiAgICAgIHNsaWRlci5zZXR0aW5ncy5wYWdlciA9IGZhbHNlO1xuICAgICAgc2xpZGVyLnNldHRpbmdzLmNvbnRyb2xzID0gZmFsc2U7XG4gICAgICBzbGlkZXIuc2V0dGluZ3MuYXV0b0NvbnRyb2xzID0gZmFsc2U7XG4gICAgICAvLyBpZiBhdXRvSG92ZXIgaXMgcmVxdWVzdGVkXG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLnRpY2tlckhvdmVyKSB7XG4gICAgICAgIGlmIChzbGlkZXIudXNpbmdDU1MpIHtcbiAgICAgICAgICBpZHggPSBzbGlkZXIuc2V0dGluZ3MubW9kZSA9PT0gJ2hvcml6b250YWwnID8gNCA6IDU7XG4gICAgICAgICAgc2xpZGVyLnZpZXdwb3J0LmhvdmVyKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdHJhbnNmb3JtID0gZWwuY3NzKCctJyArIHNsaWRlci5jc3NQcmVmaXggKyAnLXRyYW5zZm9ybScpO1xuICAgICAgICAgICAgdmFsdWUgPSBwYXJzZUZsb2F0KHRyYW5zZm9ybS5zcGxpdCgnLCcpW2lkeF0pO1xuICAgICAgICAgICAgc2V0UG9zaXRpb25Qcm9wZXJ0eSh2YWx1ZSwgJ3Jlc2V0JywgMCk7XG4gICAgICAgICAgfSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0b3RhbERpbWVucyA9IDA7XG4gICAgICAgICAgICBzbGlkZXIuY2hpbGRyZW4uZWFjaChmdW5jdGlvbihpbmRleCkge1xuICAgICAgICAgICAgICB0b3RhbERpbWVucyArPSBzbGlkZXIuc2V0dGluZ3MubW9kZSA9PT0gJ2hvcml6b250YWwnID8gJCh0aGlzKS5vdXRlcldpZHRoKHRydWUpIDogJCh0aGlzKS5vdXRlckhlaWdodCh0cnVlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gY2FsY3VsYXRlIHRoZSBzcGVlZCByYXRpbyAodXNlZCB0byBkZXRlcm1pbmUgdGhlIG5ldyBzcGVlZCB0byBmaW5pc2ggdGhlIHBhdXNlZCBhbmltYXRpb24pXG4gICAgICAgICAgICByYXRpbyA9IHNsaWRlci5zZXR0aW5ncy5zcGVlZCAvIHRvdGFsRGltZW5zO1xuICAgICAgICAgICAgLy8gZGV0ZXJtaW5lIHdoaWNoIHByb3BlcnR5IHRvIHVzZVxuICAgICAgICAgICAgcHJvcGVydHkgPSBzbGlkZXIuc2V0dGluZ3MubW9kZSA9PT0gJ2hvcml6b250YWwnID8gJ2xlZnQnIDogJ3RvcCc7XG4gICAgICAgICAgICAvLyBjYWxjdWxhdGUgdGhlIG5ldyBzcGVlZFxuICAgICAgICAgICAgbmV3U3BlZWQgPSByYXRpbyAqICh0b3RhbERpbWVucyAtIChNYXRoLmFicyhwYXJzZUludCh2YWx1ZSkpKSk7XG4gICAgICAgICAgICB0aWNrZXJMb29wKG5ld1NwZWVkKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBvbiBlbCBob3ZlclxuICAgICAgICAgIHNsaWRlci52aWV3cG9ydC5ob3ZlcihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGVsLnN0b3AoKTtcbiAgICAgICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIC8vIGNhbGN1bGF0ZSB0aGUgdG90YWwgd2lkdGggb2YgY2hpbGRyZW4gKHVzZWQgdG8gY2FsY3VsYXRlIHRoZSBzcGVlZCByYXRpbylcbiAgICAgICAgICAgIHRvdGFsRGltZW5zID0gMDtcbiAgICAgICAgICAgIHNsaWRlci5jaGlsZHJlbi5lYWNoKGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgICAgICAgICAgIHRvdGFsRGltZW5zICs9IHNsaWRlci5zZXR0aW5ncy5tb2RlID09PSAnaG9yaXpvbnRhbCcgPyAkKHRoaXMpLm91dGVyV2lkdGgodHJ1ZSkgOiAkKHRoaXMpLm91dGVySGVpZ2h0KHRydWUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvLyBjYWxjdWxhdGUgdGhlIHNwZWVkIHJhdGlvICh1c2VkIHRvIGRldGVybWluZSB0aGUgbmV3IHNwZWVkIHRvIGZpbmlzaCB0aGUgcGF1c2VkIGFuaW1hdGlvbilcbiAgICAgICAgICAgIHJhdGlvID0gc2xpZGVyLnNldHRpbmdzLnNwZWVkIC8gdG90YWxEaW1lbnM7XG4gICAgICAgICAgICAvLyBkZXRlcm1pbmUgd2hpY2ggcHJvcGVydHkgdG8gdXNlXG4gICAgICAgICAgICBwcm9wZXJ0eSA9IHNsaWRlci5zZXR0aW5ncy5tb2RlID09PSAnaG9yaXpvbnRhbCcgPyAnbGVmdCcgOiAndG9wJztcbiAgICAgICAgICAgIC8vIGNhbGN1bGF0ZSB0aGUgbmV3IHNwZWVkXG4gICAgICAgICAgICBuZXdTcGVlZCA9IHJhdGlvICogKHRvdGFsRGltZW5zIC0gKE1hdGguYWJzKHBhcnNlSW50KGVsLmNzcyhwcm9wZXJ0eSkpKSkpO1xuICAgICAgICAgICAgdGlja2VyTG9vcChuZXdTcGVlZCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIC8vIHN0YXJ0IHRoZSB0aWNrZXIgbG9vcFxuICAgICAgdGlja2VyTG9vcCgpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBSdW5zIGEgY29udGludW91cyBsb29wLCBuZXdzIHRpY2tlci1zdHlsZVxuICAgICAqL1xuICAgIHZhciB0aWNrZXJMb29wID0gZnVuY3Rpb24ocmVzdW1lU3BlZWQpIHtcbiAgICAgIHZhciBzcGVlZCA9IHJlc3VtZVNwZWVkID8gcmVzdW1lU3BlZWQgOiBzbGlkZXIuc2V0dGluZ3Muc3BlZWQsXG4gICAgICBwb3NpdGlvbiA9IHtsZWZ0OiAwLCB0b3A6IDB9LFxuICAgICAgcmVzZXQgPSB7bGVmdDogMCwgdG9wOiAwfSxcbiAgICAgIGFuaW1hdGVQcm9wZXJ0eSwgcmVzZXRWYWx1ZSwgcGFyYW1zO1xuXG4gICAgICAvLyBpZiBcIm5leHRcIiBhbmltYXRlIGxlZnQgcG9zaXRpb24gdG8gbGFzdCBjaGlsZCwgdGhlbiByZXNldCBsZWZ0IHRvIDBcbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MuYXV0b0RpcmVjdGlvbiA9PT0gJ25leHQnKSB7XG4gICAgICAgIHBvc2l0aW9uID0gZWwuZmluZCgnLmJ4LWNsb25lJykuZmlyc3QoKS5wb3NpdGlvbigpO1xuICAgICAgLy8gaWYgXCJwcmV2XCIgYW5pbWF0ZSBsZWZ0IHBvc2l0aW9uIHRvIDAsIHRoZW4gcmVzZXQgbGVmdCB0byBmaXJzdCBub24tY2xvbmUgY2hpbGRcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc2V0ID0gc2xpZGVyLmNoaWxkcmVuLmZpcnN0KCkucG9zaXRpb24oKTtcbiAgICAgIH1cbiAgICAgIGFuaW1hdGVQcm9wZXJ0eSA9IHNsaWRlci5zZXR0aW5ncy5tb2RlID09PSAnaG9yaXpvbnRhbCcgPyAtcG9zaXRpb24ubGVmdCA6IC1wb3NpdGlvbi50b3A7XG4gICAgICByZXNldFZhbHVlID0gc2xpZGVyLnNldHRpbmdzLm1vZGUgPT09ICdob3Jpem9udGFsJyA/IC1yZXNldC5sZWZ0IDogLXJlc2V0LnRvcDtcbiAgICAgIHBhcmFtcyA9IHtyZXNldFZhbHVlOiByZXNldFZhbHVlfTtcbiAgICAgIHNldFBvc2l0aW9uUHJvcGVydHkoYW5pbWF0ZVByb3BlcnR5LCAndGlja2VyJywgc3BlZWQsIHBhcmFtcyk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIGVsIGlzIG9uIHNjcmVlblxuICAgICAqL1xuICAgIHZhciBpc09uU2NyZWVuID0gZnVuY3Rpb24oZWwpIHtcbiAgICAgIHZhciB3aW4gPSAkKHdpbmRvdyksXG4gICAgICB2aWV3cG9ydCA9IHtcbiAgICAgICAgdG9wOiB3aW4uc2Nyb2xsVG9wKCksXG4gICAgICAgIGxlZnQ6IHdpbi5zY3JvbGxMZWZ0KClcbiAgICAgIH0sXG4gICAgICBib3VuZHMgPSBlbC5vZmZzZXQoKTtcblxuICAgICAgdmlld3BvcnQucmlnaHQgPSB2aWV3cG9ydC5sZWZ0ICsgd2luLndpZHRoKCk7XG4gICAgICB2aWV3cG9ydC5ib3R0b20gPSB2aWV3cG9ydC50b3AgKyB3aW4uaGVpZ2h0KCk7XG4gICAgICBib3VuZHMucmlnaHQgPSBib3VuZHMubGVmdCArIGVsLm91dGVyV2lkdGgoKTtcbiAgICAgIGJvdW5kcy5ib3R0b20gPSBib3VuZHMudG9wICsgZWwub3V0ZXJIZWlnaHQoKTtcblxuICAgICAgcmV0dXJuICghKHZpZXdwb3J0LnJpZ2h0IDwgYm91bmRzLmxlZnQgfHwgdmlld3BvcnQubGVmdCA+IGJvdW5kcy5yaWdodCB8fCB2aWV3cG9ydC5ib3R0b20gPCBib3VuZHMudG9wIHx8IHZpZXdwb3J0LnRvcCA+IGJvdW5kcy5ib3R0b20pKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogSW5pdGlhbGl6ZXMga2V5Ym9hcmQgZXZlbnRzXG4gICAgICovXG4gICAgdmFyIGtleVByZXNzID0gZnVuY3Rpb24oZSkge1xuICAgICAgdmFyIGFjdGl2ZUVsZW1lbnRUYWcgPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50LnRhZ05hbWUudG9Mb3dlckNhc2UoKSxcbiAgICAgIHRhZ0ZpbHRlcnMgPSAnaW5wdXR8dGV4dGFyZWEnLFxuICAgICAgcCA9IG5ldyBSZWdFeHAoYWN0aXZlRWxlbWVudFRhZyxbJ2knXSksXG4gICAgICByZXN1bHQgPSBwLmV4ZWModGFnRmlsdGVycyk7XG5cbiAgICAgIGlmIChyZXN1bHQgPT0gbnVsbCAmJiBpc09uU2NyZWVuKGVsKSkge1xuICAgICAgICBpZiAoZS5rZXlDb2RlID09PSAzOSkge1xuICAgICAgICAgIGNsaWNrTmV4dEJpbmQoZSk7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9IGVsc2UgaWYgKGUua2V5Q29kZSA9PT0gMzcpIHtcbiAgICAgICAgICBjbGlja1ByZXZCaW5kKGUpO1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBJbml0aWFsaXplcyB0b3VjaCBldmVudHNcbiAgICAgKi9cbiAgICB2YXIgaW5pdFRvdWNoID0gZnVuY3Rpb24oKSB7XG4gICAgICAvLyBpbml0aWFsaXplIG9iamVjdCB0byBjb250YWluIGFsbCB0b3VjaCB2YWx1ZXNcbiAgICAgIHNsaWRlci50b3VjaCA9IHtcbiAgICAgICAgc3RhcnQ6IHt4OiAwLCB5OiAwfSxcbiAgICAgICAgZW5kOiB7eDogMCwgeTogMH1cbiAgICAgIH07XG4gICAgICBzbGlkZXIudmlld3BvcnQub24oJ3RvdWNoc3RhcnQgTVNQb2ludGVyRG93biBwb2ludGVyZG93bicsIG9uVG91Y2hTdGFydCk7XG5cbiAgICAgIC8vZm9yIGJyb3dzZXJzIHRoYXQgaGF2ZSBpbXBsZW1lbnRlZCBwb2ludGVyIGV2ZW50cyBhbmQgZmlyZSBhIGNsaWNrIGFmdGVyXG4gICAgICAvL2V2ZXJ5IHBvaW50ZXJ1cCByZWdhcmRsZXNzIG9mIHdoZXRoZXIgcG9pbnRlcnVwIGlzIG9uIHNhbWUgc2NyZWVuIGxvY2F0aW9uIGFzIHBvaW50ZXJkb3duIG9yIG5vdFxuICAgICAgc2xpZGVyLnZpZXdwb3J0Lm9uKCdjbGljaycsICcuYnhzbGlkZXIgYScsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgaWYgKHNsaWRlci52aWV3cG9ydC5oYXNDbGFzcygnY2xpY2stZGlzYWJsZWQnKSkge1xuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICBzbGlkZXIudmlld3BvcnQucmVtb3ZlQ2xhc3MoJ2NsaWNrLWRpc2FibGVkJyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBFdmVudCBoYW5kbGVyIGZvciBcInRvdWNoc3RhcnRcIlxuICAgICAqXG4gICAgICogQHBhcmFtIGUgKGV2ZW50KVxuICAgICAqICAtIERPTSBldmVudCBvYmplY3RcbiAgICAgKi9cbiAgICB2YXIgb25Ub3VjaFN0YXJ0ID0gZnVuY3Rpb24oZSkge1xuICAgICAgLy8gd2F0Y2ggb25seSBmb3IgbGVmdCBtb3VzZSwgdG91Y2ggY29udGFjdCBhbmQgcGVuIGNvbnRhY3RcbiAgICAgIC8vIHRvdWNoc3RhcnQgZXZlbnQgb2JqZWN0IGRvZXNuYHQgaGF2ZSBidXR0b24gcHJvcGVydHlcbiAgICAgIGlmIChlLnR5cGUgIT09ICd0b3VjaHN0YXJ0JyAmJiBlLmJ1dHRvbiAhPT0gMCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAvL2Rpc2FibGUgc2xpZGVyIGNvbnRyb2xzIHdoaWxlIHVzZXIgaXMgaW50ZXJhY3Rpbmcgd2l0aCBzbGlkZXMgdG8gYXZvaWQgc2xpZGVyIGZyZWV6ZSB0aGF0IGhhcHBlbnMgb24gdG91Y2ggZGV2aWNlcyB3aGVuIGEgc2xpZGUgc3dpcGUgaGFwcGVucyBpbW1lZGlhdGVseSBhZnRlciBpbnRlcmFjdGluZyB3aXRoIHNsaWRlciBjb250cm9sc1xuICAgICAgc2xpZGVyLmNvbnRyb2xzLmVsLmFkZENsYXNzKCdkaXNhYmxlZCcpO1xuXG4gICAgICBpZiAoc2xpZGVyLndvcmtpbmcpIHtcbiAgICAgICAgc2xpZGVyLmNvbnRyb2xzLmVsLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gcmVjb3JkIHRoZSBvcmlnaW5hbCBwb3NpdGlvbiB3aGVuIHRvdWNoIHN0YXJ0c1xuICAgICAgICBzbGlkZXIudG91Y2gub3JpZ2luYWxQb3MgPSBlbC5wb3NpdGlvbigpO1xuICAgICAgICB2YXIgb3JpZyA9IGUub3JpZ2luYWxFdmVudCxcbiAgICAgICAgdG91Y2hQb2ludHMgPSAodHlwZW9mIG9yaWcuY2hhbmdlZFRvdWNoZXMgIT09ICd1bmRlZmluZWQnKSA/IG9yaWcuY2hhbmdlZFRvdWNoZXMgOiBbb3JpZ107XG5cdFx0dmFyIGNocm9tZVBvaW50ZXJFdmVudHMgPSB0eXBlb2YgUG9pbnRlckV2ZW50ID09PSAnZnVuY3Rpb24nOyBcblx0XHRpZiAoY2hyb21lUG9pbnRlckV2ZW50cykgeyBcblx0XHRcdGlmIChvcmlnLnBvaW50ZXJJZCA9PT0gdW5kZWZpbmVkKSB7IFxuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9IFxuXHRcdH1cbiAgICAgICAgLy8gcmVjb3JkIHRoZSBzdGFydGluZyB0b3VjaCB4LCB5IGNvb3JkaW5hdGVzXG4gICAgICAgIHNsaWRlci50b3VjaC5zdGFydC54ID0gdG91Y2hQb2ludHNbMF0ucGFnZVg7XG4gICAgICAgIHNsaWRlci50b3VjaC5zdGFydC55ID0gdG91Y2hQb2ludHNbMF0ucGFnZVk7XG5cbiAgICAgICAgaWYgKHNsaWRlci52aWV3cG9ydC5nZXQoMCkuc2V0UG9pbnRlckNhcHR1cmUpIHtcbiAgICAgICAgICBzbGlkZXIucG9pbnRlcklkID0gb3JpZy5wb2ludGVySWQ7XG4gICAgICAgICAgc2xpZGVyLnZpZXdwb3J0LmdldCgwKS5zZXRQb2ludGVyQ2FwdHVyZShzbGlkZXIucG9pbnRlcklkKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBzdG9yZSBvcmlnaW5hbCBldmVudCBkYXRhIGZvciBjbGljayBmaXhhdGlvblxuICAgICAgICBzbGlkZXIub3JpZ2luYWxDbGlja1RhcmdldCA9IG9yaWcub3JpZ2luYWxUYXJnZXQgfHwgb3JpZy50YXJnZXQ7XG4gICAgICAgIHNsaWRlci5vcmlnaW5hbENsaWNrQnV0dG9uID0gb3JpZy5idXR0b247XG4gICAgICAgIHNsaWRlci5vcmlnaW5hbENsaWNrQnV0dG9ucyA9IG9yaWcuYnV0dG9ucztcbiAgICAgICAgc2xpZGVyLm9yaWdpbmFsRXZlbnRUeXBlID0gb3JpZy50eXBlO1xuICAgICAgICAvLyBhdCB0aGlzIG1vbWVudCB3ZSBkb25gdCBrbm93IHdoYXQgaXQgaXMgY2xpY2sgb3Igc3dpcGVcbiAgICAgICAgc2xpZGVyLmhhc01vdmUgPSBmYWxzZTtcbiAgICAgICAgLy8gb24gYSBcInRvdWNobW92ZVwiIGV2ZW50IHRvIHRoZSB2aWV3cG9ydFxuICAgICAgICBzbGlkZXIudmlld3BvcnQub24oJ3RvdWNobW92ZSBNU1BvaW50ZXJNb3ZlIHBvaW50ZXJtb3ZlJywgb25Ub3VjaE1vdmUpO1xuICAgICAgICAvLyBvbiBhIFwidG91Y2hlbmRcIiBldmVudCB0byB0aGUgdmlld3BvcnRcbiAgICAgICAgc2xpZGVyLnZpZXdwb3J0Lm9uKCd0b3VjaGVuZCBNU1BvaW50ZXJVcCBwb2ludGVydXAnLCBvblRvdWNoRW5kKTtcbiAgICAgICAgc2xpZGVyLnZpZXdwb3J0Lm9uKCdNU1BvaW50ZXJDYW5jZWwgcG9pbnRlcmNhbmNlbCcsIG9uUG9pbnRlckNhbmNlbCk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIENhbmNlbCBQb2ludGVyIGZvciBXaW5kb3dzIFBob25lXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZSAoZXZlbnQpXG4gICAgICogIC0gRE9NIGV2ZW50IG9iamVjdFxuICAgICAqL1xuICAgIHZhciBvblBvaW50ZXJDYW5jZWwgPSBmdW5jdGlvbihlKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAvKiBvblBvaW50ZXJDYW5jZWwgaGFuZGxlciBpcyBuZWVkZWQgdG8gZGVhbCB3aXRoIHNpdHVhdGlvbnMgd2hlbiBhIHRvdWNoZW5kXG4gICAgICBkb2Vzbid0IGZpcmUgYWZ0ZXIgYSB0b3VjaHN0YXJ0ICh0aGlzIGhhcHBlbnMgb24gd2luZG93cyBwaG9uZXMgb25seSkgKi9cbiAgICAgIHNldFBvc2l0aW9uUHJvcGVydHkoc2xpZGVyLnRvdWNoLm9yaWdpbmFsUG9zLmxlZnQsICdyZXNldCcsIDApO1xuXG4gICAgICAvL3JlbW92ZSBoYW5kbGVyc1xuICAgICAgc2xpZGVyLmNvbnRyb2xzLmVsLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgc2xpZGVyLnZpZXdwb3J0Lm9mZignTVNQb2ludGVyQ2FuY2VsIHBvaW50ZXJjYW5jZWwnLCBvblBvaW50ZXJDYW5jZWwpO1xuICAgICAgc2xpZGVyLnZpZXdwb3J0Lm9mZigndG91Y2htb3ZlIE1TUG9pbnRlck1vdmUgcG9pbnRlcm1vdmUnLCBvblRvdWNoTW92ZSk7XG4gICAgICBzbGlkZXIudmlld3BvcnQub2ZmKCd0b3VjaGVuZCBNU1BvaW50ZXJVcCBwb2ludGVydXAnLCBvblRvdWNoRW5kKTtcbiAgICAgIGlmIChzbGlkZXIudmlld3BvcnQuZ2V0KDApLnJlbGVhc2VQb2ludGVyQ2FwdHVyZSkge1xuICAgICAgICBzbGlkZXIudmlld3BvcnQuZ2V0KDApLnJlbGVhc2VQb2ludGVyQ2FwdHVyZShzbGlkZXIucG9pbnRlcklkKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogRXZlbnQgaGFuZGxlciBmb3IgXCJ0b3VjaG1vdmVcIlxuICAgICAqXG4gICAgICogQHBhcmFtIGUgKGV2ZW50KVxuICAgICAqICAtIERPTSBldmVudCBvYmplY3RcbiAgICAgKi9cbiAgICB2YXIgb25Ub3VjaE1vdmUgPSBmdW5jdGlvbihlKSB7XG4gICAgICB2YXIgb3JpZyA9IGUub3JpZ2luYWxFdmVudCxcbiAgICAgIHRvdWNoUG9pbnRzID0gKHR5cGVvZiBvcmlnLmNoYW5nZWRUb3VjaGVzICE9PSAndW5kZWZpbmVkJykgPyBvcmlnLmNoYW5nZWRUb3VjaGVzIDogW29yaWddLFxuICAgICAgLy8gaWYgc2Nyb2xsaW5nIG9uIHkgYXhpcywgZG8gbm90IHByZXZlbnQgZGVmYXVsdFxuICAgICAgeE1vdmVtZW50ID0gTWF0aC5hYnModG91Y2hQb2ludHNbMF0ucGFnZVggLSBzbGlkZXIudG91Y2guc3RhcnQueCksXG4gICAgICB5TW92ZW1lbnQgPSBNYXRoLmFicyh0b3VjaFBvaW50c1swXS5wYWdlWSAtIHNsaWRlci50b3VjaC5zdGFydC55KSxcbiAgICAgIHZhbHVlID0gMCxcbiAgICAgIGNoYW5nZSA9IDA7XG4gICAgICAvLyB0aGlzIGlzIHN3aXBlXG4gICAgICBzbGlkZXIuaGFzTW92ZSA9IHRydWU7XG5cbiAgICAgIC8vIHggYXhpcyBzd2lwZVxuICAgICAgaWYgKCh4TW92ZW1lbnQgKiAzKSA+IHlNb3ZlbWVudCAmJiBzbGlkZXIuc2V0dGluZ3MucHJldmVudERlZmF1bHRTd2lwZVgpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgLy8geSBheGlzIHN3aXBlXG4gICAgICB9IGVsc2UgaWYgKCh5TW92ZW1lbnQgKiAzKSA+IHhNb3ZlbWVudCAmJiBzbGlkZXIuc2V0dGluZ3MucHJldmVudERlZmF1bHRTd2lwZVkpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgfVxuICAgICAgaWYgKGUudHlwZSAhPT0gJ3RvdWNobW92ZScpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgfVxuXG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLm1vZGUgIT09ICdmYWRlJyAmJiBzbGlkZXIuc2V0dGluZ3Mub25lVG9PbmVUb3VjaCkge1xuICAgICAgICAvLyBpZiBob3Jpem9udGFsLCBkcmFnIGFsb25nIHggYXhpc1xuICAgICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLm1vZGUgPT09ICdob3Jpem9udGFsJykge1xuICAgICAgICAgIGNoYW5nZSA9IHRvdWNoUG9pbnRzWzBdLnBhZ2VYIC0gc2xpZGVyLnRvdWNoLnN0YXJ0Lng7XG4gICAgICAgICAgdmFsdWUgPSBzbGlkZXIudG91Y2gub3JpZ2luYWxQb3MubGVmdCArIGNoYW5nZTtcbiAgICAgICAgLy8gaWYgdmVydGljYWwsIGRyYWcgYWxvbmcgeSBheGlzXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY2hhbmdlID0gdG91Y2hQb2ludHNbMF0ucGFnZVkgLSBzbGlkZXIudG91Y2guc3RhcnQueTtcbiAgICAgICAgICB2YWx1ZSA9IHNsaWRlci50b3VjaC5vcmlnaW5hbFBvcy50b3AgKyBjaGFuZ2U7XG4gICAgICAgIH1cbiAgICAgICAgc2V0UG9zaXRpb25Qcm9wZXJ0eSh2YWx1ZSwgJ3Jlc2V0JywgMCk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEV2ZW50IGhhbmRsZXIgZm9yIFwidG91Y2hlbmRcIlxuICAgICAqXG4gICAgICogQHBhcmFtIGUgKGV2ZW50KVxuICAgICAqICAtIERPTSBldmVudCBvYmplY3RcbiAgICAgKi9cbiAgICB2YXIgb25Ub3VjaEVuZCA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHNsaWRlci52aWV3cG9ydC5vZmYoJ3RvdWNobW92ZSBNU1BvaW50ZXJNb3ZlIHBvaW50ZXJtb3ZlJywgb25Ub3VjaE1vdmUpO1xuICAgICAgLy9lbmFibGUgc2xpZGVyIGNvbnRyb2xzIGFzIHNvb24gYXMgdXNlciBzdG9wcyBpbnRlcmFjaW5nIHdpdGggc2xpZGVzXG4gICAgICBzbGlkZXIuY29udHJvbHMuZWwucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICB2YXIgb3JpZyAgICA9IGUub3JpZ2luYWxFdmVudCxcbiAgICAgIHRvdWNoUG9pbnRzID0gKHR5cGVvZiBvcmlnLmNoYW5nZWRUb3VjaGVzICE9PSAndW5kZWZpbmVkJykgPyBvcmlnLmNoYW5nZWRUb3VjaGVzIDogW29yaWddLFxuICAgICAgdmFsdWUgICAgICAgPSAwLFxuICAgICAgZGlzdGFuY2UgICAgPSAwO1xuICAgICAgLy8gcmVjb3JkIGVuZCB4LCB5IHBvc2l0aW9uc1xuICAgICAgc2xpZGVyLnRvdWNoLmVuZC54ID0gdG91Y2hQb2ludHNbMF0ucGFnZVg7XG4gICAgICBzbGlkZXIudG91Y2guZW5kLnkgPSB0b3VjaFBvaW50c1swXS5wYWdlWTtcbiAgICAgIC8vIGlmIGZhZGUgbW9kZSwgY2hlY2sgaWYgYWJzb2x1dGUgeCBkaXN0YW5jZSBjbGVhcnMgdGhlIHRocmVzaG9sZFxuICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5tb2RlID09PSAnZmFkZScpIHtcbiAgICAgICAgZGlzdGFuY2UgPSBNYXRoLmFicyhzbGlkZXIudG91Y2guc3RhcnQueCAtIHNsaWRlci50b3VjaC5lbmQueCk7XG4gICAgICAgIGlmIChkaXN0YW5jZSA+PSBzbGlkZXIuc2V0dGluZ3Muc3dpcGVUaHJlc2hvbGQpIHtcbiAgICAgICAgICBpZiAoc2xpZGVyLnRvdWNoLnN0YXJ0LnggPiBzbGlkZXIudG91Y2guZW5kLngpIHtcbiAgICAgICAgICAgIGVsLmdvVG9OZXh0U2xpZGUoKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZWwuZ29Ub1ByZXZTbGlkZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbC5zdG9wQXV0bygpO1xuICAgICAgICB9XG4gICAgICAvLyBub3QgZmFkZSBtb2RlXG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBjYWxjdWxhdGUgZGlzdGFuY2UgYW5kIGVsJ3MgYW5pbWF0ZSBwcm9wZXJ0eVxuICAgICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLm1vZGUgPT09ICdob3Jpem9udGFsJykge1xuICAgICAgICAgIGRpc3RhbmNlID0gc2xpZGVyLnRvdWNoLmVuZC54IC0gc2xpZGVyLnRvdWNoLnN0YXJ0Lng7XG4gICAgICAgICAgdmFsdWUgPSBzbGlkZXIudG91Y2gub3JpZ2luYWxQb3MubGVmdDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBkaXN0YW5jZSA9IHNsaWRlci50b3VjaC5lbmQueSAtIHNsaWRlci50b3VjaC5zdGFydC55O1xuICAgICAgICAgIHZhbHVlID0gc2xpZGVyLnRvdWNoLm9yaWdpbmFsUG9zLnRvcDtcbiAgICAgICAgfVxuICAgICAgICAvLyBpZiBub3QgaW5maW5pdGUgbG9vcCBhbmQgZmlyc3QgLyBsYXN0IHNsaWRlLCBkbyBub3QgYXR0ZW1wdCBhIHNsaWRlIHRyYW5zaXRpb25cbiAgICAgICAgaWYgKCFzbGlkZXIuc2V0dGluZ3MuaW5maW5pdGVMb29wICYmICgoc2xpZGVyLmFjdGl2ZS5pbmRleCA9PT0gMCAmJiBkaXN0YW5jZSA+IDApIHx8IChzbGlkZXIuYWN0aXZlLmxhc3QgJiYgZGlzdGFuY2UgPCAwKSkpIHtcbiAgICAgICAgICBzZXRQb3NpdGlvblByb3BlcnR5KHZhbHVlLCAncmVzZXQnLCAyMDApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIGNoZWNrIGlmIGRpc3RhbmNlIGNsZWFycyB0aHJlc2hvbGRcbiAgICAgICAgICBpZiAoTWF0aC5hYnMoZGlzdGFuY2UpID49IHNsaWRlci5zZXR0aW5ncy5zd2lwZVRocmVzaG9sZCkge1xuICAgICAgICAgICAgaWYgKGRpc3RhbmNlIDwgMCkge1xuICAgICAgICAgICAgICBlbC5nb1RvTmV4dFNsaWRlKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBlbC5nb1RvUHJldlNsaWRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbC5zdG9wQXV0bygpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBlbC5hbmltYXRlKHByb3BlcnR5LCAyMDApO1xuICAgICAgICAgICAgc2V0UG9zaXRpb25Qcm9wZXJ0eSh2YWx1ZSwgJ3Jlc2V0JywgMjAwKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHNsaWRlci52aWV3cG9ydC5vZmYoJ3RvdWNoZW5kIE1TUG9pbnRlclVwIHBvaW50ZXJ1cCcsIG9uVG91Y2hFbmQpO1xuXG4gICAgICBpZiAoc2xpZGVyLnZpZXdwb3J0LmdldCgwKS5yZWxlYXNlUG9pbnRlckNhcHR1cmUpIHtcbiAgICAgICAgc2xpZGVyLnZpZXdwb3J0LmdldCgwKS5yZWxlYXNlUG9pbnRlckNhcHR1cmUoc2xpZGVyLnBvaW50ZXJJZCk7XG4gICAgICB9XG4gICAgICAvLyBpZiBzbGlkZXIgaGFkIHN3aXBlIHdpdGggbGVmdCBtb3VzZSwgdG91Y2ggY29udGFjdCBhbmQgcGVuIGNvbnRhY3RcbiAgICAgIGlmIChzbGlkZXIuaGFzTW92ZSA9PT0gZmFsc2UgJiYgKHNsaWRlci5vcmlnaW5hbENsaWNrQnV0dG9uID09PSAwIHx8IHNsaWRlci5vcmlnaW5hbEV2ZW50VHlwZSA9PT0gJ3RvdWNoc3RhcnQnKSkge1xuICAgICAgICAvLyB0cmlnZ2VyIGNsaWNrIGV2ZW50IChmaXggZm9yIEZpcmVmb3g1OSBhbmQgUG9pbnRlckV2ZW50IHN0YW5kYXJkIGNvbXBhdGliaWxpdHkpXG4gICAgICAgICQoc2xpZGVyLm9yaWdpbmFsQ2xpY2tUYXJnZXQpLnRyaWdnZXIoe1xuICAgICAgICAgIHR5cGU6ICdjbGljaycsXG4gICAgICAgICAgYnV0dG9uOiBzbGlkZXIub3JpZ2luYWxDbGlja0J1dHRvbixcbiAgICAgICAgICBidXR0b25zOiBzbGlkZXIub3JpZ2luYWxDbGlja0J1dHRvbnNcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFdpbmRvdyByZXNpemUgZXZlbnQgY2FsbGJhY2tcbiAgICAgKi9cbiAgICB2YXIgcmVzaXplV2luZG93ID0gZnVuY3Rpb24oZSkge1xuICAgICAgLy8gZG9uJ3QgZG8gYW55dGhpbmcgaWYgc2xpZGVyIGlzbid0IGluaXRpYWxpemVkLlxuICAgICAgaWYgKCFzbGlkZXIuaW5pdGlhbGl6ZWQpIHsgcmV0dXJuOyB9XG4gICAgICAvLyBEZWxheSBpZiBzbGlkZXIgd29ya2luZy5cbiAgICAgIGlmIChzbGlkZXIud29ya2luZykge1xuICAgICAgICB3aW5kb3cuc2V0VGltZW91dChyZXNpemVXaW5kb3csIDEwKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIGdldCB0aGUgbmV3IHdpbmRvdyBkaW1lbnMgKGFnYWluLCB0aGFuayB5b3UgSUUpXG4gICAgICAgIHZhciB3aW5kb3dXaWR0aE5ldyA9ICQod2luZG93KS53aWR0aCgpLFxuICAgICAgICB3aW5kb3dIZWlnaHROZXcgPSAkKHdpbmRvdykuaGVpZ2h0KCk7XG4gICAgICAgIC8vIG1ha2Ugc3VyZSB0aGF0IGl0IGlzIGEgdHJ1ZSB3aW5kb3cgcmVzaXplXG4gICAgICAgIC8vICp3ZSBtdXN0IGNoZWNrIHRoaXMgYmVjYXVzZSBvdXIgZGlub3NhdXIgZnJpZW5kIElFIGZpcmVzIGEgd2luZG93IHJlc2l6ZSBldmVudCB3aGVuIGNlcnRhaW4gRE9NIGVsZW1lbnRzXG4gICAgICAgIC8vIGFyZSByZXNpemVkLiBDYW4geW91IGp1c3QgZGllIGFscmVhZHk/KlxuICAgICAgICBpZiAod2luZG93V2lkdGggIT09IHdpbmRvd1dpZHRoTmV3IHx8IHdpbmRvd0hlaWdodCAhPT0gd2luZG93SGVpZ2h0TmV3KSB7XG4gICAgICAgICAgLy8gc2V0IHRoZSBuZXcgd2luZG93IGRpbWVuc1xuICAgICAgICAgIHdpbmRvd1dpZHRoID0gd2luZG93V2lkdGhOZXc7XG4gICAgICAgICAgd2luZG93SGVpZ2h0ID0gd2luZG93SGVpZ2h0TmV3O1xuICAgICAgICAgIC8vIHVwZGF0ZSBhbGwgZHluYW1pYyBlbGVtZW50c1xuICAgICAgICAgIGVsLnJlZHJhd1NsaWRlcigpO1xuICAgICAgICAgIC8vIENhbGwgdXNlciByZXNpemUgaGFuZGxlclxuICAgICAgICAgIHNsaWRlci5zZXR0aW5ncy5vblNsaWRlclJlc2l6ZS5jYWxsKGVsLCBzbGlkZXIuYWN0aXZlLmluZGV4KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBBZGRzIGFuIGFyaWEtaGlkZGVuPXRydWUgYXR0cmlidXRlIHRvIGVhY2ggZWxlbWVudFxuICAgICAqXG4gICAgICogQHBhcmFtIHN0YXJ0VmlzaWJsZUluZGV4IChpbnQpXG4gICAgICogIC0gdGhlIGZpcnN0IHZpc2libGUgZWxlbWVudCdzIGluZGV4XG4gICAgICovXG4gICAgdmFyIGFwcGx5QXJpYUhpZGRlbkF0dHJpYnV0ZXMgPSBmdW5jdGlvbihzdGFydFZpc2libGVJbmRleCkge1xuICAgICAgdmFyIG51bWJlck9mU2xpZGVzU2hvd2luZyA9IGdldE51bWJlclNsaWRlc1Nob3dpbmcoKTtcbiAgICAgIC8vIG9ubHkgYXBwbHkgYXR0cmlidXRlcyBpZiB0aGUgc2V0dGluZyBpcyBlbmFibGVkIGFuZCBub3QgaW4gdGlja2VyIG1vZGVcbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MuYXJpYUhpZGRlbiAmJiAhc2xpZGVyLnNldHRpbmdzLnRpY2tlcikge1xuICAgICAgICAvLyBhZGQgYXJpYS1oaWRkZW49dHJ1ZSB0byBhbGwgZWxlbWVudHNcbiAgICAgICAgc2xpZGVyLmNoaWxkcmVuLmF0dHIoJ2FyaWEtaGlkZGVuJywgJ3RydWUnKTtcbiAgICAgICAgLy8gZ2V0IHRoZSB2aXNpYmxlIGVsZW1lbnRzIGFuZCBjaGFuZ2UgdG8gYXJpYS1oaWRkZW49ZmFsc2VcbiAgICAgICAgc2xpZGVyLmNoaWxkcmVuLnNsaWNlKHN0YXJ0VmlzaWJsZUluZGV4LCBzdGFydFZpc2libGVJbmRleCArIG51bWJlck9mU2xpZGVzU2hvd2luZykuYXR0cignYXJpYS1oaWRkZW4nLCAnZmFsc2UnKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBpbmRleCBhY2NvcmRpbmcgdG8gcHJlc2VudCBwYWdlIHJhbmdlXG4gICAgICpcbiAgICAgKiBAcGFyYW0gc2xpZGVPbmRleCAoaW50KVxuICAgICAqICAtIHRoZSBkZXNpcmVkIHNsaWRlIGluZGV4XG4gICAgICovXG4gICAgdmFyIHNldFNsaWRlSW5kZXggPSBmdW5jdGlvbihzbGlkZUluZGV4KSB7XG4gICAgICBpZiAoc2xpZGVJbmRleCA8IDApIHtcbiAgICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5pbmZpbml0ZUxvb3ApIHtcbiAgICAgICAgICByZXR1cm4gZ2V0UGFnZXJRdHkoKSAtIDE7XG4gICAgICAgIH1lbHNlIHtcbiAgICAgICAgICAvL3dlIGRvbid0IGdvIHRvIHVuZGVmaW5lZCBzbGlkZXNcbiAgICAgICAgICByZXR1cm4gc2xpZGVyLmFjdGl2ZS5pbmRleDtcbiAgICAgICAgfVxuICAgICAgLy8gaWYgc2xpZGVJbmRleCBpcyBncmVhdGVyIHRoYW4gY2hpbGRyZW4gbGVuZ3RoLCBzZXQgYWN0aXZlIGluZGV4IHRvIDAgKHRoaXMgaGFwcGVucyBkdXJpbmcgaW5maW5pdGUgbG9vcClcbiAgICAgIH0gZWxzZSBpZiAoc2xpZGVJbmRleCA+PSBnZXRQYWdlclF0eSgpKSB7XG4gICAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MuaW5maW5pdGVMb29wKSB7XG4gICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy93ZSBkb24ndCBtb3ZlIHRvIHVuZGVmaW5lZCBwYWdlc1xuICAgICAgICAgIHJldHVybiBzbGlkZXIuYWN0aXZlLmluZGV4O1xuICAgICAgICB9XG4gICAgICAvLyBzZXQgYWN0aXZlIGluZGV4IHRvIHJlcXVlc3RlZCBzbGlkZVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHNsaWRlSW5kZXg7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICogPSBQVUJMSUMgRlVOQ1RJT05TXG4gICAgICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgKi9cblxuICAgIC8qKlxuICAgICAqIFBlcmZvcm1zIHNsaWRlIHRyYW5zaXRpb24gdG8gdGhlIHNwZWNpZmllZCBzbGlkZVxuICAgICAqXG4gICAgICogQHBhcmFtIHNsaWRlSW5kZXggKGludClcbiAgICAgKiAgLSB0aGUgZGVzdGluYXRpb24gc2xpZGUncyBpbmRleCAoemVyby1iYXNlZClcbiAgICAgKlxuICAgICAqIEBwYXJhbSBkaXJlY3Rpb24gKHN0cmluZylcbiAgICAgKiAgLSBJTlRFUk5BTCBVU0UgT05MWSAtIHRoZSBkaXJlY3Rpb24gb2YgdHJhdmVsIChcInByZXZcIiAvIFwibmV4dFwiKVxuICAgICAqL1xuICAgIGVsLmdvVG9TbGlkZSA9IGZ1bmN0aW9uKHNsaWRlSW5kZXgsIGRpcmVjdGlvbikge1xuICAgICAgLy8gb25TbGlkZUJlZm9yZSwgb25TbGlkZU5leHQsIG9uU2xpZGVQcmV2IGNhbGxiYWNrc1xuICAgICAgLy8gQWxsb3cgdHJhbnNpdGlvbiBjYW5jZWxpbmcgYmFzZWQgb24gcmV0dXJuZWQgdmFsdWVcbiAgICAgIHZhciBwZXJmb3JtVHJhbnNpdGlvbiA9IHRydWUsXG4gICAgICBtb3ZlQnkgPSAwLFxuICAgICAgcG9zaXRpb24gPSB7bGVmdDogMCwgdG9wOiAwfSxcbiAgICAgIGxhc3RDaGlsZCA9IG51bGwsXG4gICAgICBsYXN0U2hvd2luZ0luZGV4LCBlcSwgdmFsdWUsIHJlcXVlc3RFbDtcbiAgICAgIC8vIHN0b3JlIHRoZSBvbGQgaW5kZXhcbiAgICAgIHNsaWRlci5vbGRJbmRleCA9IHNsaWRlci5hY3RpdmUuaW5kZXg7XG4gICAgICAvL3NldCBuZXcgaW5kZXhcbiAgICAgIHNsaWRlci5hY3RpdmUuaW5kZXggPSBzZXRTbGlkZUluZGV4KHNsaWRlSW5kZXgpO1xuXG4gICAgICAvLyBpZiBwbHVnaW4gaXMgY3VycmVudGx5IGluIG1vdGlvbiwgaWdub3JlIHJlcXVlc3RcbiAgICAgIGlmIChzbGlkZXIud29ya2luZyB8fCBzbGlkZXIuYWN0aXZlLmluZGV4ID09PSBzbGlkZXIub2xkSW5kZXgpIHsgcmV0dXJuOyB9XG4gICAgICAvLyBkZWNsYXJlIHRoYXQgcGx1Z2luIGlzIGluIG1vdGlvblxuICAgICAgc2xpZGVyLndvcmtpbmcgPSB0cnVlO1xuXG4gICAgICBwZXJmb3JtVHJhbnNpdGlvbiA9IHNsaWRlci5zZXR0aW5ncy5vblNsaWRlQmVmb3JlLmNhbGwoZWwsIHNsaWRlci5jaGlsZHJlbi5lcShzbGlkZXIuYWN0aXZlLmluZGV4KSwgc2xpZGVyLm9sZEluZGV4LCBzbGlkZXIuYWN0aXZlLmluZGV4KTtcblxuICAgICAgLy8gSWYgdHJhbnNpdGlvbnMgY2FuY2VsZWQsIHJlc2V0IGFuZCByZXR1cm5cbiAgICAgIGlmICh0eXBlb2YgKHBlcmZvcm1UcmFuc2l0aW9uKSAhPT0gJ3VuZGVmaW5lZCcgJiYgIXBlcmZvcm1UcmFuc2l0aW9uKSB7XG4gICAgICAgIHNsaWRlci5hY3RpdmUuaW5kZXggPSBzbGlkZXIub2xkSW5kZXg7IC8vIHJlc3RvcmUgb2xkIGluZGV4XG4gICAgICAgIHNsaWRlci53b3JraW5nID0gZmFsc2U7IC8vIGlzIG5vdCBpbiBtb3Rpb25cbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAoZGlyZWN0aW9uID09PSAnbmV4dCcpIHtcbiAgICAgICAgLy8gUHJldmVudCBjYW5jZWxpbmcgaW4gZnV0dXJlIGZ1bmN0aW9ucyBvciBsYWNrIHRoZXJlLW9mIGZyb20gbmVnYXRpbmcgcHJldmlvdXMgY29tbWFuZHMgdG8gY2FuY2VsXG4gICAgICAgIGlmICghc2xpZGVyLnNldHRpbmdzLm9uU2xpZGVOZXh0LmNhbGwoZWwsIHNsaWRlci5jaGlsZHJlbi5lcShzbGlkZXIuYWN0aXZlLmluZGV4KSwgc2xpZGVyLm9sZEluZGV4LCBzbGlkZXIuYWN0aXZlLmluZGV4KSkge1xuICAgICAgICAgIHBlcmZvcm1UcmFuc2l0aW9uID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoZGlyZWN0aW9uID09PSAncHJldicpIHtcbiAgICAgICAgLy8gUHJldmVudCBjYW5jZWxpbmcgaW4gZnV0dXJlIGZ1bmN0aW9ucyBvciBsYWNrIHRoZXJlLW9mIGZyb20gbmVnYXRpbmcgcHJldmlvdXMgY29tbWFuZHMgdG8gY2FuY2VsXG4gICAgICAgIGlmICghc2xpZGVyLnNldHRpbmdzLm9uU2xpZGVQcmV2LmNhbGwoZWwsIHNsaWRlci5jaGlsZHJlbi5lcShzbGlkZXIuYWN0aXZlLmluZGV4KSwgc2xpZGVyLm9sZEluZGV4LCBzbGlkZXIuYWN0aXZlLmluZGV4KSkge1xuICAgICAgICAgIHBlcmZvcm1UcmFuc2l0aW9uID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gY2hlY2sgaWYgbGFzdCBzbGlkZVxuICAgICAgc2xpZGVyLmFjdGl2ZS5sYXN0ID0gc2xpZGVyLmFjdGl2ZS5pbmRleCA+PSBnZXRQYWdlclF0eSgpIC0gMTtcbiAgICAgIC8vIHVwZGF0ZSB0aGUgcGFnZXIgd2l0aCBhY3RpdmUgY2xhc3NcbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MucGFnZXIgfHwgc2xpZGVyLnNldHRpbmdzLnBhZ2VyQ3VzdG9tKSB7IHVwZGF0ZVBhZ2VyQWN0aXZlKHNsaWRlci5hY3RpdmUuaW5kZXgpOyB9XG4gICAgICAvLyAvLyBjaGVjayBmb3IgZGlyZWN0aW9uIGNvbnRyb2wgdXBkYXRlXG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmNvbnRyb2xzKSB7IHVwZGF0ZURpcmVjdGlvbkNvbnRyb2xzKCk7IH1cbiAgICAgIC8vIGlmIHNsaWRlciBpcyBzZXQgdG8gbW9kZTogXCJmYWRlXCJcbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MubW9kZSA9PT0gJ2ZhZGUnKSB7XG4gICAgICAgIC8vIGlmIGFkYXB0aXZlSGVpZ2h0IGlzIHRydWUgYW5kIG5leHQgaGVpZ2h0IGlzIGRpZmZlcmVudCBmcm9tIGN1cnJlbnQgaGVpZ2h0LCBhbmltYXRlIHRvIHRoZSBuZXcgaGVpZ2h0XG4gICAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MuYWRhcHRpdmVIZWlnaHQgJiYgc2xpZGVyLnZpZXdwb3J0LmhlaWdodCgpICE9PSBnZXRWaWV3cG9ydEhlaWdodCgpKSB7XG4gICAgICAgICAgc2xpZGVyLnZpZXdwb3J0LmFuaW1hdGUoe2hlaWdodDogZ2V0Vmlld3BvcnRIZWlnaHQoKX0sIHNsaWRlci5zZXR0aW5ncy5hZGFwdGl2ZUhlaWdodFNwZWVkKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBmYWRlIG91dCB0aGUgdmlzaWJsZSBjaGlsZCBhbmQgcmVzZXQgaXRzIHotaW5kZXggdmFsdWVcbiAgICAgICAgc2xpZGVyLmNoaWxkcmVuLmZpbHRlcignOnZpc2libGUnKS5mYWRlT3V0KHNsaWRlci5zZXR0aW5ncy5zcGVlZCkuY3NzKHt6SW5kZXg6IDB9KTtcbiAgICAgICAgLy8gZmFkZSBpbiB0aGUgbmV3bHkgcmVxdWVzdGVkIHNsaWRlXG4gICAgICAgIHNsaWRlci5jaGlsZHJlbi5lcShzbGlkZXIuYWN0aXZlLmluZGV4KS5jc3MoJ3pJbmRleCcsIHNsaWRlci5zZXR0aW5ncy5zbGlkZVpJbmRleCArIDEpLmZhZGVJbihzbGlkZXIuc2V0dGluZ3Muc3BlZWQsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICQodGhpcykuY3NzKCd6SW5kZXgnLCBzbGlkZXIuc2V0dGluZ3Muc2xpZGVaSW5kZXgpO1xuICAgICAgICAgIHVwZGF0ZUFmdGVyU2xpZGVUcmFuc2l0aW9uKCk7XG4gICAgICAgIH0pO1xuICAgICAgLy8gc2xpZGVyIG1vZGUgaXMgbm90IFwiZmFkZVwiXG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBpZiBhZGFwdGl2ZUhlaWdodCBpcyB0cnVlIGFuZCBuZXh0IGhlaWdodCBpcyBkaWZmZXJlbnQgZnJvbSBjdXJyZW50IGhlaWdodCwgYW5pbWF0ZSB0byB0aGUgbmV3IGhlaWdodFxuICAgICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmFkYXB0aXZlSGVpZ2h0ICYmIHNsaWRlci52aWV3cG9ydC5oZWlnaHQoKSAhPT0gZ2V0Vmlld3BvcnRIZWlnaHQoKSkge1xuICAgICAgICAgIHNsaWRlci52aWV3cG9ydC5hbmltYXRlKHtoZWlnaHQ6IGdldFZpZXdwb3J0SGVpZ2h0KCl9LCBzbGlkZXIuc2V0dGluZ3MuYWRhcHRpdmVIZWlnaHRTcGVlZCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gaWYgY2Fyb3VzZWwgYW5kIG5vdCBpbmZpbml0ZSBsb29wXG4gICAgICAgIGlmICghc2xpZGVyLnNldHRpbmdzLmluZmluaXRlTG9vcCAmJiBzbGlkZXIuY2Fyb3VzZWwgJiYgc2xpZGVyLmFjdGl2ZS5sYXN0KSB7XG4gICAgICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5tb2RlID09PSAnaG9yaXpvbnRhbCcpIHtcbiAgICAgICAgICAgIC8vIGdldCB0aGUgbGFzdCBjaGlsZCBwb3NpdGlvblxuICAgICAgICAgICAgbGFzdENoaWxkID0gc2xpZGVyLmNoaWxkcmVuLmVxKHNsaWRlci5jaGlsZHJlbi5sZW5ndGggLSAxKTtcbiAgICAgICAgICAgIHBvc2l0aW9uID0gbGFzdENoaWxkLnBvc2l0aW9uKCk7XG4gICAgICAgICAgICAvLyBjYWxjdWxhdGUgdGhlIHBvc2l0aW9uIG9mIHRoZSBsYXN0IHNsaWRlXG4gICAgICAgICAgICBtb3ZlQnkgPSBzbGlkZXIudmlld3BvcnQud2lkdGgoKSAtIGxhc3RDaGlsZC5vdXRlcldpZHRoKCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIGdldCBsYXN0IHNob3dpbmcgaW5kZXggcG9zaXRpb25cbiAgICAgICAgICAgIGxhc3RTaG93aW5nSW5kZXggPSBzbGlkZXIuY2hpbGRyZW4ubGVuZ3RoIC0gc2xpZGVyLnNldHRpbmdzLm1pblNsaWRlcztcbiAgICAgICAgICAgIHBvc2l0aW9uID0gc2xpZGVyLmNoaWxkcmVuLmVxKGxhc3RTaG93aW5nSW5kZXgpLnBvc2l0aW9uKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vIGhvcml6b250YWwgY2Fyb3VzZWwsIGdvaW5nIHByZXZpb3VzIHdoaWxlIG9uIGZpcnN0IHNsaWRlIChpbmZpbml0ZUxvb3AgbW9kZSlcbiAgICAgICAgfSBlbHNlIGlmIChzbGlkZXIuY2Fyb3VzZWwgJiYgc2xpZGVyLmFjdGl2ZS5sYXN0ICYmIGRpcmVjdGlvbiA9PT0gJ3ByZXYnKSB7XG4gICAgICAgICAgLy8gZ2V0IHRoZSBsYXN0IGNoaWxkIHBvc2l0aW9uXG4gICAgICAgICAgZXEgPSBzbGlkZXIuc2V0dGluZ3MubW92ZVNsaWRlcyA9PT0gMSA/IHNsaWRlci5zZXR0aW5ncy5tYXhTbGlkZXMgLSBnZXRNb3ZlQnkoKSA6ICgoZ2V0UGFnZXJRdHkoKSAtIDEpICogZ2V0TW92ZUJ5KCkpIC0gKHNsaWRlci5jaGlsZHJlbi5sZW5ndGggLSBzbGlkZXIuc2V0dGluZ3MubWF4U2xpZGVzKTtcbiAgICAgICAgICBsYXN0Q2hpbGQgPSBlbC5jaGlsZHJlbignLmJ4LWNsb25lJykuZXEoZXEpO1xuICAgICAgICAgIHBvc2l0aW9uID0gbGFzdENoaWxkLnBvc2l0aW9uKCk7XG4gICAgICAgIC8vIGlmIGluZmluaXRlIGxvb3AgYW5kIFwiTmV4dFwiIGlzIGNsaWNrZWQgb24gdGhlIGxhc3Qgc2xpZGVcbiAgICAgICAgfSBlbHNlIGlmIChkaXJlY3Rpb24gPT09ICduZXh0JyAmJiBzbGlkZXIuYWN0aXZlLmluZGV4ID09PSAwKSB7XG4gICAgICAgICAgLy8gZ2V0IHRoZSBsYXN0IGNsb25lIHBvc2l0aW9uXG4gICAgICAgICAgcG9zaXRpb24gPSBlbC5maW5kKCc+IC5ieC1jbG9uZScpLmVxKHNsaWRlci5zZXR0aW5ncy5tYXhTbGlkZXMpLnBvc2l0aW9uKCk7XG4gICAgICAgICAgc2xpZGVyLmFjdGl2ZS5sYXN0ID0gZmFsc2U7XG4gICAgICAgIC8vIG5vcm1hbCBub24temVybyByZXF1ZXN0c1xuICAgICAgICB9IGVsc2UgaWYgKHNsaWRlSW5kZXggPj0gMCkge1xuICAgICAgICAgIC8vcGFyc2VJbnQgaXMgYXBwbGllZCB0byBhbGxvdyBmbG9hdHMgZm9yIHNsaWRlcy9wYWdlXG4gICAgICAgICAgcmVxdWVzdEVsID0gc2xpZGVJbmRleCAqIHBhcnNlSW50KGdldE1vdmVCeSgpKTtcbiAgICAgICAgICBwb3NpdGlvbiA9IHNsaWRlci5jaGlsZHJlbi5lcShyZXF1ZXN0RWwpLnBvc2l0aW9uKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvKiBJZiB0aGUgcG9zaXRpb24gZG9lc24ndCBleGlzdFxuICAgICAgICAgKiAoZS5nLiBpZiB5b3UgZGVzdHJveSB0aGUgc2xpZGVyIG9uIGEgbmV4dCBjbGljayksXG4gICAgICAgICAqIGl0IGRvZXNuJ3QgdGhyb3cgYW4gZXJyb3IuXG4gICAgICAgICAqL1xuICAgICAgICBpZiAodHlwZW9mIChwb3NpdGlvbikgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgdmFsdWUgPSBzbGlkZXIuc2V0dGluZ3MubW9kZSA9PT0gJ2hvcml6b250YWwnID8gLShwb3NpdGlvbi5sZWZ0IC0gbW92ZUJ5KSA6IC1wb3NpdGlvbi50b3A7XG4gICAgICAgICAgLy8gcGx1Z2luIHZhbHVlcyB0byBiZSBhbmltYXRlZFxuICAgICAgICAgIHNldFBvc2l0aW9uUHJvcGVydHkodmFsdWUsICdzbGlkZScsIHNsaWRlci5zZXR0aW5ncy5zcGVlZCk7XG4gICAgICAgIH1cbiAgICAgICAgc2xpZGVyLndvcmtpbmcgPSBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MuYXJpYUhpZGRlbikgeyBhcHBseUFyaWFIaWRkZW5BdHRyaWJ1dGVzKHNsaWRlci5hY3RpdmUuaW5kZXggKiBnZXRNb3ZlQnkoKSk7IH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogVHJhbnNpdGlvbnMgdG8gdGhlIG5leHQgc2xpZGUgaW4gdGhlIHNob3dcbiAgICAgKi9cbiAgICBlbC5nb1RvTmV4dFNsaWRlID0gZnVuY3Rpb24oKSB7XG4gICAgICAvLyBpZiBpbmZpbml0ZUxvb3AgaXMgZmFsc2UgYW5kIGxhc3QgcGFnZSBpcyBzaG93aW5nLCBkaXNyZWdhcmQgY2FsbFxuICAgICAgaWYgKCFzbGlkZXIuc2V0dGluZ3MuaW5maW5pdGVMb29wICYmIHNsaWRlci5hY3RpdmUubGFzdCkgeyByZXR1cm47IH1cblx0ICBpZiAoc2xpZGVyLndvcmtpbmcgPT09IHRydWUpeyByZXR1cm4gO31cbiAgICAgIHZhciBwYWdlckluZGV4ID0gcGFyc2VJbnQoc2xpZGVyLmFjdGl2ZS5pbmRleCkgKyAxO1xuICAgICAgZWwuZ29Ub1NsaWRlKHBhZ2VySW5kZXgsICduZXh0Jyk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFRyYW5zaXRpb25zIHRvIHRoZSBwcmV2IHNsaWRlIGluIHRoZSBzaG93XG4gICAgICovXG4gICAgZWwuZ29Ub1ByZXZTbGlkZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgLy8gaWYgaW5maW5pdGVMb29wIGlzIGZhbHNlIGFuZCBsYXN0IHBhZ2UgaXMgc2hvd2luZywgZGlzcmVnYXJkIGNhbGxcbiAgICAgIGlmICghc2xpZGVyLnNldHRpbmdzLmluZmluaXRlTG9vcCAmJiBzbGlkZXIuYWN0aXZlLmluZGV4ID09PSAwKSB7IHJldHVybjsgfVxuXHQgIGlmIChzbGlkZXIud29ya2luZyA9PT0gdHJ1ZSl7IHJldHVybiA7fVxuICAgICAgdmFyIHBhZ2VySW5kZXggPSBwYXJzZUludChzbGlkZXIuYWN0aXZlLmluZGV4KSAtIDE7XG4gICAgICBlbC5nb1RvU2xpZGUocGFnZXJJbmRleCwgJ3ByZXYnKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogU3RhcnRzIHRoZSBhdXRvIHNob3dcbiAgICAgKlxuICAgICAqIEBwYXJhbSBwcmV2ZW50Q29udHJvbFVwZGF0ZSAoYm9vbGVhbilcbiAgICAgKiAgLSBpZiB0cnVlLCBhdXRvIGNvbnRyb2xzIHN0YXRlIHdpbGwgbm90IGJlIHVwZGF0ZWRcbiAgICAgKi9cbiAgICBlbC5zdGFydEF1dG8gPSBmdW5jdGlvbihwcmV2ZW50Q29udHJvbFVwZGF0ZSkge1xuICAgICAgLy8gaWYgYW4gaW50ZXJ2YWwgYWxyZWFkeSBleGlzdHMsIGRpc3JlZ2FyZCBjYWxsXG4gICAgICBpZiAoc2xpZGVyLmludGVydmFsKSB7IHJldHVybjsgfVxuICAgICAgLy8gY3JlYXRlIGFuIGludGVydmFsXG4gICAgICBzbGlkZXIuaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5hdXRvRGlyZWN0aW9uID09PSAnbmV4dCcpIHtcbiAgICAgICAgICBlbC5nb1RvTmV4dFNsaWRlKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZWwuZ29Ub1ByZXZTbGlkZSgpO1xuICAgICAgICB9XG4gICAgICB9LCBzbGlkZXIuc2V0dGluZ3MucGF1c2UpO1xuXHQgIC8vYWxsYmFjayBmb3Igd2hlbiB0aGUgYXV0byByb3RhdGUgc3RhdHVzIGNoYW5nZXNcblx0ICBzbGlkZXIuc2V0dGluZ3Mub25BdXRvQ2hhbmdlLmNhbGwoZWwsIHRydWUpO1xuICAgICAgLy8gaWYgYXV0byBjb250cm9scyBhcmUgZGlzcGxheWVkIGFuZCBwcmV2ZW50Q29udHJvbFVwZGF0ZSBpcyBub3QgdHJ1ZVxuICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5hdXRvQ29udHJvbHMgJiYgcHJldmVudENvbnRyb2xVcGRhdGUgIT09IHRydWUpIHsgdXBkYXRlQXV0b0NvbnRyb2xzKCdzdG9wJyk7IH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogU3RvcHMgdGhlIGF1dG8gc2hvd1xuICAgICAqXG4gICAgICogQHBhcmFtIHByZXZlbnRDb250cm9sVXBkYXRlIChib29sZWFuKVxuICAgICAqICAtIGlmIHRydWUsIGF1dG8gY29udHJvbHMgc3RhdGUgd2lsbCBub3QgYmUgdXBkYXRlZFxuICAgICAqL1xuICAgIGVsLnN0b3BBdXRvID0gZnVuY3Rpb24ocHJldmVudENvbnRyb2xVcGRhdGUpIHtcbiAgICAgIC8vIGlmIHNsaWRlciBpcyBhdXRvIHBhdXNlZCwganVzdCBjbGVhciB0aGF0IHN0YXRlXG4gICAgICBpZiAoc2xpZGVyLmF1dG9QYXVzZWQpIHNsaWRlci5hdXRvUGF1c2VkID0gZmFsc2U7XG4gICAgICAvLyBpZiBubyBpbnRlcnZhbCBleGlzdHMsIGRpc3JlZ2FyZCBjYWxsXG4gICAgICBpZiAoIXNsaWRlci5pbnRlcnZhbCkgeyByZXR1cm47IH1cbiAgICAgIC8vIGNsZWFyIHRoZSBpbnRlcnZhbFxuICAgICAgY2xlYXJJbnRlcnZhbChzbGlkZXIuaW50ZXJ2YWwpO1xuICAgICAgc2xpZGVyLmludGVydmFsID0gbnVsbDtcblx0ICAvL2FsbGJhY2sgZm9yIHdoZW4gdGhlIGF1dG8gcm90YXRlIHN0YXR1cyBjaGFuZ2VzXG5cdCAgc2xpZGVyLnNldHRpbmdzLm9uQXV0b0NoYW5nZS5jYWxsKGVsLCBmYWxzZSk7XG4gICAgICAvLyBpZiBhdXRvIGNvbnRyb2xzIGFyZSBkaXNwbGF5ZWQgYW5kIHByZXZlbnRDb250cm9sVXBkYXRlIGlzIG5vdCB0cnVlXG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmF1dG9Db250cm9scyAmJiBwcmV2ZW50Q29udHJvbFVwZGF0ZSAhPT0gdHJ1ZSkgeyB1cGRhdGVBdXRvQ29udHJvbHMoJ3N0YXJ0Jyk7IH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBjdXJyZW50IHNsaWRlIGluZGV4ICh6ZXJvLWJhc2VkKVxuICAgICAqL1xuICAgIGVsLmdldEN1cnJlbnRTbGlkZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHNsaWRlci5hY3RpdmUuaW5kZXg7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgY3VycmVudCBzbGlkZSBlbGVtZW50XG4gICAgICovXG4gICAgZWwuZ2V0Q3VycmVudFNsaWRlRWxlbWVudCA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHNsaWRlci5jaGlsZHJlbi5lcShzbGlkZXIuYWN0aXZlLmluZGV4KTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIHNsaWRlIGVsZW1lbnRcbiAgICAgKiBAcGFyYW0gaW5kZXggKGludClcbiAgICAgKiAgLSBUaGUgaW5kZXggKHplcm8tYmFzZWQpIG9mIHRoZSBlbGVtZW50IHlvdSB3YW50IHJldHVybmVkLlxuICAgICAqL1xuICAgIGVsLmdldFNsaWRlRWxlbWVudCA9IGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgICByZXR1cm4gc2xpZGVyLmNoaWxkcmVuLmVxKGluZGV4KTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBudW1iZXIgb2Ygc2xpZGVzIGluIHNob3dcbiAgICAgKi9cbiAgICBlbC5nZXRTbGlkZUNvdW50ID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gc2xpZGVyLmNoaWxkcmVuLmxlbmd0aDtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIHNsaWRlci53b3JraW5nIHZhcmlhYmxlXG4gICAgICovXG4gICAgZWwuaXNXb3JraW5nID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gc2xpZGVyLndvcmtpbmc7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSBhbGwgZHluYW1pYyBzbGlkZXIgZWxlbWVudHNcbiAgICAgKi9cbiAgICBlbC5yZWRyYXdTbGlkZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgIC8vIHJlc2l6ZSBhbGwgY2hpbGRyZW4gaW4gcmF0aW8gdG8gbmV3IHNjcmVlbiBzaXplXG4gICAgICBzbGlkZXIuY2hpbGRyZW4uYWRkKGVsLmZpbmQoJy5ieC1jbG9uZScpKS5vdXRlcldpZHRoKGdldFNsaWRlV2lkdGgoKSk7XG4gICAgICAvLyBhZGp1c3QgdGhlIGhlaWdodFxuICAgICAgc2xpZGVyLnZpZXdwb3J0LmNzcygnaGVpZ2h0JywgZ2V0Vmlld3BvcnRIZWlnaHQoKSk7XG4gICAgICAvLyB1cGRhdGUgdGhlIHNsaWRlIHBvc2l0aW9uXG4gICAgICBpZiAoIXNsaWRlci5zZXR0aW5ncy50aWNrZXIpIHsgc2V0U2xpZGVQb3NpdGlvbigpOyB9XG4gICAgICAvLyBpZiBhY3RpdmUubGFzdCB3YXMgdHJ1ZSBiZWZvcmUgdGhlIHNjcmVlbiByZXNpemUsIHdlIHdhbnRcbiAgICAgIC8vIHRvIGtlZXAgaXQgbGFzdCBubyBtYXR0ZXIgd2hhdCBzY3JlZW4gc2l6ZSB3ZSBlbmQgb25cbiAgICAgIGlmIChzbGlkZXIuYWN0aXZlLmxhc3QpIHsgc2xpZGVyLmFjdGl2ZS5pbmRleCA9IGdldFBhZ2VyUXR5KCkgLSAxOyB9XG4gICAgICAvLyBpZiB0aGUgYWN0aXZlIGluZGV4IChwYWdlKSBubyBsb25nZXIgZXhpc3RzIGR1ZSB0byB0aGUgcmVzaXplLCBzaW1wbHkgc2V0IHRoZSBpbmRleCBhcyBsYXN0XG4gICAgICBpZiAoc2xpZGVyLmFjdGl2ZS5pbmRleCA+PSBnZXRQYWdlclF0eSgpKSB7IHNsaWRlci5hY3RpdmUubGFzdCA9IHRydWU7IH1cbiAgICAgIC8vIGlmIGEgcGFnZXIgaXMgYmVpbmcgZGlzcGxheWVkIGFuZCBhIGN1c3RvbSBwYWdlciBpcyBub3QgYmVpbmcgdXNlZCwgdXBkYXRlIGl0XG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLnBhZ2VyICYmICFzbGlkZXIuc2V0dGluZ3MucGFnZXJDdXN0b20pIHtcbiAgICAgICAgcG9wdWxhdGVQYWdlcigpO1xuICAgICAgICB1cGRhdGVQYWdlckFjdGl2ZShzbGlkZXIuYWN0aXZlLmluZGV4KTtcbiAgICAgIH1cbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MuYXJpYUhpZGRlbikgeyBhcHBseUFyaWFIaWRkZW5BdHRyaWJ1dGVzKHNsaWRlci5hY3RpdmUuaW5kZXggKiBnZXRNb3ZlQnkoKSk7IH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogRGVzdHJveSB0aGUgY3VycmVudCBpbnN0YW5jZSBvZiB0aGUgc2xpZGVyIChyZXZlcnQgZXZlcnl0aGluZyBiYWNrIHRvIG9yaWdpbmFsIHN0YXRlKVxuICAgICAqL1xuICAgIGVsLmRlc3Ryb3lTbGlkZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgIC8vIGRvbid0IGRvIGFueXRoaW5nIGlmIHNsaWRlciBoYXMgYWxyZWFkeSBiZWVuIGRlc3Ryb3llZFxuICAgICAgaWYgKCFzbGlkZXIuaW5pdGlhbGl6ZWQpIHsgcmV0dXJuOyB9XG4gICAgICBzbGlkZXIuaW5pdGlhbGl6ZWQgPSBmYWxzZTtcbiAgICAgICQoJy5ieC1jbG9uZScsIHRoaXMpLnJlbW92ZSgpO1xuICAgICAgc2xpZGVyLmNoaWxkcmVuLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICgkKHRoaXMpLmRhdGEoJ29yaWdTdHlsZScpICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAkKHRoaXMpLmF0dHIoJ3N0eWxlJywgJCh0aGlzKS5kYXRhKCdvcmlnU3R5bGUnKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgJCh0aGlzKS5yZW1vdmVBdHRyKCdzdHlsZScpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGlmICgkKHRoaXMpLmRhdGEoJ29yaWdTdHlsZScpICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhpcy5hdHRyKCdzdHlsZScsICQodGhpcykuZGF0YSgnb3JpZ1N0eWxlJykpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgJCh0aGlzKS5yZW1vdmVBdHRyKCdzdHlsZScpO1xuICAgICAgfVxuICAgICAgJCh0aGlzKS51bndyYXAoKS51bndyYXAoKTtcbiAgICAgIGlmIChzbGlkZXIuY29udHJvbHMuZWwpIHsgc2xpZGVyLmNvbnRyb2xzLmVsLnJlbW92ZSgpOyB9XG4gICAgICBpZiAoc2xpZGVyLmNvbnRyb2xzLm5leHQpIHsgc2xpZGVyLmNvbnRyb2xzLm5leHQucmVtb3ZlKCk7IH1cbiAgICAgIGlmIChzbGlkZXIuY29udHJvbHMucHJldikgeyBzbGlkZXIuY29udHJvbHMucHJldi5yZW1vdmUoKTsgfVxuICAgICAgaWYgKHNsaWRlci5wYWdlckVsICYmIHNsaWRlci5zZXR0aW5ncy5jb250cm9scyAmJiAhc2xpZGVyLnNldHRpbmdzLnBhZ2VyQ3VzdG9tKSB7IHNsaWRlci5wYWdlckVsLnJlbW92ZSgpOyB9XG4gICAgICAkKCcuYngtY2FwdGlvbicsIHRoaXMpLnJlbW92ZSgpO1xuICAgICAgaWYgKHNsaWRlci5jb250cm9scy5hdXRvRWwpIHsgc2xpZGVyLmNvbnRyb2xzLmF1dG9FbC5yZW1vdmUoKTsgfVxuICAgICAgY2xlYXJJbnRlcnZhbChzbGlkZXIuaW50ZXJ2YWwpO1xuICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5yZXNwb25zaXZlKSB7ICQod2luZG93KS5vZmYoJ3Jlc2l6ZScsIHJlc2l6ZVdpbmRvdyk7IH1cbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3Mua2V5Ym9hcmRFbmFibGVkKSB7ICQoZG9jdW1lbnQpLm9mZigna2V5ZG93bicsIGtleVByZXNzKTsgfVxuICAgICAgLy9yZW1vdmUgc2VsZiByZWZlcmVuY2UgaW4gZGF0YVxuICAgICAgJCh0aGlzKS5yZW1vdmVEYXRhKCdieFNsaWRlcicpO1xuXHQgIC8vIHJlbW92ZSBnbG9iYWwgd2luZG93IGhhbmRsZXJzXG5cdCAgJCh3aW5kb3cpLm9mZignYmx1cicsIHdpbmRvd0JsdXJIYW5kbGVyKS5vZmYoJ2ZvY3VzJywgd2luZG93Rm9jdXNIYW5kbGVyKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUmVsb2FkIHRoZSBzbGlkZXIgKHJldmVydCBhbGwgRE9NIGNoYW5nZXMsIGFuZCByZS1pbml0aWFsaXplKVxuICAgICAqL1xuICAgIGVsLnJlbG9hZFNsaWRlciA9IGZ1bmN0aW9uKHNldHRpbmdzKSB7XG4gICAgICBpZiAoc2V0dGluZ3MgIT09IHVuZGVmaW5lZCkgeyBvcHRpb25zID0gc2V0dGluZ3M7IH1cbiAgICAgIGVsLmRlc3Ryb3lTbGlkZXIoKTtcbiAgICAgIGluaXQoKTtcbiAgICAgIC8vc3RvcmUgcmVmZXJlbmNlIHRvIHNlbGYgaW4gb3JkZXIgdG8gYWNjZXNzIHB1YmxpYyBmdW5jdGlvbnMgbGF0ZXJcbiAgICAgICQoZWwpLmRhdGEoJ2J4U2xpZGVyJywgdGhpcyk7XG4gICAgfTtcblxuICAgIGluaXQoKTtcblxuICAgICQoZWwpLmRhdGEoJ2J4U2xpZGVyJywgdGhpcyk7XG5cbiAgICAvLyByZXR1cm5zIHRoZSBjdXJyZW50IGpRdWVyeSBvYmplY3RcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxufSkoalF1ZXJ5KTtcbiIsIlwidXNlIHN0cmljdFwiO1xyXG5cclxuICAoZnVuY3Rpb24oKSB7XHJcbiAgY29uc3QgY2xvc2VPdGhlcnMgPSBsaXN0ID0+IHtcclxuICBjb25zdCBwYW5lbCA9IGxpc3QuZmluZChcIi5jb21tYW5kX19wcm9maWxlLXBhbmVsXCIpO1xyXG4gIGNvbnN0IG5hbWUgPSBsaXN0LmZpbmQoXCIuY29tbWFuZF9fcHJvZmlsZS1uYW1lXCIpO1xyXG4gXHJcbiAgbmFtZS5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcclxuICBwYW5lbC5oZWlnaHQoMCk7XHJcbn1cclxuXHJcbmNvbnN0IG9wZW5OZXcgPSBibG9jayA9PiB7XHJcbiBjb25zdCBwcm9maWxlID0gYmxvY2suY2xvc2VzdChcIi5jb21tYW5kX19wcm9maWxlXCIpO1xyXG4gY29uc3QgcGFuZWwgPSBwcm9maWxlLmZpbmQoXCIuY29tbWFuZF9fcHJvZmlsZS1wYW5lbFwiKTtcclxuIGNvbnN0IHBhbmVsQmxvY2sgPSBwcm9maWxlLmZpbmQoXCIuY29tbWFuZF9fcHJvZmlsZS1ibG9ja1wiKTtcclxuIGNvbnN0IHNjcm9sbEhlaWdodCA9IHBhbmVsQmxvY2suaGVpZ2h0KCk7XHJcblxyXG4gYmxvY2suYWRkQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiBwYW5lbC5oZWlnaHQoc2Nyb2xsSGVpZ2h0KTtcclxufVxyXG5cclxuJChcIi5jb21tYW5kX19wcm9maWxlLW5hbWVcIikuY2xpY2soKGUpID0+IHsgICBcclxuICAgY29uc3QgJHRoaXMgPSAkKGUuY3VycmVudFRhcmdldCk7XHJcbiAgIGNvbnN0IGxpc3QgPSAkdGhpcy5jbG9zZXN0KFwiLmNvbW1hbmRfX2xpc3RcIik7IFxyXG5cclxuICAgaWYgKCR0aGlzLmhhc0NsYXNzKFwiYWN0aXZlXCIpKSB7XHJcbiAgICBjbG9zZU90aGVycyhsaXN0KTtcclxuICAgfSBlbHNlIHtcclxuICAgIGNsb3NlT3RoZXJzKGxpc3QpO1xyXG4gICAgb3Blbk5ldygkdGhpcyk7XHJcbiAgIH1cclxuICB9KTtcclxufSkoKSIsIihmdW5jdGlvbigpIHtcclxuY29uc3QgbWVzdXJlV2lkdGggPSBpdGVtID0+IHtcclxuICBsZXQgcmVxSXRlbVdpZHRoID0gMDtcclxuICBjb25zdCBzY3JlZW5XaWR0aCA9ICQod2luZG93KS53aWR0aCgpO1xyXG4gIGNvbnN0IGNvbnRhaW5lciA9IGl0ZW0uY2xvc2VzdChcIi5hc3NvcnRfX2xpc3RcIik7XHJcbiAgY29uc3QgdGl0bGVzQmxvY2tzID0gY29udGFpbmVyLmZpbmQoXCIuYXNzb3J0X190cmlnZ2VyXCIpO1xyXG4gIGNvbnN0IHRpdGxlc1dpZHRoID0gdGl0bGVzQmxvY2tzLndpZHRoKCkgKiB0aXRsZXNCbG9ja3MubGVuZ3RoO1xyXG5cclxuICBjb25zdCB0ZXh0Q29udGFpbmVyID0gaXRlbS5maW5kKFwiLmFzc29ydF9fY29udGVudFwiKTtcclxuICBjb25zdCBwYWRkaW5nTGVmdCA9IHBhcnNlSW50KHRleHRDb250YWluZXIuY3NzKFwicGFkZGluZy1sZWZ0XCIpKTtcclxuICBjb25zdCBwYWRkaW5nUmlnaHQgPSBwYXJzZUludCh0ZXh0Q29udGFpbmVyLmNzcyhcInBhZGRpbmctcmlnaHRcIikpO1xyXG5cclxuICBjb25zdCBpc01vYmlsZSA9IHdpbmRvdy5tYXRjaE1lZGlhKFwiKG1heC13aWR0aDogNzY4cHgpXCIpLm1hdGNoZXM7XHJcblxyXG4gIGlmIChpc01vYmlsZSkge1xyXG4gICAgcmVxSXRlbVdpZHRoID0gc2NyZWVuV2lkdGggLSB0aXRsZXNXaWR0aDtcclxuICB9IGVsc2Uge1xyXG4gIHJlcUl0ZW1XaWR0aCA9IDUwMDtcclxuICB9XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBjb250YWluZXI6IHJlcUl0ZW1XaWR0aCxcclxuICAgIHRleHRDb250YWluZXI6IHJlcUl0ZW1XaWR0aCAtIHBhZGRpbmdMZWZ0IC0gcGFkZGluZ1JpZ2h0XHJcbiAgfVxyXG59O1xyXG5cclxuY29uc3QgY2xvc2VFdmVyeUl0ZW1Db250YWluZXIgPSBjb250YWluZXIgPT4ge1xyXG4gIGNvbnN0IGl0ZW0gPSBjb250YWluZXIuZmluZChcIi5hc3NvcnRfX2l0ZW1cIik7XHJcbiAgY29uc3QgY29udGVudCA9IGNvbnRhaW5lci5maW5kKFwiLmFzc29ydF9fd3JhcFwiKTtcclxuXHJcbiAgaXRlbS5yZW1vdmVDbGFzcyhcImFzc29ydC1hY3RpdmVcIik7XHJcbiAgY29udGVudC53aWR0aCgwKTtcclxufVxyXG5cclxuY29uc3Qgb3Blbkl0ZW0gPSAoaXRlbSkgPT4ge1xyXG4gIGNvbnN0IGhpZGRlbkNvbnRlbnQgPSBpdGVtLmZpbmQoXCIuYXNzb3J0X193cmFwXCIpO1xyXG4gIGNvbnN0IHJlcVdpZHRoID0gbWVzdXJlV2lkdGgoaXRlbSk7XHJcbiAgY29uc3QgdGV4dEJsb2NrID0gaXRlbS5maW5kKFwiLmFzc29ydF9fY29udGVudFwiKTtcclxuXHJcbiAgaXRlbS5hZGRDbGFzcyhcImFzc29ydC1hY3RpdmVcIik7XHJcbiAgaGlkZGVuQ29udGVudC53aWR0aChyZXFXaWR0aC5jb250YWluZXIpO1xyXG4gIHRleHRCbG9jay53aWR0aChyZXFXaWR0aC50ZXh0Q29udGFpbmVyKTtcclxufVxyXG5cclxuJChcIi5hc3NvcnRfX3RyaWdnZXJcIikub24gKFwiY2xpY2tcIiwgZSA9PiB7XHJcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICBjb25zdCAkdGhpcyA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcclxuICBjb25zdCBpdGVtID0gJHRoaXMuY2xvc2VzdChcIi5hc3NvcnRfX2l0ZW1cIik7XHJcbiAgY29uc3QgaXRlbU9wZW5lZCA9IGl0ZW0uaGFzQ2xhc3MoXCJhc3NvcnQtYWN0aXZlXCIpO1xyXG4gIGNvbnN0IGNvbnRhaW5lciA9ICR0aGlzLmNsb3Nlc3QoXCIuYXNzb3J0X19saXN0XCIpO1xyXG5cclxuICBpZiAoaXRlbU9wZW5lZCkge1xyXG4gICAgY2xvc2VFdmVyeUl0ZW1Db250YWluZXIoY29udGFpbmVyKVxyXG4gIH0gZWxzZSB7XHJcbiAgICBjbG9zZUV2ZXJ5SXRlbUNvbnRhaW5lcihjb250YWluZXIpXHJcbiAgICBvcGVuSXRlbShpdGVtKTtcclxuICB9XHJcbn0pO1xyXG5cclxuJChcIi5hc3NvcnRfX2Nsb3NlXCIpLm9uKFwiY2xpY2tcIiwgZSA9PiB7XHJcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICBjbG9zZUV2ZXJ5SXRlbUNvbnRhaW5lcigkKCcuYXNzb3J0X19saXN0JykpO1xyXG59KVxyXG59KSgpIiwiKGZ1bmN0aW9uKCkge1xyXG5sZXQgbXlNYXA7XHJcblxyXG5jb25zdCBpbml0ID0gKCkgPT4ge1xyXG5cclxuICBteU1hcCA9IG5ldyB5bWFwcy5NYXAoXCJtYXBcIiwge1xyXG4gICAgY2VudGVyOiBbNTUuNzQ5NTM2LCAzNy42MjA4NTddLFxyXG4gICAgem9vbTogMTMuNSxcclxuICAgIGNvbnRyb2xzOiBbXVxyXG4gIH0pO1xyXG5cclxuICBjb25zdCBjb29yZHMgPSBbXHJcbiAgWzU1Ljc1NjgzMiwgMzcuNTg2MjAzXSxcclxuICBbNTUuNzU3NDI1LCAzNy42MjcwNTldLFxyXG4gIFs1NS43NDQ3OTksIDM3LjU4MTYyMl0sXHJcbiAgWzU1Ljc0OTUzMiwgMzcuNjA3OTQyXSxcclxuICBdO1xyXG4gIGNvbnN0IG15Q29sbGVjdGlvbiA9IG5ldyB5bWFwcy5HZW9PYmplY3RDb2xsZWN0aW9uKHt9LCB7XHJcbiAgICBkcmFnZ2FibGU6IGZhbHNlLCBcclxuICAgIGljb25MYXlvdXQ6ICdkZWZhdWx0I2ltYWdlJyxcclxuICAgIGljb25JbWFnZUhyZWY6IFwiLi4vaW1nL2ljb25zL21hcmtlci5zdmdcIixcclxuICAgIGljb25JbWFnZVNpemU6IFs0Niw1N10sXHJcbiAgICBpY29uSW1hZ2VPZmZzZXQ6IFstMzUsIC01Ml1cclxuICB9KTtcclxuXHJcbiAgY29vcmRzLmZvckVhY2goY29vcmQgPT4ge1xyXG4gICAgbXlDb2xsZWN0aW9uLmFkZChuZXcgeW1hcHMuUGxhY2VtYXJrIChjb29yZCkpO1xyXG4gIH0pO1xyXG5cclxuICBteU1hcC5nZW9PYmplY3RzLmFkZChteUNvbGxlY3Rpb24pO1xyXG5cclxuICBteU1hcC5iZWhhdmlvcnMuZGlzYWJsZSgnc2Nyb2xsWm9vbScpO1xyXG59XHJcblxyXG4gICB5bWFwcy5yZWFkeShpbml0KTtcclxufSkoKSIsIihmdW5jdGlvbigpIHtcclxuY29uc3QgYnVyZ2VyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5oYW1idXJnZXJcIik7XHJcbmNvbnN0IG1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmhhbWJ1cmdlcl9fbWVudVwiKTtcclxuY29uc3QgY2xvc2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNsb3NlXCIpO1xyXG5cclxuYnVyZ2VyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xyXG4gIG1lbnUuY2xhc3NMaXN0LmFkZCgnbWVudV93aW5kb3cnKTtcclxufSk7XHJcblxyXG5tZW51LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcclxuICBpZiAoIWUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbWVudV9faXRlbScpIHx8IGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnY2xvc2UnKSkge1xyXG4gICAgbWVudS5jbGFzc0xpc3QucmVtb3ZlKCdtZW51X3dpbmRvdycpO1xyXG4gIH1cclxuICBcclxuICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtZW51X19pdGVtJykpIHtcclxuICAgIG1lbnUuY2xhc3NMaXN0LnJlbW92ZSgnbWVudV93aW5kb3cnKTtcclxuICB9XHJcbiAgXHJcbn0pO1xyXG59KSgpIiwiKGZ1bmN0aW9uKCkge1xyXG5jb25zdCB2YWxpZGF0ZUZpZWxkcyA9IChmb3JtLCBmaWVsZHNBcnJheSkgPT4ge1xyXG5cclxuICBmaWVsZHNBcnJheS5mb3JFYWNoKChmaWVsZCkgPT4ge1xyXG4gICAgZmllbGQucmVtb3ZlQ2xhc3MoXCJpbnB1dF9fZXJyb3JcIik7XHJcbiAgICBpZiAoZmllbGQudmFsKCkudHJpbSgpID09IFwiXCIpIHtcclxuICAgICAgZmllbGQuYWRkQ2xhc3MoXCJpbnB1dF9fZXJyb3JcIik7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIGNvbnN0IGVycm9yRmllbGRzID0gZm9ybS5maW5kKFwiLmlucHV0X19lcnJvclwiKTtcclxuXHJcbiAgcmV0dXJuIGVycm9yRmllbGRzLmxlbmd0aCA9PTA7XHJcbn1cclxuXHJcbiQoXCIuZm9ybVwiKS5zdWJtaXQoKGUpID0+IHtcclxuICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gIGNvbnN0IGZvcm0gPSAkKGUuY3VycmVudFRhcmdldCk7XHJcbiAgY29uc3QgbmFtZSA9IGZvcm0uZmluZChcIltuYW1lPSduYW1lJ11cIik7XHJcbiAgY29uc3QgcGhvbmUgPSBmb3JtLmZpbmQoXCJbbmFtZT0ncGhvbmUnXVwiKTtcclxuICBjb25zdCBjb21tZW50ID0gZm9ybS5maW5kKFwiW25hbWU9J2NvbW1lbnQnXVwiKTtcclxuICBjb25zdCB0byA9ICBmb3JtLmZpbmQoXCJbbmFtZT0ndG8nXVwiKTtcclxuXHJcbiAgY29uc3QgbW9kYWwgPSAkKFwiI21vZGFsXCIpO1xyXG4gIGNvbnN0IGNvbnRlbnQgPSBtb2RhbC5maW5kKFwiLm1vZGFsX19jb250ZW50XCIpO1xyXG5cclxuICBtb2RhbC5yZW1vdmVDbGFzcyhcImVycm9yLW1vZGFsXCIpO1xyXG5cclxuICBjb25zdCBpc1ZhbGlkID0gdmFsaWRhdGVGaWVsZHMoZm9ybSwgW25hbWUsIHBob25lLCBjb21tZW50LCB0b10pO1xyXG5cclxuICBpZiAoaXNWYWxpZCkge1xyXG4gICAgY29uc3QgcmVxdWVzdCA9ICQuYWpheCh7XHJcbiAgICAgIHVybDogXCJodHRwczovL3dlYmRldi1hcGkubG9mdHNjaG9vbC5jb20vc2VuZG1haWxcIixcclxuICAgICAgbWV0aG9kOiBcInBvc3RcIixcclxuICAgICAgZGF0YToge1xyXG4gICAgICAgIG5hbWU6IG5hbWUudmFsKCksXHJcbiAgICAgICAgcGhvbmU6IHBob25lLnZhbCgpLFxyXG4gICAgICAgIGNvbW1lbnQ6IGNvbW1lbnQudmFsKCksXHJcbiAgICAgICAgdG86IHRvLnZhbCgpLFxyXG4gICAgICB9LFxyXG4gICAgfSk7XHJcbiAgICByZXF1ZXN0LmRvbmUoZGF0YSA9PiB7XHJcbiAgICAgIGNvbnRlbnQudGV4dChkYXRhLm1lc3NhZ2UpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcmVxdWVzdC5mYWlsKGRhdGEgPT4ge1xyXG4gICAgICBjb25zdCBtZXNzYWdlID0gZGF0YS5yZXNwb25zZUpTT04ubWVzc2FnZTtcclxuICAgICAgY29udGVudC50ZXh0KG1lc3NhZ2UpO1xyXG4gICAgICBtb2RhbC5hZGRDbGFzcyhcImVycm9yLW1vZGFsXCIpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcmVxdWVzdC5hbHdheXMoKCkgPT4ge1xyXG4gICAgICAkLmZhbmN5Ym94Lm9wZW4oe1xyXG4gICAgICAgIHNyYzogXCIjbW9kYWxcIixcclxuICAgICAgICB0eXBlOiBcImlubGluZVwiLFxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG4kKFwiLmFwcC1zdWJtaXQtYnRuXCIpLmNsaWNrKGUgPT4ge1xyXG4gIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgJC5mYW5jeWJveC5jbG9zZSgpO1xyXG59KTtcclxufSkoKSIsIihmdW5jdGlvbigpIHtcclxuY29uc3Qgc2VjdGlvbnMgPSAkKFwic2VjdGlvblwiKTtcclxuY29uc3QgZGlzcGxheSA9ICQoXCIubWFpbmNvbnRlbnRcIik7XHJcbmNvbnN0IHNpZGVNZW51ID0kKFwiLmZpeGVkLW1lbnVfX2xpbmtcIik7XHJcbmNvbnN0IG1lbnVJdGVtcyA9IHNpZGVNZW51LmZpbmQoXCIuZml4ZWQtbWVudV9fbGlua1wiKTtcclxuXHJcbmNvbnN0IG1vYmlsZURldGVjdCA9IG5ldyBNb2JpbGVEZXRlY3Qod2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQpO1xyXG5jb25zdCBpc01vYmlsZSA9IG1vYmlsZURldGVjdC5tb2JpbGUoKTtcclxuXHJcbmxldCBpblNjcm9sbCA9IGZhbHNlO1xyXG5cclxuc2VjdGlvbnMuZmlyc3QoKS5hZGRDbGFzcyhcInNlY3Rpb24tYWN0aXZlXCIpO1xyXG5cclxuY29uc3QgY291bnRTZWN0aW9uUG9zaXRpb24gPSAoc2VjdGlvbkVxKSA9PiB7XHJcbiAgY29uc3QgcG9zaXRpb24gPSBzZWN0aW9uRXEgKiAtMTAwO1xyXG4gIGlmIChwb3NpdGlvbiA+IDApIHtcclxuICAgIHJldHVybiAwO1xyXG4gIH1cclxuICByZXR1cm4gc2VjdGlvbkVxICogLTEwMDtcclxufTtcclxuXHJcbmNvbnN0IGNoYW5nZU1lbnVUaGVtZUZvclNlY3Rpb24gPSAoc2VjdGlvbkVxKSA9PiB7XHJcbiAgY29uc3QgY3VycmVudFNlY3Rpb24gPSBzZWN0aW9ucy5lcShzZWN0aW9uRXEpO1xyXG4gIGNvbnN0IG1lbnVUaGVtZSA9IGN1cnJlbnRTZWN0aW9uLmF0dHIoXCJkYXRhLXRoZW1lXCIpO1xyXG4gIGNvbnN0IGFjdGl2ZUNsYXNzID0gXCJmaXhlZC1ibGFja1wiO1xyXG4gIFxyXG4gICAgaWYgKG1lbnVUaGVtZSA9PSBcImJsYWNrXCIpIHtcclxuICAgICAgc2lkZU1lbnUuYWRkQ2xhc3MoYWN0aXZlQ2xhc3MpO1xyXG4gICAgfWVsc2Uge1xyXG4gICAgICBzaWRlTWVudS5yZW1vdmVDbGFzcyhhY3RpdmVDbGFzcyk7XHJcbiAgICB9XHJcbn07XHJcblxyXG5jb25zdCByZXNldEFjdGl2ZUNsYXNzRm9ySXRlbSA9IChpdGVtcywgaXRlbUVxLCBhY3RpdmVDbGFzcykgPT4ge1xyXG4gIGl0ZW1zLmVxKGl0ZW1FcSkuYWRkQ2xhc3MoYWN0aXZlQ2xhc3MpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoYWN0aXZlQ2xhc3MpO1xyXG59XHJcblxyXG5jb25zdCBwZXJmb3JtVHJhbnNpdGlvbiA9IHNlY3Rpb25FcSA9PiB7XHJcbiBcclxuICBpZiAoc2VjdGlvbkVxIDwgMCkge1xyXG4gICAgc2VjdGlvbkVxID0gMFxyXG4gIH1cclxuXHJcbiAgXHJcblxyXG4gIGlmIChpblNjcm9sbCA9PSBmYWxzZSkge1xyXG4gICAgaW5TY3JvbGwgPSB0cnVlO1xyXG5cclxuICAgIGNvbnN0IHBvc2l0aW9uID0gY291bnRTZWN0aW9uUG9zaXRpb24oc2VjdGlvbkVxKTtcclxuXHJcbiAgICBjaGFuZ2VNZW51VGhlbWVGb3JTZWN0aW9uKHNlY3Rpb25FcSk7XHJcblxyXG4gICAgZGlzcGxheS5jc3Moe1xyXG4gICAgICB0cmFuc2Zvcm06IGB0cmFuc2xhdGVZKCR7cG9zaXRpb259JSlgXHJcbiAgICB9KTtcclxuICAgIFxyXG5cclxuICAgIHJlc2V0QWN0aXZlQ2xhc3NGb3JJdGVtKHNlY3Rpb25zLCBzZWN0aW9uRXEsIFwic2VjdGlvbi1hY3RpdmVcIik7XHJcblxyXG4gICAgXHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgIGluU2Nyb2xsID0gZmFsc2U7XHJcblxyXG4gICAgcmVzZXRBY3RpdmVDbGFzc0Zvckl0ZW0obWVudUl0ZW1zLCBzZWN0aW9uRXEsIFwiZml4ZWQtbWVudV9fbGluay0tYWN0aXZlXCIpO1xyXG4gICAgfSwgMTMwMCk7XHJcbiAgfVxyXG59O1xyXG5cclxuY29uc3Qgc2Nyb2xsVmlld3BvcnQgPSBkaXJlY3Rpb24gPT4ge1xyXG4gIGNvbnN0IGFjdGl2ZVNlY3Rpb24gPSBzZWN0aW9ucy5maWx0ZXIoXCIuc2VjdGlvbi1hY3RpdmVcIik7XHJcbiAgY29uc3QgbmV4dFNlY3Rpb24gPSBhY3RpdmVTZWN0aW9uLm5leHQoKTtcclxuICBjb25zdCBwcmV2U2VjdGlvbiA9IGFjdGl2ZVNlY3Rpb24ucHJldigpO1xyXG5cclxuXHJcblxyXG4gIGlmIChkaXJlY3Rpb24gPT0gXCJuZXh0XCIgJiYgbmV4dFNlY3Rpb24ubGVuZ3RoKSB7XHJcbiAgICBwZXJmb3JtVHJhbnNpdGlvbihuZXh0U2VjdGlvbi5pbmRleCgpKVxyXG4gIH1cclxuICBpZiAoZGlyZWN0aW9uID09IFwicHJldlwiICYmIHByZXZTZWN0aW9uLmxlbmd0aCkge1xyXG4gICAgcGVyZm9ybVRyYW5zaXRpb24ocHJldlNlY3Rpb24uaW5kZXgoKSlcclxuICB9XHJcbn1cclxuXHJcbiQod2luZG93KS5vbihcIndoZWVsXCIsIGUgPT4ge1xyXG4gIGNvbnN0IGRlbHRhWSA9IGUub3JpZ2luYWxFdmVudC5kZWx0YVk7XHJcblxyXG4gIGlmIChkZWx0YVkgPiAwKSB7XHJcbiAgIHNjcm9sbFZpZXdwb3J0KFwibmV4dFwiKTtcclxuICB9XHJcbiAgaWYgKGRlbHRhWSA8IDApIHtcclxuc2Nyb2xsVmlld3BvcnQoXCJwcmV2XCIpO1xyXG4gIH1cclxufSk7XHJcblxyXG4kKHdpbmRvdykub24oXCJrZXlkb3duXCIsIGUgPT4ge1xyXG5cclxuICBjb25zdCB0YWdOYW1lID0gZS50YXJnZXQudGFnTmFtZS50b0xvd2VyQ2FzZSgpO1xyXG5cclxuICBpZiAodGFnTmFtZSAhPSBcImlucHV0XCIgJiYgdGFnTmFtZSAhPSBcInRleHRhcmVhXCIpIHtcclxuICAgIHN3aXRjaCAoZS5rZXlDb2RlKSB7XHJcbiAgICAgIGNhc2UgMzg6XHJcbiAgICAgIHNjcm9sbFZpZXdwb3J0KFwicHJldlwiKTtcclxuICAgICAgYnJlYWs7XHJcbiAgXHJcbiAgICAgIGNhc2UgNDA6IFxyXG4gICAgICBzY3JvbGxWaWV3cG9ydChcIm5leHRcIik7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG4gIH1cclxufSk7XHJcblxyXG4kKFwiLndyYXBwZXJcIikub24oXCJ0b3VjaG1vdmVcIiwgZSA9PiBlLnByZXZlbnREZWZhdWx0KCkpO1xyXG5cclxuJChcIltkYXRhLXRvXVwiKS5jbGljayhlID0+IHtcclxuICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gIGNvbnN0ICR0aGlzID0gJChlLmN1cnJlbnRUYXJnZXQpO1xyXG4gIGNvbnN0IHRhcmdldCA9ICR0aGlzLmF0dHIoXCJkYXRhLXRvXCIpO1xyXG4gIGNvbnN0IHJlcVNlY3Rpb24gPSAkKGBbZGF0YS1pZD0ke3RhcmdldH1dYCk7XHJcblxyXG4gIHBlcmZvcm1UcmFuc2l0aW9uKHJlcVNlY3Rpb24uaW5kZXgoKSk7XHJcbn0pO1xyXG5cclxuIGlmIChpc01vYmlsZSkge1xyXG4gICQoXCJib2R5XCIpLnN3aXBlKHtcclxuICAgIHN3aXBlOiBmdW5jdGlvbihldmVudCwgZGlyZWN0aW9uKSB7XHJcbiAgICAgIGNvbnN0IHNjcm9sbGVyID0gdmlld3BvcnRTY3JvbGxlcigpO1xyXG4gICAgICBsZXQgc2Nyb2xsRGlyZWN0aW9uID0gXCJcIjtcclxuICBcclxuICAgICAgaWYgKGRpcmVjdGlvbiA9PSBcInVwXCIpIHNjcm9sbERpcmVjdGlvbiA9IFwibmV4dFwiO1xyXG4gICAgICBpZiAoZGlyZWN0aW9uID09IFwiZG93blwiKSBzY3JvbGxEaXJlY3Rpb24gPSBcInByZXZcIjtcclxuICBcclxuICAgICAgc2Nyb2xsZXJbc2Nyb2xsRGlyZWN0aW9uXSgpO1xyXG4gICAgfSxcclxuICB9KTtcclxuIH1cclxufSkoKVxyXG4iLCIvLyAoZnVuY3Rpb24oKSB7XHJcbi8vIGxldCAgcGxheWVyO1xyXG4vLyBjb25zdCBwbGF5ZXJDb250YWluZXIgPSAkKFwiLnBsYXllclwiKTtcclxuXHJcbi8vIGxldCBldmVudHNJbml0ID0gKCkgPT4ge1xyXG4vLyAgICQoXCIucGxheWVyX19zdGFydFwiKS5jbGljayhlID0+IHtcclxuLy8gICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICBcclxuLy8gICAgIGlmIChwbGF5ZXJDb250YWluZXIuaGFzQ2xhc3MoXCJwYXVzZWRcIikpIHtcclxuLy8gICAgICAgcGxheWVyLnBhdXNlVmlkZW8oKTtcclxuLy8gICAgIH0gZWxzZSB7XHJcbi8vICAgICAgIHBsYXllci5wbGF5VmlkZW8oKTtcclxuLy8gICAgIH1cclxuLy8gICB9KTtcclxuIFxyXG5cclxuLy8gICAkKFwiLnBsYXllcl9fcGxheWJhY2tcIikuY2xpY2soZSA9PiB7XHJcbi8vICAgICBjb25zdCBiYXIgPSAkKGUuY3VycmVudFRhcmdldCk7XHJcbi8vICAgICBjb25zdCBjbGlja2VkUG9zaXRpb24gPSBlLm9yaWdpbmFsRXZlbnQubGF5ZXJYO1xyXG4vLyAgICAgY29uc3QgbmV3QnV0dG9uUG9zaXRpb25QZXJjZW50ID0gKGNsaWNrZWRQb3NpdGlvbiAvIGJhci53aWR0aCgpKSAqIDEwMDtcclxuLy8gICAgIGNvbnN0IG5ld1BsYXliYWNrUG9zaXRpb25TZWMgPVxyXG4vLyAgICAgKHBsYXllci5nZXREdXJhdGlvbigpIC8gMTAwKSAqIG5ld0J1dHRvblBvc2l0aW9uUGVyY2VudDtcclxuIFxyXG4vLyAgICAgJChcIi5wbGF5ZXJfX3BsYXliYWNrLWJ1dHRvblwiKS5jc3Moe1xyXG4vLyAgICAgICBsZWZ0OiBgJHtuZXdCdXR0b25Qb3NpdGlvblBlcmNlbnR9JWBcclxuLy8gICAgIH0pO1xyXG4vLyAgICAgICBwbGF5ZXIuc2Vla1RvKG5ld1BsYXliYWNrUG9zaXRpb25TZWMpO1xyXG4vLyAgICB9KTtcclxuLy8gfTtcclxuXHJcbi8vIGNvbnN0IGZvcm1hdFRpbWUgPSB0aW1lU2VjID0+IHtcclxuLy8gICBjb25zdCByb3VuZFRpbWUgPSBNYXRoLnJvdW5kKHRpbWVTZWMpO1xyXG4gIFxyXG4vLyAgIGNvbnN0IG1pbnV0ZXMgPSBhZGRaZXJvKE1hdGguZmxvb3Iocm91bmRUaW1lIC8gNjApKTtcclxuLy8gICBjb25zdCBzZWNvbmRzID0gYWRkWmVybyhyb3VuZFRpbWUgLSBtaW51dGVzICogNjApO1xyXG4gIFxyXG4vLyAgIGZ1bmN0aW9uIGFkZFplcm8obnVtKSB7XHJcbi8vICAgICByZXR1cm4gbnVtIDwgMTAgPyBgMCR7bnVtfWAgOiBudW07XHJcbi8vICAgfVxyXG4gIFxyXG4vLyAgIHJldHVybiBgJHttaW51dGVzfSA6ICR7c2Vjb25kc31gO1xyXG4vLyAgfTtcclxuXHJcbi8vICBjb25zdCBvblBsYXllclJlYWR5ID0gKCkgPT4ge1xyXG4vLyAgIGxldCBpbnRlcnZhbDtcclxuLy8gICBjb25zdCBkdXJhdGlvblNlYyA9IHBsYXllci5nZXREdXJhdGlvbigpO1xyXG4gIFxyXG4vLyAgICQoXCIucGxheWVyX19kdXJhdGlvbi1lc3RpbWF0ZVwiKS50ZXh0KGZvcm1hdFRpbWUoZHVyYXRpb25TZWMpKTtcclxuICBcclxuLy8gICBpZiAodHlwZW9mIGludGVydmFsICE9PSBcInVuZGVmaW5lZFwiKSB7XHJcbi8vICAgICBjbGVhckludGVydmFsKGludGVydmFsKTtcclxuLy8gICB9XHJcbiAgXHJcbi8vICAgaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XHJcbi8vICAgICBjb25zdCBjb21wbGV0ZWRTZWMgPSBwbGF5ZXIuZ2V0Q3VycmVudFRpbWUoKTtcclxuLy8gICAgIGNvbnN0IGNvbXBsZXRlZFBlcmNlbnQgPSAoY29tcGxldGVkU2VjIC8gZHVyYXRpb25TZWMpICogMTAwO1xyXG5cclxuLy8gICAgICQoXCIucGxheWVyX19wbGF5YmFjay1idXR0b25cIikuY3NzKHtcclxuLy8gICAgICAgbGVmdDogYCR7Y29tcGxldGVkUGVyY2VudH0lYFxyXG4vLyAgICAgfSk7XHJcbiAgXHJcbi8vICAgICAkKFwiLnBsYXllcl9fZHVyYXRpb24tY29tcGxldGVkXCIpLnRleHQoZm9ybWF0VGltZShjb21wbGV0ZWRTZWMpKTtcclxuLy8gICB9LCAxMDAwKTtcclxuLy8gIH07XHJcblxyXG4vLyAgY29uc3Qgb25QbGF5ZXJTdGF0ZUNoYW5nZSA9IGV2ZW50ID0+IHtcclxuIFxyXG4vLyAgIHN3aXRjaCAoZXZlbnQuZGF0YSkge1xyXG4vLyAgICAgY2FzZSAxOlxyXG4vLyAgICAgICBwbGF5ZXJDb250YWluZXIuYWRkQ2xhc3MoXCJhY3RpdmVcIik7XHJcbi8vICAgICAgIHBsYXllckNvbnRhaW5lci5hZGRDbGFzcyhcInBhdXNlZFwiKTtcclxuLy8gICAgICAgYnJlYWs7XHJcbiAgXHJcbi8vICAgICBjYXNlIDI6XHJcbi8vICAgICAgIHBsYXllckNvbnRhaW5lci5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcclxuLy8gICAgICAgcGxheWVyQ29udGFpbmVyLnJlbW92ZUNsYXNzKFwicGF1c2VkXCIpO1xyXG4vLyAgICAgICBicmVhaztcclxuLy8gICB9XHJcbi8vICB9O1xyXG4vLyBmdW5jdGlvbiBvbllvdVR1YmVJZnJhbWVBUElSZWFkeSgpIHtcclxuLy8gICBwbGF5ZXIgPSBuZXcgWVQuUGxheWVyKCdZVCcsIHtcclxuLy8gICAgIGhlaWdodDogJzQwNScsXHJcbi8vICAgICB3aWR0aDogJzk0MCcsXHJcbi8vICAgICB2aWRlb0lkOiAnTFhiM0VLV3NJblEnLFxyXG4vLyAgICAgZXZlbnRzOiB7XHJcbi8vICAgICAgICdvblJlYWR5Jzogb25QbGF5ZXJSZWFkeSxcclxuLy8gICAgICAgJ29uU3RhdGVDaGFuZ2UnOiBvblBsYXllclN0YXRlQ2hhbmdlXHJcbi8vICAgICB9LFxyXG4vLyAgICAgICBwbGF5ZXJWYXJzOiB7XHJcbi8vICAgICAgIGNvbnRyb2xzOjAsXHJcbi8vICAgICAgIGRpc2FibGVrYjogMCxcclxuLy8gICAgICAgc2hvd2luZm86IDAsXHJcbi8vICAgICAgIHJlbDogMCxcclxuLy8gICAgICAgYXV0b3BsYXk6IDAsXHJcbi8vICAgICAgIG1vZGVzdGJyYW5kaW5nOiAwLFxyXG4vLyAgICAgfVxyXG4vLyAgIH0pO1xyXG4vLyB9XHJcblxyXG4vLyBldmVudHNJbml0KCk7XHJcbi8vIH0pKClcclxuXHJcbihmdW5jdGlvbigpIHtcclxubGV0IHBsYXllcjtcclxuY29uc3QgcGxheWVyQ29udGFpbmVyID0gJCgnLnBsYXllcicpO1xyXG5jb25zdCBwbGF5ZXJTdGFydCA9ICQoJy5wbGF5ZXJfX3N0YXJ0Jyk7XHJcbmNvbnN0IHZvbHVtZUJ0biA9ICQoXCIudm9sdW1lX19waWNcIik7XHJcblxyXG5cclxubGV0IGV2ZW50c0luaXQgPSAoKSA9PiB7XHJcbiAgJChcIi5wbGF5ZXJfX3N0YXJ0XCIpLmNsaWNrKGUgPT4ge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgIGNvbnN0IGJ0biA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcclxuXHJcbiAgICBpZiAocGxheWVyU3RhcnQuaGFzQ2xhc3MoXCJwbGF5ZXItLXBhdXNlZFwiKSkge1xyXG5cclxuXHJcbiAgICAgIHBsYXllci5wYXVzZVZpZGVvKCk7XHJcblxyXG4gICAgfSBlbHNlIHtcclxuXHJcbiAgICAgIHBsYXllci5wbGF5VmlkZW8oKTtcclxuICAgIH1cclxuXHJcbiAgICBvblBsYXllclJlYWR5KCk7XHJcbiAgfSk7XHJcblxyXG4gICQoXCIucGxheWVyX19wbGF5YmFja1wiKS5jbGljayhlID0+IHtcclxuICAgIGNvbnN0IGJhciA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcclxuICAgIGNvbnN0IGNsaWNrZWRQb3NpdGlvbiA9IGUub3JpZ2luYWxFdmVudC5sYXllclg7XHJcbiAgICBjb25zdCBuZXdCdXR0b25Qb3NpdGlvblBlcmNlbnQgPSAoY2xpY2tlZFBvc2l0aW9uIC8gYmFyLndpZHRoKCkpICogMTAwO1xyXG4gICAgY29uc3QgbmV3UGxheWJhY2tQb3NpdGlvblNlYyA9XHJcbiAgICAgIChwbGF5ZXIuZ2V0RHVyYXRpb24oKSAvIDEwMCkgKiBuZXdCdXR0b25Qb3NpdGlvblBlcmNlbnQ7XHJcblxyXG5cclxuICAgICQoXCIucGxheWVyX19wbGF5YmFjay1idXR0b25cIikuY3NzKHtcclxuICAgICAgbGVmdDogYCR7bmV3QnV0dG9uUG9zaXRpb25QZXJjZW50fSVgXHJcbiAgICB9KTtcclxuXHJcbiAgICBwbGF5ZXIuc2Vla1RvKG5ld1BsYXliYWNrUG9zaXRpb25TZWMpO1xyXG4gIH0pO1xyXG5cclxuICAkKFwiLnBsYXllcl9fc3BsYXNoXCIpLmNsaWNrKGUgPT4ge1xyXG4gICAgcGxheWVyLnBsYXlWaWRlbygpO1xyXG4gIH0pO1xyXG5cclxuXHJcbiAgJChcIi52b2x1bWVfX3BpY1wiKS5jbGljayhlID0+IHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICBpZiAodm9sdW1lQnRuLmhhc0NsYXNzKFwidm9sdW1lX19waWMtLW5vc291bmRcIikpIHtcclxuXHJcbiAgICAgIHBsYXllci51bk11dGUoKTtcclxuICAgICAgdm9sdW1lQnRuLnJlbW92ZUNsYXNzKFwidm9sdW1lX19waWMtLW5vc291bmRcIik7XHJcblxyXG4gICAgfSBlbHNlIHtcclxuXHJcbiAgICAgIHBsYXllci5tdXRlKCk7XHJcbiAgICAgIHZvbHVtZUJ0bi5hZGRDbGFzcyhcInZvbHVtZV9fcGljLS1ub3NvdW5kXCIpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICAkKFwiLnZvbHVtZV9fcGxheWJhY2tcIikuY2xpY2soZSA9PiB7XHJcblxyXG4gICAgY29uc3QgYmFyVm9sdW1lID0gJChlLmN1cnJlbnRUYXJnZXQpO1xyXG4gICAgY29uc3QgY2xpY2tlZFBvc2l0aW9uVm9sdW1lID0gZS5vcmlnaW5hbEV2ZW50LmxheWVyWDtcclxuICAgIGNvbnN0IG5ld1ZvbHVtZUJ1dHRvblBvc2l0aW9uUGVyY2VudCA9IChjbGlja2VkUG9zaXRpb25Wb2x1bWUgLyBiYXJWb2x1bWUud2lkdGgoKSkgKiAxMDA7XHJcbiAgICBsZXQgdm9sdW1lUG9pbnQgPSBwbGF5ZXIuZ2V0Vm9sdW1lKCk7XHJcblxyXG5cclxuICAgICQoXCIudm9sdW1lX19wbGF5YmFjay1idXR0b25cIikuY3NzKHtcclxuICAgICAgbGVmdDogYCR7bmV3Vm9sdW1lQnV0dG9uUG9zaXRpb25QZXJjZW50fSVgXHJcbiAgICB9KTtcclxuXHJcbiAgICBwbGF5ZXIuc2V0Vm9sdW1lKG5ld1ZvbHVtZUJ1dHRvblBvc2l0aW9uUGVyY2VudCk7XHJcblxyXG4gIH0pO1xyXG5cclxuXHJcbn07XHJcblxyXG5cclxuY29uc3Qgb25QbGF5ZXJSZWFkeSA9ICgpID0+IHtcclxuICBsZXQgaW50ZXJ2YWw7XHJcbiAgY29uc3QgZHVyYXRpb25TZWMgPSBwbGF5ZXIuZ2V0RHVyYXRpb24oKTtcclxuXHJcbiAgaWYgKHR5cGVvZiBpbnRlcnZhbCAhPT0gXCJ1bmRlZmluZWRcIikge1xyXG4gICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbCk7XHJcbiAgfVxyXG5cclxuICBpbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcclxuICAgIGNvbnN0IGNvbXBsZXRlZFNlYyA9IHBsYXllci5nZXRDdXJyZW50VGltZSgpO1xyXG4gICAgY29uc3QgY29tcGxldGVkUGVyY2VudCA9IChjb21wbGV0ZWRTZWMgLyBkdXJhdGlvblNlYykgKiAxMDA7XHJcblxyXG4gICAgJChcIi5wbGF5ZXJfX3BsYXliYWNrLWJ1dHRvblwiKS5jc3Moe1xyXG4gICAgICBsZWZ0OiBgJHtjb21wbGV0ZWRQZXJjZW50fSVgXHJcbiAgICB9KTtcclxuXHJcbiAgfSwgMTAwMCk7XHJcbn07XHJcblxyXG5cclxuY29uc3Qgb25QbGF5ZXJTdGF0ZUNoYW5nZSA9IGV2ZW50ID0+IHtcclxuICBzd2l0Y2ggKGV2ZW50LmRhdGEpIHtcclxuICAgIGNhc2UgMTpcclxuICAgICAgcGxheWVyQ29udGFpbmVyLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xyXG4gICAgICBwbGF5ZXJTdGFydC5hZGRDbGFzcyhcInBsYXllci0tcGF1c2VkXCIpO1xyXG4gICAgICBicmVhaztcclxuICAgIGNhc2UgMjpcclxuICAgICAgcGxheWVyQ29udGFpbmVyLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xyXG4gICAgICBwbGF5ZXJTdGFydC5yZW1vdmVDbGFzcyhcInBsYXllci0tcGF1c2VkXCIpO1xyXG4gICAgICBicmVhaztcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG9uWW91VHViZUlmcmFtZUFQSVJlYWR5KCkge1xyXG4gIHBsYXllciA9IG5ldyBZVC5QbGF5ZXIoJ3l0LXBsYXllcicsIHtcclxuICAgIGhlaWdodDogJzQwNScsXHJcbiAgICB3aWR0aDogJzY2MCcsXHJcbiAgICB2aWRlb0lkOiAnTFhiM0VLV3NJblEnLFxyXG4gICAgZXZlbnRzOiB7XHJcbiAgICAgICdvblJlYWR5Jzogb25QbGF5ZXJSZWFkeSxcclxuICAgICAgJ29uU3RhdGVDaGFuZ2UnOiBvblBsYXllclN0YXRlQ2hhbmdlXHJcbiAgICB9LFxyXG4gICAgcGxheWVyVmFyczoge1xyXG4gICAgICBjb250cm9sczogMCxcclxuICAgICAgZGlzYWJsZWtiOiAwLFxyXG4gICAgICBzaG93aW5mbzogMCxcclxuICAgICAgcmVsOiAwLFxyXG4gICAgICBhdXRvcGxheTogMCxcclxuICAgICAgbW9kZXNicmFuZGluZzogMFxyXG4gICAgfVxyXG4gIH0pXHJcbn07XHJcblxyXG5cclxuZXZlbnRzSW5pdCgpO1xyXG59KSAoKSIsIihmdW5jdGlvbigpIHtcclxuY29uc3Qgc2xpZGVyID0gJCgnLnNsaWRlcicpLmJ4U2xpZGVyKHtcclxuICBwYWdlcjogZmFsc2UsXHJcbiAgY29udHJvbHM6IGZhbHNlXHJcbn0pO1xyXG5cclxuJChcIi5zZWN0aW9uLWJhcl9fYXJyb3ctYmFja1wiKS5jbGljayhlID0+IHtcclxuICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgc2xpZGVyLmdvVG9QcmV2U2xpZGUoKTtcclxuXHJcbn0pXHJcbiQoXCIuc2VjdGlvbi1iYXJfX2Fycm93LWZvcndhcmRcIikuY2xpY2soZSA9PiB7XHJcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIHNsaWRlci5nb1RvTmV4dFNsaWRlKCk7XHJcbn0pXHJcbn0pICgpIiwiKGZ1bmN0aW9uKCkge1xyXG5jb25zdCBmaW5kQmxvY2tCeUFsaWFzID0gYWxpYXMgPT4ge1xyXG4gIHJldHVybiAkKFwiLnJldmlld3NfX2l0ZW1cIikuZmlsdGVyKChuZHgsIGl0ZW0pID0+IHtcclxuICAgIHJldHVybiAkKGl0ZW0pLmF0dHIoXCJkYXRhLWxpbmtlZC13aXRoXCIpID09IGFsaWFzXHJcbiAgfSk7XHJcbn1cclxuJChcIi5pbnRlcmFjdGl2ZS1hdmF0YXJfX2xpbmtcIikuY2xpY2soZSA9PiB7XHJcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICBjb25zdCAkdGhpcyA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcclxuICBjb25zdCB0YXJnZXQgPSAkdGhpcy5hdHRyKFwiZGF0YS1vcGVuXCIpO1xyXG4gIGNvbnN0IGl0ZW1Ub1Nob3cgPSBmaW5kQmxvY2tCeUFsaWFzKHRhcmdldCk7XHJcbiAgY29uc3QgY3VySXRlbSA9ICR0aGlzLmNsb3Nlc3QoXCIucmV2aWV3c19fc3dpdGNoZXItaXRlbVwiKTtcclxuXHJcbiAgaXRlbVRvU2hvdy5hZGRDbGFzcyhcIml0ZW0tYWN0aXZlXCIpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoXCJpdGVtLWFjdGl2ZVwiKTtcclxuICBjdXJJdGVtLmFkZENsYXNzKFwiaXRlbV9fYWN0aXZlXCIpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoXCJpdGVtX19hY3RpdmVcIik7XHJcbn0pO1xyXG59KSgpIl19
